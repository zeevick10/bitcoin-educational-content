---
name: Privaatsus Bitcoinil
goal: Mõista ja valdada Bitcoin'i kasutamisel privaatsuskaitse põhimõtteid
objectives:
  - Määratleda teoreetilised mõisted, mis on vajalikud privaatsuskaitse panuste mõistmiseks
  - Teada, kuidas tuvastada ja leevendada kasutaja privaatsuse kaotusega seotud riske Bitcoinil
  - Kasutada meetodeid ja tööriistu oma privaatsuse kaitsmiseks Bitcoinil
  - Mõista ahelanalüüsi meetodeid ja arendada kaitsestrateegiaid
---
# Kaitse oma privaatsust Bitcoinil

Maailmas, kus finantstehingute privaatsus muutub järk-järgult luksuseks, on oluline mõista ja valdada Bitcoin'i kasutamisel privaatsuskaitse põhimõtteid. See koolitus annab teile kõik võtmed, nii teoreetilised kui ka praktilised, et saavutada seda iseseisvalt.

Tänapäeval on Bitcoinil ettevõtteid, mis on spetsialiseerunud ahelanalüüsile. Nende põhitegevus on just teie privaatsfääri tungimine, et ohustada teie tehingute konfidentsiaalsust. Tegelikult ei eksisteeri Bitcoinil "privaatsusõigust". Seega on teie, kasutaja, ülesanne kinnitada oma loomulikke õigusi ja kaitsta oma tehingute konfidentsiaalsust, sest keegi teine seda teie eest ei tee.

See koolitus on esitatud kui täielik ja üldistav teekond. Iga tehniline mõiste on üksikasjalikult lahti seletatud ja toetatud selgitavate diagrammidega. Eesmärk on teha teadmised kõigile kättesaadavaks. BTC204 on seega lähenemisviisilt sobilik algajatele ja kesktaseme kasutajatele. See koolitus pakub lisaväärtust ka kõige kogenumatele bitcoinide kasutajatele, kuna süveneme mõningatesse tehnilistesse kontseptsioonidesse, mis on sageli tundmatud.

Liituge meiega, et muuta oma Bitcoin'i kasutamist ja saada teadlikuks kasutajaks, kes on võimeline mõistma konfidentsiaalsusega seotud küsimusi ja kaitsma oma privaatsust.

+++

# Sissejuhatus
<partId>e17474a8-8899-4bdb-a7f8-bc52ddb01440</partId>

## Koolituse Tutvustus
<chapterId>08ba1933-f393-4fb5-8279-777d874caedb</chapterId>

Maailmas, kus finantstehingute privaatsus muutub järk-järgult luksuseks, on oluline mõista ja valdada Bitcoin'i kasutamisel privaatsuskaitse põhimõtteid. See koolitus annab teile kõik võtmed, nii teoreetilised kui ka praktilised, et saavutada seda iseseisvalt.
Tänapäeval Bitcoin'i ökosüsteemis on ettevõtteid, mis on spetsialiseerunud ahelanalüüsile. Nende põhitegevus on just teie privaatsfääri tungimine, ohustades teie tehingute konfidentsiaalsust. Tegelikkuses ei eksisteeri Bitcoinil "privaatsusõigust". Seega on teie, kasutaja, ülesanne kinnitada oma loomulikke õigusi ja kaitsta oma tehingute konfidentsiaalsust, sest keegi teine seda teie eest ei tee.

Bitcoin ei ole lihtsalt "Number Kasvab Üles" ja säästude väärtuse säilitamise jaoks. Oma unikaalsete omaduste ja ajaloo tõttu on see eelkõige vastuekonomika vahend. Tänu sellele märkimisväärsele leiutisele saate oma raha vabalt hallata, kulutada ja koguda, ilma et keegi saaks teid takistada.

Bitcoin pakub rahumeelset põgenemist riikide ikkest, võimaldades teil täielikult nautida oma loomulikke õigusi, mida kehtestatud seadused ei saa vaidlustada. Tänu Satoshi Nakamoto leiutisele on teil võim austada oma eraomandi õigusi ja taastada lepinguvabadus.

Siiski, Bitcoin ei ole vaikimisi anonüümne, mis võib kujutada endast ohtu vastuekonomikaga tegelevatele isikutele, eriti despootlike režiimide all olevates piirkondades. Kuid see ei ole ainus oht. Kuna bitcoin on väärtuslik ja tsenseerimatu vara, võib see meelitada ligi vargaid. Seega muutub teie privaatsuse kaitsmine ka turvalisuse küsimuseks: see aitab ennetada küberrünnakuid ja füüsilisi rünnakuid.
Nagu me näeme, kuigi protokoll pakub teatud sisemisi privaatsuskaitseid, on oluline kasutada lisavahendeid selle privaatsuse optimeerimiseks ja kaitsmiseks. See koolitus on kavandatud kui põhjalik ja üldistav kursus, et mõista privaatsuse panuseid Bitcoinis. Iga tehniline mõiste arutatakse üksikasjalikult ja seda toetavad selgitavad diagrammid. Eesmärk on muuta teadmised kõigile kättesaadavaks, isegi algajatele ja kesktaseme kasutajatele. Kogenumatele bitcoinide kasutajatele käsitleme kogu selle koolituse vältel ka väga tehnilisi ja mõnikord vähemtuntud kontseptsioone, et süvendada iga teema mõistmist.

Selle koolituse eesmärk ei ole muuta teid oma Bitcoin'i kasutamisel täiesti anonüümseks, vaid pigem anda teile olulised vahendid teadmiseks, kuidas kaitsta oma privaatsust vastavalt teie isiklikele eesmärkidele. Teil on vabadus valida esitatud kontseptsioonide ja vahendite hulgast, et arendada välja oma strateegiad, mis on kohandatud teie konkreetsetele eesmärkidele ja vajadustele.

### Jaotis 1: Mõisted ja põhikontseptsioonid
Alustuseks vaatame koos läbi põhimõtted, mis juhivad Bitcoini toimimist, et seejärel rahulikult läheneda privaatsusega seotud mõistetele. On oluline valdada mõningaid põhilisi kontseptsioone, nagu UTXOd, vastuvõtu aadressid või skriptid, enne kui suudame täielikult mõista järgmistes jaotistes käsitletavaid kontseptsioone. Tutvustame ka Bitcoini privaatsuse üldmudelit, nagu Satoshi Nakamoto seda ette nägi, mis võimaldab meil mõista panuseid ja riske.

### Jaotis 2: Ahela analüüsi mõistmine ja selle vastu kaitsmine

Teises jaotises uurime tehnikaid, mida ahela analüüsi ettevõtted kasutavad teie tegevuse jälgimiseks Bitcoinis. Nende meetodite mõistmine on oluline teie privaatsuse kaitse tõhustamiseks. See osa on suunatud ründajate strateegiate uurimisele, et paremini mõista riske ja luua alus järgmistes jaotistes uuritavatele tehnikatele. Analüüsime tehingumustreid, sisemisi ja välimisi heuristikaid ning nende mustrite tõenäolisi tõlgendusi. Lisaks teoreetilisele komponendile õpime kasutama ploki uurijat ahela analüüsi teostamiseks, läbi praktiliste näidete ja harjutuste.

### Jaotis 3: Parimate tavade valdamine teie privaatsuse kaitsmiseks

Meie koolituse kolmandas jaotises jõuame asja tuumani: praktikasse! Eesmärk on valdada kõiki olulisi parimaid tavasid, mis peaksid saama iga Bitcoini kasutaja loomulikeks refleksideks. Käsitleme värske aadressi kasutamist, märgistamist, konsolideerimist, täisnoodide kasutamist, samuti KYC-d ja omandamismeetodeid. Eesmärk on anda teile põhjalik ülevaade vältimist vajavatest lõksudest, et luua kindel alus meie privaatsuskaitse otsingutes. Mõne nende tavade puhul juhatatakse teid konkreetse juhendi juurde nende rakendamiseks.

### Jaotis 4: Coinjoin tehingute mõistmine

Kuidas me saame rääkida Bitcoini privaatsusest ilma coinjoine arutamata? Neljandas jaotises avastate kõik, mida peate teadma selle segamismeetodi kohta. Saate teada, mis on coinjoin, selle ajalugu ja eesmärgid, samuti olemasolevate coinjoinide erinevad tüübid. Lõpuks, kogenumatele kasutajatele, avastame, mis on anonüümsuskomplektid ja entroopia ning kuidas neid näitajaid arvutada.

### Jaotis 5: Teiste edasijõudnud privaatsustehnikate panuste mõistmine
Viiendas jaotises anname ülevaate kõigist teistest olemasolevatest tehnikatest, mis kaitsevad teie privaatsust Bitcoinis, välja arvatud coinjoin. Aastate jooksul on arendajad näidanud märkimisväärset loovust privaatsusele pühendatud tööriistade kujundamisel. Me uurime kõiki neid meetodeid, nagu payjoin, koostöölised tehingud, Coin Swap ja Atomic Swap, detailides nende toimimist, eesmärke ja potentsiaalseid nõrkusi.
Me käsitleme ka privaatsust sõlmede võrgu tasandil ja tehingute levitamist. Arutleme ka erinevate protokollide üle, mis on aastate jooksul välja pakutud, et tõhustada kasutajate privaatsust Bitcoinis, sealhulgas staatiliste aadresside protokollid.

![BTC204](assets/notext/11/5.webp)

# Määratlused ja põhimõisted
<partId>b9bbbde3-34c0-4851-83e8-e2ffb029cf31</partId>


## Bitcoin UTXO mudel
<chapterId>8d6b50c5-bf74-44f4-922b-25204991cb75</chapterId>

Bitcoin on peamiselt valuuta, kuid kas te teate konkreetsemalt, kuidas BTC-d protokollis esindatud on?

### Bitcoin UTXOd: Mis Need On?

Bitcoin protokollis toimub rahaliste ühikute haldamine UTXO mudeli ümber, mis on lühend sõnadest "_Unspent Transaction Output_" (kulutamata tehingu väljund).

See mudel erineb oluliselt traditsioonilistest pangasüsteemidest, mis toetuvad konto ja saldo mehhanismile finantsvoogude jälgimiseks. Tõepoolest, pangasüsteemis hoitakse individuaalseid saldosid kontodel, mis on seotud identiteediga. Näiteks, kui ostate pagarilt baguette, debiteerib teie pank lihtsalt ostusumma teie kontolt, vähendades seeläbi teie saldo, samal ajal kui pagarile krediteeritakse sama summa, suurendades tema saldot. Selles süsteemis ei ole raha sisenemise ja väljumise vahel muud seost peale tehingukirjete.

![BTC204](assets/en/21/1.webp)
Bitcoinis toimivad asjad teisiti. Kontseptsioon kontost ei eksisteeri ja rahalisi ühikuid ei hallata saldode kaudu, vaid UTXOde kaudu. UTXO esindab konkreetset bitcoini summat, mis pole veel kulutatud, moodustades seega "tüki bitcoinist", mis võib olla suur või väike. Näiteks UTXO võib olla väärt `500 BTC` või lihtsalt `700 SATS`.
**> Meeldetuletus:** Satoshi, sageli lühendatult sat, on Bitcoinis väikseim ühik, võrreldav sendiga fiat-valuutades.

```plaintext
1 BTC = 100,000,000 SATS
```

Teoreetiliselt võib UTXO esindada mis tahes väärtust bitcoinides, alates ühest satist kuni teoreetilise maksimumini umbes 21 miljonit BTC. Siiski on loogiliselt võimatu omada kõiki 21 miljonit bitcoini ja on olemas madalam majanduslik lävi, mida nimetatakse "tolmuks", millest allpool peetakse UTXO majanduslikult kulutamiskõlbmatuks.

**> Kas teadsite?** Suurim kunagi Bitcoinis loodud UTXO oli väärtuses `500,000 BTC`. Selle lõi MtGox platvorm konsolideerimisoperatsiooni ajal novembris 2011: [29a3efd3ef04f9153d47a990bd7b048a4b2d213daaa5fb8ed670fb85f13bdbcf](https://mempool.space/fr/tx/29a3efd3ef04f9153d47a990bd7b048a4b2d213daaa5fb8ed670fb85f13bdbcf)

### UTXOd ja kulutamistingimused
UTXOd on vahenditeks vahetustehingutes Bitcoinis. Iga tehing tarbib UTXOsid sisenditena ja loob uusi UTXOd väljunditena. Tehingu sooritamisel loetakse sisenditena kasutatud UTXOd "kulutatuks" ning genereeritakse uued UTXOd, mis jaotatakse tehingu väljundites märgitud saajatele. Seega esindab UTXO lihtsalt kulutamata tehingu väljundit ja seeläbi teatud ajahetkel kasutajale kuuluvat bitcoini kogust.
![BTC204](assets/en/21/2.webp)
Kõik UTXOd on kaitstud skriptidega, mis määratlevad tingimused, millal neid saab kulutada. UTXO kulutamiseks peab kasutaja võrgule tõestama, et ta vastab selle UTXO kaitseks määratud skripti tingimustele. Üldiselt on UTXOd kaitstud avaliku võtmega (või vastuvõtu aadressiga, mis esindab seda avalikku võtit). Selle avaliku võtmega seotud UTXO kulutamiseks peab kasutaja tõestama, et tal on vastav privaatvõti, esitades digitaalse allkirja, mis on loodud selle võtmega. Seetõttu öeldakse, et teie Bitcoin rahakott ei sisalda tegelikult bitcoine, vaid hoopis hoiab teie privaatvõtmeid, mis omakorda annavad teile juurdepääsu teie UTXOdele ja laiendatult bitcoinele, mida need esindavad.
![BTC204](assets/en/21/3.webp)

Arvestades, et Bitcoinis puudub konto mõiste, vastab rahakoti saldo lihtsalt kõigi UTXOde summaarsetele väärtustele, mida see saab kulutada. Näiteks, kui teie Bitcoin rahakott saab kulutada järgmisi 4 UTXOd:

```plaintext
- 2 BTC
- 8 BTC
- 5 BTC
- 2 BTC
```

Teie rahakoti kogusaldo oleks `17 BTC`.

![BTC204](assets/en/21/4.webp)

## Bitcoini tehingute struktuur
<chapterId>29d3aaab-de2e-4746-ab40-c9748898850c</chapterId>

### Tehingu sisendid ja väljundid

Bitcoini tehing on blockchainis registreeritud toiming, mis võimaldab bitcoini omandiõiguse ülekandmist ühelt isikult teisele. Täpsemalt, kuna me oleme UTXO mudelis ja kontosid ei ole, rahuldab tehing ühe või mitme UTXO kulutamise tingimused, tarbib need ja loob võrdselt uued UTXOd, millele on omistatud uued kulutamise tingimused. Lühidalt, tehing liigutab bitcoine skriptist, mis on rahuldatud, uude skripti, mille eesmärk on neid kaitsta.

![BTC204](assets/en/22/1.webp)

Iga Bitcoini tehing koosneb seega ühest või mitmest sisendist ja ühest või mitmest väljundist. Sisendid on UTXOd, mida tehing tarbib väljundite genereerimiseks. Väljundid on uued UTXOd, mida saab kasutada tulevaste tehingute sisenditena.

![BTC204](assets/en/22/2.webp)

**> Kas teadsid?** Teoreetiliselt võib bitcoini tehingul olla lõpmatu arv sisendeid ja väljundeid. Ainult ploki maksimaalne suurus piirab seda arvu.
Iga sisend Bitcoini tehingus viitab eelnevale, kulutamata UTXO-le (Unspent Transaction Output). UTXO sisendina kasutamiseks peab selle omanik tõestama, et nad on legitiimsed omanikud, valideerides sellega seotud skripti, st vastates kehtestatud kulutamise tingimusele. Üldiselt hõlmab see digitaalse allkirja esitamist, mis on loodud vastava privaatvõtmega, mis algselt selle UTXO kaitseks kasutati. Skript kontrollib seega, et allkiri vastab fondide vastuvõtmisel kasutatud avalikule võtmele.
![BTC204](assets/en/22/3.webp)
Iga väljund määrab teisest küljest bitcoini ülekantava summa, samuti saaja. Viimane on määratletud uue skripti abil, mis üldiselt lukustab äsja loodud UTXO vastuvõtu aadressi või uue avaliku võtmega.
Et tehingut peetaks konsensuse reeglite kohaselt kehtivaks, peab väljundite kogusumma olema väiksem või võrdne sisendite kogusummaga. Teisisõnu, tehingu poolt genereeritud uute UTXO-de summa ei tohi ületada sisenditena tarbitud UTXO-de summat. See põhimõte on loogiline: kui sul on ainult `500,000 SATS`, ei saa sa teha ostu `700,000 SATS` eest.

### Muutus ja konsolideerimine Bitcoin'i tehingus

Bitcoin'i tehingu toime UTXO-dele võib seega võrrelda kullamündi ümbersulatamisega. Tõepoolest, UTXO ei ole jagatav, vaid ainult ühendatav. See tähendab, et kasutaja ei saa lihtsalt jagada teatud hulga bitcoinidega UTXO-d mitmeks väiksemaks UTXO-ks. Nad peavad selle täielikult tarbima tehingus, et luua üks või mitu uut suvalise väärtusega UTXO-d väljundites, mis peavad olema väiksemad või võrdsed algväärtusega.

See mehhanism on sarnane kullamündi omaga. Kujutage ette, et teil on 2-untsine münt ja soovite teha makse 1 untsi eest, eeldades, et müüja ei saa teile tagasi anda. Te peaksite oma mündi ümber sulatama ja valama 2 uut 1-untsist münti.
Bitcoin'is on toiming sarnane. Kujutame ette, et Alicel on UTXO `10,000 SATS` ja ta soovib osta baguette, mis maksab `4,000 SATS`. Alice teeb tehingu sisendiga 1 UTXO `10,000 SATS`, mille ta tarbib täielikult, ja väljundites loob ta 2 UTXO-d väärtusega `4,000 SATS` ja `6,000 SATS`. UTXO `4,000 SATS` saadetakse pagarile baguette eest maksmiseks, samal ajal kui UTXO `6,000 SATS` naaseb Alicele tagasi. See UTXO, mis naaseb tehingu algsele saatjale, on see, mida Bitcoin'i žargoonis nimetatakse "muutuseks".
![BTC204](assets/en/22/4.webp)

Nüüd kujutage ette, et Alicel ei ole ühte UTXO-d `10,000 SATS`, vaid pigem kaks UTXO-d `3,000 SATS` igaüks. Selles olukorras ei ole ükski üksik UTXO piisav, et katta `4,000 SATS` baguette eest. Seetõttu peab Alice kasutama mõlemat UTXO-d `3,000 SATS` samaaegselt oma tehingu sisenditena. Sel viisil jõuab sisendite kogusumma `6,000 SATS`-ni, võimaldades tal katta `4,000 SATS` makse pagarile. See meetod, mis hõlmab mitme UTXO gruppi lisamist tehingu sisenditesse, nimetatakse sageli terminiga "konsolideerimine".
![BTC204](assets/en/22/5.webp)

### Tehingutasud
Intuitiivselt võiks arvata, et tehingutasud esindavad samuti tehingu väljundit. Kuid tegelikkuses see nii ei ole. Tehingu tasud esindavad sisendite kogusumma ja väljundite kogusumma vahet. See tähendab, et pärast osa sisendite väärtuse kasutamist soovitud väljundite katmiseks tehingus, jääb teatud summa sisendeid kasutamata. See järelejäänud summa moodustab tehingutasud.
```plaintext
Tasud = sisendite kogusumma - väljundite kogusumma
```

Tagasi minnes Alice'i näite juurde, kellel on UTXO suurusega `10,000 SATS` ja kes soovib osta baguette hinnaga `4,000 SATS`. Alice loob tehingu oma UTXOga `10,000 SATS` sisendina. Seejärel genereerib ta väljundi `4,000 SATS`, mis on mõeldud pagarile baguette eest tasumiseks. Selleks, et julgustada kaevureid lisama tema tehingut plokki, eraldab Alice `200 SATS` tasudeks. Nii loob ta teise väljundi, vahetusraha, mis naaseb tema juurde, summas `5,800 SATS`.

![BTC204](assets/en/22/6.webp)

Tasude valemit rakendades näeme tõepoolest, et kaevuritele jääb `200 SATS`:
```plaintext
Tasud = sisendite kogusumma - väljundite kogusumma
Kulud = 10,000 - (4,000 + 5,800)
Kulud = 10,000 - 9,800
Kulud = 200
```

Kui kaevur valideerib edukalt ploki, on tal lubatud koguda neid tasusid kõigi oma plokis sisalduvate tehingute eest, nn "coinbase" tehingu kaudu.

### UTXOde Loomine Bitcoinis

Kui olete eelnevaid lõike tähelepanelikult järginud, siis te nüüd teate, et UTXOsid saab luua ainult teisi olemasolevaid UTXOsid tarbides. Seega, mündid Bitcoinis moodustavad pideva ahela. Siiski võite mõelda, kuidas esimesed UTXOd selles ahelas tekkisid. See tõstatab probleemi sarnaselt kanamuna dilemmale: kust need algupärased UTXOd tulid?

Vastus peitub **coinbase tehingus**.

Coinbase on Bitcoinile omane spetsiifiline tehingutüüp, unikaalne igale plokile ja alati esimene neis. See võimaldab kaevuril, kes leidis kehtiva töötõendi, saada oma ploki tasu. See tasu koosneb kahest elemendist: **ploki toetus** ja **tehingutasud**, millest rääkisime eelmises osas.

Coinbase tehingu unikaalne omadus on see, et see on ainus, mis suudab luua bitcoine õhust, ilma vajaduseta tarbida sisendeid oma väljundite genereerimiseks. Need äsja loodud bitcoind moodustavad, mida võiks nimetada "algupärasteks UTXOdeks".

![BTC204](assets/en/22/7.webp)

Ploki toetusest saadavad bitcoind on uued BTCd, loodud tühjast, järgides eelnevalt kindlaks määratud emiteerimise ajakava konsensuse reeglites. Ploki toetus väheneb iga 210,000 ploki järel, mis on umbes iga nelja aasta tagant, protsessis, mida nimetatakse "poolitamiseks". Alguses loodi iga toetusega 50 bitcoini, kuid see summa on järk-järgult vähenenud; praegu on see 3.125 bitcoini ploki kohta.
Seoses tehingutasudega, kuigi need esindavad samuti uuesti loodud BTC-d, ei tohi need ületada kõikide blokis olevate tehingute sisendite ja väljundite vahelist erinevust. Nagu me varem nägime, esindavad need tasud sisendite osa, mida tehingute väljundites ei kasutata. See osa on tehniliselt "kaotatud" tehingu käigus ja kaevuril on õigus see väärtus ühe või mitme uue UTXO-na taasluua. Seega on see väärtuse ülekanne tehingu saatjalt kaevurile, kes lisab selle blockchaini.
**> Kas teadsid?** Coinbase tehinguga genereeritud bitcoinid on allutatud 100 bloki küpsusperioodile, mille jooksul ei saa kaevur neid kulutada. See reegel on mõeldud vältimaks komplikatsioone, mis on seotud uute bitcoinide kasutamisega ahelas, mis võib hiljem muutuda vananenuks.

### UTXO mudeli mõjud

Esiteks mõjutab UTXO mudel otseselt Bitcoin'i tehingutasusid. Kuna iga bloki maht on piiratud, eelistavad kaevurid tehinguid, mis pakuvad parimat tasu suhtes ruumile, mida nad blokis hõivavad. Tõepoolest, mida rohkem UTXOsid tehing sisaldab sisenditena ja väljunditena, seda raskem see on ja seetõttu nõuab see kõrgemaid tasusid. See on üks põhjuseid, miks sageli püütakse vähendada meie rahakotis olevate UTXOde arvu, mis võib samuti mõjutada privaatsust, teema, millele me kolmanda osa koolituses põhjalikult keskendume.

Järgmisena, nagu eelnevates osades mainitud, on Bitcoin'i mündid sisuliselt UTXOde ahel. Iga tehing loob seega lingi mineviku UTXO ja tuleviku UTXO vahel. UTXOd võimaldavad seega bitcoini teekonna läbipaistvat jälgimist alates selle loomisest kuni praeguse kulutamiseni. See läbipaistvus võib olla positiivne, kuna see võimaldab igal kasutajal veenduda saadud bitcoinide autentsuses. Siiski põhineb just sellel jälgitavuse ja auditeeritavuse põhimõttel ka ahela analüüs, praktika, mille eesmärk on teie privaatsuse ohustamine. Me uurime seda praktikat põhjalikult koolituse teises osas.

## Bitcoin'i privaatsusmudel
<chapterId>769d8963-3ed5-4094-b21d-9203c7d9e465</chapterId>

### Valuuta: Autentsus, Terviklikkus ja Topeltkulutamine

Üks valuuta funktsioonidest on lahendada topeltsoovide kokkusattumuse probleem. Vahetuspõhises süsteemis nõuab vahetus mitte ainult isiku leidmist, kes pakub kaupa, mis rahuldab minu vajadust, vaid ka neile kauba pakkumist, millel on võrdne väärtus, mis rahuldab nende enda vajadust. Selle tasakaalu leidmine osutub keerukaks.

![BTC204](assets/notext/23/1.webp)

Seepärast pöördume valuuta poole, mis võimaldab väärtuse ülekandmist nii ruumis kui ka ajas.

![BTC204](assets/notext/23/2.webp)

Selleks, et valuuta saaks selle probleemi lahendada, on oluline, et kauba või teenuse pakkuv pool on veendunud oma võimes seda summat hiljem kulutada. Seega iga ratsionaalne isik, kes soovib vastu võtta mingit valuutat, olgu see digitaalne või füüsiline, veendub, et see vastab kahele fundamentaalsele kriteeriumile:
- **Münt peab olema terve ja autentne;**
- **ja seda ei tohi olla topeltkulutatud.**
Füüsilise valuuta kasutamisel on esimene omadus kõige keerulisem kindlaks teha. Ajaloo erinevatel perioodidel on metallmüntide terviklikkust sageli ohustanud sellised praktikad nagu kärpimine või puurimine. Näiteks antiikses Roomas oli kodanikel tavaline kraapida kuldsete müntide servi, et koguda natuke väärtuslikku metalli, hoides neid siiski tulevaste tehingute jaoks. Mündi sisemine väärtus seega vähenes, kuid selle nimiväärtus jäi samaks. Just seetõttu hakati hiljem müntide servadele sooni vermima.

Autentsus on samuti füüsilise rahalise meedia puhul raskesti kontrollitav omadus. Tänapäeval on võltsimisvastased tehnikad üha keerukamad, sundides kaupmehi investeerima kallitesse kontrollisüsteemidesse.

Teisest küljest, oma olemuselt ei ole füüsiliste valuutade puhul topeltkulutamine probleem. Kui ma annan sulle 10-eurose rahatähe, siis see lahkub pöördumatult minu valdusest, et siseneda sinu omasse, loomulikult välistades igasuguse võimaluse kulutada samu rahalisi vahendeid mitu korda. Lühidalt, ma ei saa seda 10-eurost rahatähte uuesti kulutada.

![BTC204](assets/notext/23/3.webp)

Digitaalse valuuta puhul on raskused erinevad. Mündi autentsuse ja terviklikkuse tagamine on sageli lihtsam. Nagu me eelmises jaotises nägime, võimaldab Bitcoini UTXO mudel jälgida mündi päritolu, kinnitades seeläbi, et see on loodud vastavalt konsensuse reeglitele kaevandaja poolt.

Siiski on topeltkulutamise puudumise tagamine keerukam, kuna igasugune digitaalne hüve on sisuliselt informatsioon. Erinevalt füüsilistest kaupadest ei jagune informatsioon vahetuste käigus, vaid levib paljundades. Näiteks, kui ma saadan sulle dokumendi e-postiga, siis see dubleeritakse. Sinu poolt ei saa sa kindlalt kontrollida, et ma olen originaaldokumendi kustutanud.

![BTC204](assets/notext/23/4.webp)

### Topeltkulutamise vältimine Bitcoinis

Ainus viis digitaalse hüve dubleerimise vältimiseks on olla teadlik kõigist süsteemis toimuvatest vahetustest. Sel viisil saab teada, kes mida omab, ja uuendada kõigi osaliste varusid tehtud tehingute põhjal. See on see, mida tehakse näiteks raamatupidamisraha puhul pangasüsteemis. Kui maksad kaupmehele 10 eurot krediitkaardiga, märgib pank selle vahetuse üles ja uuendab pearaamatut.
Bitcoinis saavutatakse topeltkulutamise vältimine samal viisil. Eesmärk on kinnitada, et pole toimunud juba kulutatud müntidega tehingut. Kui neid münte pole kunagi kasutatud, siis võime olla kindlad, et topeltkulutamine ei toimu. Seda põhimõtet kirjeldas Satoshi Nakamoto Valges Raamatus selle kuulsa fraasiga:

**"*Ainus viis tehingu puudumise kinnitamiseks on olla teadlik kõigist tehingutest.*"**

Siiski, erinevalt pangamudelist, ei soovita Bitcoinis usaldada keskset asutust. On vajalik, et kõik kasutajad saaksid kinnitada topeltkulutamise puudumist, ilma et peaksid toetuma kolmandale osapoolele. Seega peavad kõik olema teadlikud kõigist Bitcoin tehingutest. Sellepärast edastatakse Bitcoin tehingud avalikult kõigile võrgusõlmedele ja salvestatakse selgelt plokiahelasse.

Just see informatsiooni avalik levitamine muudab privaatsuse kaitsmise Bitcoinis keerukaks. Traditsioonilises pangasüsteemis on teoorias ainult finantsasutus teadlik tehtud tehingutest. Teisest küljest, Bitcoinis on kõik kasutajad teadlikud kõigist tehingutest, läbi oma vastavate sõlmede.

### Privaatsusmudel: pangasüsteem vs Bitcoin
Traditsioonilises süsteemis on teie pangakonto seotud teie isikuga. Pankur teab, milline pangakonto kuulub millisele kliendile ja millised tehingud sellega seotud on. Siiski on see infovoog panga ja avaliku domeeni vahel katkestatud. Teisisõnu, on võimatu teada teise isiku pangakonto saldo ja tehinguid. Ainult pankal on ligipääs sellele teabele.
Näiteks teab teie pankur, et ostate iga hommik naabruses asuvast pagarikojast baguette, kuid teie naaber ei ole sellest tehingust teadlik. Seega on infovoog kättesaadav asjaomastele osapooltele, eriti pangale, kuid jääb välispidistele kättesaamatuks.

Varasemas osas nähtud tehingute avaliku levitamise piirangu tõttu ei saa Bitcoin'i privaatsusmudel järgida pangandussüsteemi mudelit. Bitcoin'i puhul, kuna infovoogu tehingute ja avaliku domeeni vahel ei saa katkestada, **toetub privaatsusmudel kasutaja isikusamasuse ja tehingute vahelisele eraldatusele**.
Näiteks, kui maksate pagarile BTC-s baguette eest, võib teie naaber, kellel on oma täisnood, näha teie tehingut läbimas, samuti nagu nad näevad kõiki teisi süsteemi tehinguid. Siiski, kui privaatsuspõhimõtteid austatakse, ei tohiks nad suuta seda konkreetset tehingut teie isikuga seostada.
![BTC204](assets/en/23/9.webp)

Kuid kuna Bitcoin'i tehingud tehakse avalikuks, muutub siiski võimalikuks nende vahel seoste loomine, et järeldada teavet osapoolte kohta. See tegevus isegi kujutab endast iseenesest spetsialiteeti, mida nimetatakse "ahela analüüsiks". Järgmises koolituse osas kutsun teid uurima ahela analüüsi aluseid, et mõista, kuidas teie bitcoine jälgitakse ja teada, kuidas selle vastu paremini kaitsta.

# Ahela Analüüsi Mõistmine ja Kuidas End Kaitsta
<partId>4739371e-9fef-45b0-bcaa-b7a4df6b4470</partId>

## Mis on Bitcoin'i Ahela Analüüs?
<chapterId>7d198ba6-4af2-4f24-86cb-3c79cb25627e</chapterId>

### Definitsioon ja Tööpõhimõte

Ahela analüüs hõlmab kõiki meetodeid, mida kasutatakse bitcoinide liikumise jälgimiseks plokiahelas. Üldiselt toetub ahela analüüs eelnevate tehingute proovide omaduste jälgimisele. Seejärel hõlmab see nende samade omaduste tuvastamist tehingus, mida soovitakse analüüsida, ja tõenäoliste tõlgenduste järeldamist. See praktiline lähenemine probleemide lahendamisele, et leida piisavalt hea lahendus, on see, mida nimetatakse "heuristikaks".

Lihtsustatult öeldes tehakse ahela analüüsi kolmes peamises etapis:
1. **Plokiahela jälgimine;**
2. **Tuntud omaduste tuvastamine;**
3. **Hüpoteeside tegemine.**

![BTC204](assets/en/31/1.webp)

Ahela analüüsi saab teostada igaüks. Piisab avaliku plokiahela infole juurdepääsu omamisest täisnoodi kaudu, et jälgida tehingute liikumisi ja teha hüpoteese. On ka tasuta tööriistu, mis hõlbustavad seda analüüsi, nagu veebileht [OXT.me](https://oxt.me/), mida me uurime üksikasjalikult selle osa viimastes peatükkides. Siiski tuleb privaatsuse peamiseks ohuks ettevõtted, mis on spetsialiseerunud ahela analüüsile. Need ettevõtted on viinud ahela analüüsi tööstuslikule tasemele ja müüvad oma teenuseid finantsasutustele või valitsustele. Nende ettevõtete seas on Chainalysis tõenäoliselt kõige tuntum.

### Ahela Analüüsi Eesmärgid
Üheks ahelaanalüüsi eesmärkidest on grupeerida erinevaid tegevusi Bitcoinis, et määrata kindlaks tegevusi sooritanud kasutaja ainulaadsus. Järgnevalt on võimalik üritada seostada see tegevuste kogum reaalse identiteediga.

Pidage meeles eelmist peatükki. Selgitasin, miks Bitcoin'i privaatsusmudel algselt tugines kasutaja identiteedi eraldamisele nende tehingutest. Seetõttu võib tunduda, et ahelaanalüüs on tarbetu, kuna isegi kui õnnestub grupeerida ahelategevusi, ei saa neid seostada reaalse identiteediga.

Teoreetiliselt on see väide täpne. Koolituse esimeses osas nägime, et krüptograafilisi võtmepaare kasutatakse UTXO tingimuste kehtestamiseks. Olemuselt ei avalda need võtmepaarid mingit teavet nende omanike identiteedi kohta. Seega, isegi kui õnnestub grupeerida erinevate võtmepaaridega seotud tegevusi, ei ütle see meile midagi nende tegevuste taga oleva üksuse kohta.

Siiski on praktiline reaalsus palju keerulisem. On palju käitumisi, mis riskivad seostada reaalse identiteedi ahelategevusega. Analüüsis nimetatakse seda sisenemispunktiks ja neid on palju.

Kõige tavalisem, muidugi, on KYC (*Know Your Customer*). Kui võtate oma bitcoine reguleeritud platvormilt välja ühele oma isiklikule vastuvõtu aadressile, siis mõned inimesed suudavad seostada teie identiteedi selle aadressiga. Laiemalt võttes võib sisenemispunkt olla igasugune suhtlus teie reaalse elu ja Bitcoin'i tehingu vahel. Näiteks, kui avaldate oma vastuvõtu aadressi oma sotsiaalmeedias, võib see olla analüüsi jaoks sisenemispunkt. Kui teete oma pagarile makse bitcoinides, võivad nad seostada teie näo (mis on osa teie identiteedist) Bitcoin'i aadressiga.

Need sisenemispunktid on Bitcoin'i kasutamisel peaaegu vältimatud. Kuigi võib püüda nende ulatust piirata, jäävad need olemasolevaks. Seetõttu on oluline kombineerida meetodeid, mille eesmärk on säilitada teie privaatsus. Kuigi teie reaalse identiteedi ja tehingute vahelise eraldatuse säilitamine on huvitav lähenemine, on see tänapäeval ebapiisav. Tõepoolest, kui kõik teie ahelategevused saab grupeerida, siis võib väikseimgi sisenemispunkt ohustada ainukest privaatsuskihti, mille olite loonud.

### Kaitse Ahelaanalüüsi Vastu
Seega on samuti vajalik suuta vastu seista plokiahela analüüsile meie Bitcoin'i kasutamisel. Sellisel viisil toimides saame minimeerida oma tegevuste agregatsiooni ja piirata sisenemispunkti mõju meie privaatsusele.

Tõepoolest, et paremini vastu seista plokiahela analüüsile, mis oleks parem lähenemine kui tutvuda plokiahela analüüsis kasutatavate meetoditega? Kui soovite teada, kuidas oma privaatsust Bitcoin'is parandada, peate mõistma neid meetodeid. See võimaldab teil paremini mõista tehnikaid nagu [coinjoin](https://planb.network/fr/tutorials/privacy/coinjoin-samourai-wallet) või [payjoin](https://planb.network/fr/tutorials/privacy/payjoin) (tehnikad, mida me uurime koolituse viimastes osades), ja vähendada vigu, mida võite teha.
Selles võime teha analoogia krüptograafia ja krüptoanalüüsi vahel. Hea krüptograaf on eelkõige hea krüptoanalüütik. Uue krüpteerimisalgoritmi väljamõtlemiseks peab inimene teadma, milliste rünnakutega see peab silmitsi seisma, ja uurima ka seda, miks eelmised algoritmid murdusid. Sama põhimõte kehtib privaatsuse kohta Bitcoinis. Plokiahela analüüsi meetodite mõistmine on võti selle vastu kaitsmiseks. Seetõttu pakun välja terve jaotise plokiahela analüüsist selles koolituses.
### Plokiahela analüüsi meetodid

On oluline mõista, et plokiahela analüüs ei ole täppisteadus. See põhineb heuristilistel järeldustel, mis on tuletatud varasematest vaatlustest või loogilistest tõlgendustest. Need reeglid võimaldavad üsna usaldusväärseid tulemusi, kuid mitte kunagi absoluutse täpsusega. Teisisõnu, **plokiahela analüüs hõlmab alati tõenäosusmõõdet järeldustes**. Näiteks võib hinnata suurema või väiksema kindlusega, et kaks aadressi kuuluvad samale entiteedile, kuid täielik kindlus jääb alati kättesaamatuks.

Plokiahela analüüsi kogu eesmärk seisneb just erinevate heuristiliste meetodite koondamises, et minimeerida vea riski. See on omamoodi tõendite kuhjamine, mis võimaldab meil reaalsusele lähemale jõuda.

Neid kuulsaid heuristikaid saab grupeerida erinevatesse kategooriatesse, mida me üksikasjalikult käsitleme:
- **Tehingumustrid (või tehingumudelid);**
- **Tehingu sisemised heuristikad;**
- **Tehingu välimised heuristikad.**

### Satoshi Nakamoto ja plokiahela analüüs
Tuleb märkida, et esimesed kaks ahelaanalüüsi heuristikat avastas Satoshi Nakamoto ise. Ta arutleb neid Bitcoin White Paper'i 10. osas. Need on:
- ühise sisendi omandi heuristika (CIOH);
- ja aadressi taaskasutus.

![BTC204](assets/notext/31/6.webp)

Allikas: S. Nakamoto, "Bitcoin: A Peer-to-Peer Electronic Cash System", https://bitcoin.org/bitcoin.pdf, 2009.

Järgnevates peatükkides uurime, millest need koosnevad, kuid on juba huvitav märkida, et need kaks heuristikat säilitavad endiselt esmatähtsuse ahelaanalüüsis tänapäeval.

## Tehingumustrid
<chapterId>d365a101-2d37-46a5-bfb9-3c51e37bf96b</chapterId>

Tehingumuster on lihtsalt tüüpiline tehingu üldstruktuur, mida võib leida plokiahelast, mille tõlgendamine on tõenäoliselt teada. Mustrite uurimisel keskendume ühele tehingule, mida analüüsime kõrgel tasemel.

Teisisõnu, me vaatame ainult sisendites olevate UTXO-de arvu ja väljundites olevate UTXO-de arvu, jättes tähelepanuta spetsiifilisemad detailid või tehingu keskkonna. Täheldatud mudelist saame tehingu olemuse tõlgendada. Seejärel otsime selle struktuurist iseloomulikke jooni ja teeme tõlgenduse.

![BTC204](assets/en/32/01.webp)

Selles osas avastame koos peamised tehingumudelid, mida võib ahelaanalüüsis kohata, ja iga mudeli puhul annan teile selle struktuuri tõenäolise tõlgenduse koos konkreetse näitega.

### Lihtne Saatmine (või Lihtne Makse)

Alustame väga levinud mustriga, kuna see ilmub enamikus bitcoinimaksetes. Lihtsa makse mudelit iseloomustab ühe või mitme UTXO tarbimine sisendites ja 2 UTXO tootmine väljundites. See mudel näeb seega välja selline:

![BTC204](assets/en/32/02.webp)
Kui me märkame seda tehingustruktuuri plokiahelas, võime juba teha tõlgenduse. Nagu nimigi viitab, näitab see mudel, et oleme saatmise või maksetehingu juures. Kasutaja on tarbinud omaenda UTXO-d sisendites, et rahuldada väljundites makse UTXO ja vahetus UTXO (raha tagastatakse samale kasutajale).
Seega teame, et vaadeldav kasutaja tõenäoliselt ei oma enam ühte kahest UTXO-st väljundites (makse oma), kuid nad on endiselt teise UTXO (vahetus oma) omanik.
Praegu on meil võimatu täpsustada, milline väljund esindab millist UTXO-d, kuna see ei ole uuringu eesmärk. Saavutame selle, tuginedes heuristikale, mida uurime järgnevates osades. Praegusel etapil on meie eesmärk piiratud ainult küsimuse all oleva tehingu olemuse tuvastamisega, mis sel juhul on lihtne saatmine.

Näiteks siin on Bitcoin tehing, mis järgib lihtsa saatmise mustrit:

```plaintext
b6cc79f45fd2d7669ff94db5cb14c45f1f879ea0ba4c6e3d16ad53a18c34b769
```

![BTC204](assets/en/32/03.webp)

Allikas: [Mempool.space](https://mempool.space/fr/tx/b6cc79f45fd2d7669ff94db5cb14c45f1f879ea0ba4c6e3d16ad53a18c34b769)

Pärast seda esimest näidet peaks teil olema parem arusaam sellest, mida tähendab "tehingumudeli" uurimine. Me uurime tehingut, keskendudes ainult selle struktuurile, võtmata arvesse selle keskkonda või tehingu konkreetseid üksikasju. Me vaatleme seda ainult üldisel viisil esimeses etapis.

Nüüd, kui te mõistate, mis on muster, liikugem edasi teiste olemasolevate mudelite juurde.

### Pühkimine

See teine mudel iseloomustab end ühe UTXO tarbimisega sisendina ja ühe UTXO tootmisega väljundina.

![BTC204](assets/en/32/04.webp)

Selle mudeli tõlgendus on, et oleme iseenesele ülekande juures. Kasutaja on kandnud oma bitcoine endale, teisele aadressile, mida ta omab. Kuna tehingus ei ole vahetust, on väga ebatõenäoline, et oleme maksetehingu juures. Tõepoolest, kui makse tehakse, on peaaegu võimatu, et maksjal oleks UTXO, mis täpselt vastab müüja nõutud summale pluss tehingutasud. Üldiselt on maksja seega sunnitud tootma vahetusväljundi.

Seejärel teame, et vaadeldav kasutaja tõenäoliselt ikka omab seda UTXO-d. Ahela analüüsi kontekstis, kui me teame, et tehingu sisendis kasutatud UTXO kuulub Alicele, võime eeldada, et väljundis olev UTXO kuulub samuti temale. Hiljem muutub huvitavaks leida tehingu siseseid heuristikaid, mis võiksid seda eeldust tugevdada (me uurime neid heuristikaid peatükis 3.3).

Näiteks siin on Bitcoin tehing, mis järgib pühkimise mustrit:

```plaintext
35f1072a0fda5ae106efb4fda871ab40e1f8023c6c47f396441ad4b995ea693d
```

![BTC204](assets/en/32/05.webp)
Allikas: [Mempool.space](https://mempool.space/fr/tx/35f1072a0fda5ae106efb4fda871ab40e1f8023c6c47f396441ad4b995ea693d) Siiski võib selline muster paljastada ka iseenesliku ülekande krüptoraha vahetusplatvormi kontole. Selleks, et teada saada, kas tegemist on ülekanne isehoidmise rahakotti või väljavõtmisega platvormile, tuleb uurida tuntud aadresse ja tehingu konteksti. Tõepoolest, vahetusplatvormide aadresse on sageli kergesti tuvastatav.

Tagasi minnes Alice'i näite juurde: kui pühkimine viib platvormi tuntud aadressile (näiteks Binance), võib see tähendada, et bitcoine on üle kantud välja Alice'i otsesest valdusest, tõenäoliselt kavatsusega neid müüa või hoiustada sellel platvormil. Teisest küljest, kui sihtaadress on tundmatu, on mõistlik eeldada, et tegemist on lihtsalt teise rahakotiga, mis kuulub endiselt Alice'ile. Kuid selline uurimine kuulub pigem heuristika kui mustrite uurimise valdkonda.

### Konsolideerimine

Seda mudelit iseloomustab mitme UTXO tarbimine sisendina ja ühe UTXO tootmine väljundina.

![BTC204](assets/en/32/06.webp)

Selle mudeli tõlgendus on, et oleme konsolideerimise juures. See on Bitcoin'i kasutajate seas levinud praktika, mille eesmärk on ühendada mitu UTXOt, arvestades võimaliku tehingutasude tõusu. Seda toimingut tehes madalate tasude perioodil on võimalik tulevikus tasudelt säästa. Sellest praktikast räägime lähemalt peatükis 4.3.

Võime järeldada, et selle tehingumudeli taga olev kasutaja oli tõenäoliselt kõigi sisendites olevate UTXOde omanik ja on endiselt väljundi UTXO omanik. See on kindlasti iseeneslik ülekanne.

Nagu pühkimisel, võib ka see muster paljastada iseenesliku ülekande vahetusplatvormi kontole. Tuntud aadresside ja tehingu konteksti uurimine võimaldab meil teada saada, kas tegemist on konsolideerimisega isehoidmise rahakotti või väljavõtmisega platvormile.

Näiteks siin on Bitcoin'i tehing, mis järgib konsolideerimise mustrit:

```plaintext
77c16914211e237a9bd51a7ce0b1a7368631caed515fe51b081d220590589e94
```

![BTC204](assets/en/32/07.webp)

Allikas: [Mempool.space](https://mempool.space/fr/tx/77c16914211e237a9bd51a7ce0b1a7368631caed515fe51b081d220590589e94)
Ahela analüüsi kontekstis võib see mudel paljastada palju informatsiooni. Näiteks, kui teame, et üks sisenditest kuulub Alice'ile, võime eeldada, et kõik teised sisendid ja selle tehingu väljund kuuluvad samuti temale. See eeldus võimaldaks meil jälgida tagasi eelnevate tehingute ahelaid, et avastada ja analüüsida muid tehinguid, mis tõenäoliselt on seotud Alice'iga.
![BTC204](assets/en/32/08.webp)

### Grupiviisiline Kulutamine

Seda mudelit iseloomustab mõne UTXO tarbimine sisenditena (tihti ainult üks) ja arvukate UTXOde tootmine väljunditena.

![BTC204](assets/en/32/09.webp)
Selle mudeli tõlgendus on, et meil on tegemist grupiviisilise kulutamisega. See on praktika, mis tõenäoliselt paljastab olulist majandustegevust, näiteks vahetusplatvormi. Grupiviisiline kulutamine võimaldab neil üksustel kokku hoida tasudelt, konsolideerides oma kulutused üheks tehinguks.

Sellest mudelist võime järeldada, et UTXO sisend pärineb ettevõttelt, millel on oluline majandustegevus, ja et UTXO väljundid hajuvad. Paljud neist kuuluvad ettevõtte klientidele, kes on platvormilt bitcoine välja võtnud. Teised võivad minna partnerettevõtetele. Lõpuks on kindlasti üks või mitu vahetust, mis naasevad väljastava ettevõtte juurde.

Näiteks siin on Bitcoin'i tehing, mis võtab kasutusele grupiviisilise kulutamise mustri (tõenäoliselt on see tehing väljastatud Bybit platvormi poolt):

```plaintext
8a7288758b6e5d550897beedd13c70bcbaba8709af01a7dbcc1f574b89176b43
```

![BTC204](assets/en/32/10.webp)

Allikas: [Mempool.space](https://mempool.space/fr/tx/8a7288758b6e5d550897beedd13c70bcbaba8709af01a7dbcc1f574b89176b43)

### Protokollispetsiifilised Tehingud

Tehingumustrite seas saame samuti tuvastada mudeleid, mis paljastavad konkreetse protokolli kasutamist. Näiteks Whirlpool coinjoins (mida me arutame osas 5) omavad kergesti tuvastatavat struktuuri, mis võimaldab neid eristada teistest traditsioonilisematest tehingutest.

![BTC204](assets/en/32/11.webp)

Selle mustri analüüs viitab sellele, et tõenäoliselt on meil tegemist koostöö tehinguga. Samuti on võimalik täheldada coinjoin'i. Kui see viimane hüpotees osutub täpseks, siis väljundite arv võiks anda meile ligikaudse hinnangu coinjoin'is osalejate arvule.

Näiteks siin on Bitcoin'i tehing, mis võtab kasutusele koostöö tehingu tüüpi coinjoin:

```plaintext
00601af905bede31086d9b1b79ee8399bd60c97e9c5bba197bdebeee028b9bea
```

![BTC204](assets/en/32/12.webp)

Allikas: [Mempool.space](https://mempool.space/fr/tx/00601af905bede31086d9b1b79ee8399bd60c97e9c5bba197bdebeee028b9bea)

On palju teisi protokolle, millel on oma spetsiifilised struktuurid. Seega võiksime eristada näiteks Wabisabi tüüpi tehinguid, Stamps tehinguid või isegi Runes tehinguid.

Tänu nendele tehingumustritele saame juba tõlgendada mitmeid andmeid antud tehingu kohta. Kuid tehingu struktuur ei ole ainus informatsiooni allikas analüüsiks. Samuti saame uurida selle detaile. Need detailid, mis on tehingu sees, on see, mida ma nimetan "sisemisteks heuristilisteks", ja me uurime neid järgmises peatükis.

## Sisemised Heuristikud
<chapterId>c54b5abe-872f-40f4-a0d0-c59faff228ba</chapterId>

Sisemine heuristika on tehingu sees tuvastatav konkreetne omadus, ilma et oleks vaja uurida selle keskkonda, mis võimaldab meil teha järeldusi. Erinevalt mustritest, mis keskenduvad tehingu üldisele struktuurile kõrgel tasemel, põhinevad sisemised heuristikud andmete kogumil, mida on võimalik ekstraheerida. See hõlmab:
- Erinevate UTXO-de kogused, nii sissetulevad kui väljaminevad;
- Kõik, mis puudutab skripte: vastuvõtvad aadressid, versioonid, lukustusajad...

Üldiselt võimaldab see tüüpi heuristika meil tuvastada muutuse konkreetse tehingu puhul. Tehes seda, saame jätkata üksuse jälitamist mitme erineva tehingu kaudu. Tõepoolest, kui tuvastame kasutajale kuuluva UTXO ja soovime jälgida, on oluline kindlaks teha, milline väljund anti üle teisele kasutajale ja milline väljund kujutab endast muutust, jäädes seega nende valdusse.

![BTC204](assets/en/33/01.webp)

Tuletan veel kord meelde, et need heuristikad ei ole absoluutselt täpsed. Üksikult võetuna võimaldavad need meil tuvastada ainult tõenäolisi stsenaariume. Mitme heuristika kuhjumine aitab vähendada ebakindlust, ilma seda kunagi täielikult kõrvaldamata.

### Sisemised Sarnasused

See heuristika hõlmab sama tehingu sisendite ja väljundite vaheliste sarnasuste uurimist. Kui me märkame sama omadust sisenditel ja ainult ühel väljundil tehingust, siis on tõenäoline, et see väljund kujutab endast muutust.

Kõige ilmsem omadus on vastuvõtva aadressi taaskasutamine samas tehingus.

![BTC204](assets/en/33/02.webp)
See heuristika jätab vähe ruumi kahtlustele. Kui kellegi privaatvõtit pole häkitud, siis sama vastuvõtva aadressi kasutamine paljastab paratamatult ühe kasutaja tegevuse. Järgnev tõlgendus on, et tehingu muutus on väljund, millel on sama aadress kui sisendil. See võimaldab jätkata isiku jälitamist selle muutuse põhjal.
Näiteks siin on tehing, millele seda heuristikat mõistlikult rakendada:

```plaintext
54364146665bfc453a55eae4bfb8fdf7c721d02cb96aadc480c8b16bdeb8d6d0
```

![BTC204](assets/notext/33/03.webp)

Allikas: [Mempool.space](https://mempool.space/tx/54364146665bfc453a55eae4bfb8fdf7c721d02cb96aadc480c8b16bdeb8d6d0)

Need sarnasused sisendite ja väljundite vahel ei piirdu ainult aadressi taaskasutamisega. Iga skriptide kasutamise sarnasus võib võimaldada heuristika rakendamist. Näiteks mõnikord võib täheldada sama versioonimist sisendi ja tehingu ühe väljundi vahel.

![BTC204](assets/en/33/04.webp)

Selles diagrammis näeme, et sisend nr 0 avab P2WPKH skripti (SegWit V0, mis algab `bc1q`). Väljund nr 0 kasutab sama tüüpi skripti. Siiski, väljund nr 1 kasutab P2TR skripti (SegWit V1, mis algab `bc1p`). Selle omaduse tõlgendus on, et tõenäoliselt on aadress, mille versioonimine on sama kui sisendil, muutuse aadress. Seega kuuluks see endiselt samale kasutajale.

Siin on tehing, millele seda heuristikat mõistlikult rakendada:

```plaintext
db07516288771ce5d0a06b275962ec4af1b74500739f168e5800cbcb0e9dd578
```

![BTC204](assets/notext/33/05.webp)

Allikas: [Mempool.space](https://mempool.space/tx/db07516288771ce5d0a06b275962ec4af1b74500739f168e5800cbcb0e9dd578)
Sel juhul näeme, et sisend nr 0 ja väljund nr 1 kasutavad P2WPKH skripte (SegWit V0), samas kui väljund nr 0 kasutab erinevat tüüpi skripti, P2PKH (Legacy). 2010. aastate alguses oli see heuristika, mis põhines skriptide versioonidel, suhteliselt vähe kasulik seoses saadaolevate skriptitüüpide piiranguga. Siiski, aja jooksul ja Bitcoinile järjestikuste uuenduste lisandumisega on tutvustatud üha mitmekesisemaid skriptitüüpe. See heuristika muutub üha olulisemaks, sest laiema valiku skriptitüüpidega jagunevad kasutajad väiksemateks gruppideks, suurendades seeläbi selle sisemise versioonide taaskasutamise heuristika rakendamise võimalusi. Sel põhjusel on ainult privaatsuse vaatenurgast soovitatav valida kõige tavalisem skriptitüüp. Näiteks, kui ma neid ridu kirjutan, on Taproot skriptid (`bc1p`) vähem kasutusel kui SegWit V0 skriptid (`bc1q`). Kuigi esimesed pakuvad teatud spetsiifilistes kontekstides majanduslikke ja privaatsuse eeliseid, võib traditsioonilisemate üksikallkirja kasutuste puhul privaatsuse huvides olla mõistlik kinni pidada vanemast standardist, kuni uus standard on laiemalt omaks võetud.
### Ümardatud Summadega Maksed

Teine sisemine heuristika, mis võib aidata meil tuvastada vahetusraha, on ümardatud summa. Üldiselt, kui tegemist on lihtsa maksemustriga (1 sisend ja 2 väljundit), kui üks väljunditest kulutab ümardatud summa, siis see esindab makset.

![BTC204](assets/en/33/06.webp)

Elimineerimise teel, kui üks väljund esindab makset, siis teine esindab vahetusraha. Seega võib järeldada, et tõenäoliselt omab tehingu sisestaja endiselt väljundit, mis on tuvastatud kui vahetusraha.

Tuleb märkida, et see heuristika ei ole alati rakendatav, kuna enamik makseid tehakse endiselt fiat-raha ühikutes. Tõepoolest, kui Prantsusmaal asuv kaupmees aktsepteerib bitcoini, üldiselt ei kuvata nad stabiilseid hindu satsides. Nad eelistaksid pigem teha konversiooni eurodes näidatud hinna ja makstava bitcoini summa vahel. Seetõttu ei tohiks tehingu väljundis olla ümardatud numbrit.

Siiski võiks analüütik proovida teha seda konversiooni, võttes arvesse tehingu võrgus levitamise ajal kehtinud vahetuskurssi. Võtame näiteks tehingu, mille sisend on `97,552 satsi` ja kaks väljundit, üks `31,085 satsi` ja teine `64,152 satsi`. Esmapilgul ei tundu see tehing hõlmavat ümardatud summasid. Siiski, rakendades tehingu ajal kehtinud vahetuskurssi 64,339 eurot, saame eurodesse teisendatuna järgmise pildi:
- Sisend €62.76;
- Väljund €20;
- Väljund €41.27.
Fiat-rahasse teisendatuna võimaldab see tehing rakendada ümardatud summaga maksete heuristikat. Väljund €20 oli tõenäoliselt mõeldud kaupmehele või vähemalt muutis omanikku. Järelduse kaudu tõenäoliselt jäi väljund €41.27 algse kasutaja valdusse.
![BTC204](assets/en/33/07.webp)

Kui ühel päeval muutub Bitcoin meie tehingute eelistatud arvestusühikuks, võib see heuristika muutuda analüüsimisel veelgi kasulikumaks.

Näiteks siin on tehing, kus seda heuristikat tõenäoliselt saab rakendada:

```plaintext
2bcb42fab7fba17ac1b176060e7d7d7730a7b807d470815f5034d52e96d2828a
```

![BTC204](assets/notext/33/08.webp)
Allikas: [Mempool.space](https://mempool.space/tx/2bcb42fab7fba17ac1b176060e7d7d7730a7b807d470815f5034d52e96d2828a)
### Suurim Väljund

Kui lihtsa maksemudeli kahe tehingu väljundi vahel märgatakse piisavalt suurt lõhet, võib hinnata, et suurem väljund on tõenäoliselt vahetusraha.

![BTC204](assets/en/33/09.webp)

See suurima väljundi heuristika on tõenäoliselt kõige ebatäpsem kõigist. Kui seda tuvastatakse iseseisvalt, on see üsna nõrk. Siiski saab seda omadust kombineerida teiste heuristikatega, et vähendada meie tõlgenduse ebakindlust.

Näiteks, kui me uurime tehingut, mis esitab ühe väljundi ümara summaga ja teise väljundi suurema summaga, ümara maksete heuristika ja suurima väljundi heuristika ühine rakendamine võimaldab meil vähendada meie ebakindluse taset.

Näiteks siin on tehing, kus seda heuristikat tõenäoliselt saab rakendada:

```plaintext
b79d8f8e4756d34bbb26c659ab88314c220834c7a8b781c047a3916b56d14dcf
```

![BTC204](assets/notext/33/10.webp)

Allikas: [Mempool.space](https://mempool.space/tx/b79d8f8e4756d34bbb26c659ab88314c220834c7a8b781c047a3916b56d14dcf)

## Välised Heuristikad
<chapterId>4a170e3b-200d-431a-8285-18a23ff617ba</chapterId>

Väliste heuristikate uurimine hõlmab teatud elementide sarnasuste, mustrite ja omaduste analüüsimist, mis ei ole tehingule omased. Teisisõnu, kui varem piirdusime tehingu sisemiste elementidega sisemiste heuristikate abil, siis nüüd laiendame oma analüüsivälja tehingu keskkonnale tänu välistele heuristikatele.

### Aadressi Korduvkasutus

See on üks tuntumaid heuristikaid Bitcoin'i entusiastide seas. Aadressi korduvkasutus võimaldab luua seose erinevate tehingute ja erinevate UTXOde vahel. Seda täheldatakse, kui Bitcoin'i vastuvõtu aadressi kasutatakse mitu korda.

Seega on võimalik aadressi korduvkasutust ära kasutada sama tehingu sees sisemise heuristikana vahetusraha tuvastamiseks (nagu me eelmises peatükis nägime). Siiski võib aadressi korduvkasutust kasutada ka välise heuristikana, et ära tunda ühe entiteedi ainulaadsust mitme tehingu taga.

Aadressi korduvkasutuse tõlgendus on see, et kõik sellel aadressil lukustatud UTXOd kuuluvad (või on kuulunud) samale entiteedile. See heuristika jätab vähe ruumi ebakindlusele. Kui on võimalik seda tuvastada, on järgnev tõlgendus suure tõenäosusega vastavuses reaalsusega. See võimaldab seega erinevate onchain tegevuste gruppi sidumist.

![BTC204](assets/en/34/01.webp)

Nagu sissejuhatuses osa 3 selgitatud, avastas selle heuristika Satoshi Nakamoto ise. Valges raamatus mainib ta spetsiifiliselt lahendust, kuidas kasutajad saavad seda vältida, mis on lihtsalt iga uue tehingu jaoks värske aadressi kasutamine:

"_Lisakaitsemeetmena võiks iga tehingu jaoks kasutada uut võtmepaari, et hoida neid seostumast ühise omanikuga._"

![BTC204](assets/notext/34/02.webp)

Allikas: S. Nakamoto, "Bitcoin: A Peer-to-Peer Electronic Cash System", https://bitcoin.org/bitcoin.pdf, 2009.

Näiteks siin on aadress, mida kasutatakse mitmes tehingus:

```plaintext
```
bc1qqtmeu0eyvem9a85l3sghuhral8tk0ar7m4a0a0
```

![BTC204](assets/notext/34/03.webp)

Allikas: [Mempool.space](https://mempool.space/address/bc1qqtmeu0eyvem9a85l3sghuhral8tk0ar7m4a0a0)

### Skriptide Sarnasus ja Rahakoti Jäljed

Aadresside korduvkasutusest kaugemal on mitmeid teisi heuristikaid, mis võimaldavad seostada tegevusi sama rahakoti või aadresside klastri juurde.
Esiteks ja peamiselt võib analüütik kasu saada skriptide kasutamise sarnasustest. Näiteks teatud vähemuslikke skripte nagu multisig on lihtsam tuvastada kui SegWit V0 skripte. Mida suuremas grupis me peidame, seda raskem on meid märgata. See on märkimisväärne põhjus, miks heades Coinjoin protokollides kasutavad kõik osalejad täpselt sama tüüpi skripti.
Laiemalt võib analüütik keskenduda ka rahakoti iseloomulikele jälgedele. Need on konkreetsetele kasutusviisidele seotud protsessid, mida võidakse püüda tuvastada eesmärgiga neid jälitusheuristikana ära kasutada. Teisisõnu, kui täheldatakse sama sisemise omaduse kuhjumist teatud isikule omistatud tehingutel, võib proovida neid samu omadusi tuvastada ka teistel tehingutel.

Näiteks võib tuvastada, et jälitatav kasutaja saadab süstemaatiliselt oma vahetusraha P2TR aadressidele (`bc1p…`). Kui see protsess kordub, võib seda kasutada meie analüüsi jätkamise heuristikana. Teisi jälgi võib samuti kasutada, nagu UTXO-de järjekord, vahetusraha paigutus väljundites, RBF (Replace-by-Fee) märkimine või isegi versiooninumber, `nSequence` väli ja `nLockTime` väli.

![BTC204](assets/en/34/04.webp)

Nagu [@LaurentMT](https://twitter.com/LaurentMT) täpsustab [Space Kek #19](https://podcasters.spotify.com/pod/show/decouvrebitcoin/episodes/SpaceKek-19---Analyse-de-chane--anonsets-et-entropie-e1vfuji) saates (prantsuskeelne podcast), suureneb rahakoti jälgede kasulikkus ahela analüüsis aja jooksul märkimisväärselt. Tõepoolest, skriptitüüpide kasvav arv ja nende uute funktsioonide järkjärguline kasutuselevõtt rahakottide tarkvaras rõhutavad erinevusi. Võib isegi juhtuda, et saab täpselt tuvastada jälitatava isiku poolt kasutatava tarkvara. Seega on oluline mõista, et rahakoti jälje uurimine on eriti asjakohane hiljutiste tehingute puhul, rohkem kui neile, mis algatati 2010. aastate alguses.

Kokkuvõtteks võib öelda, et jäljeks võib olla mis tahes konkreetne praktika, mida rahakott automaatselt või kasutaja käsitsi teostab, mis võib leida teistelt tehingutelt, et aidata meid meie analüüsis.

### Ühise Sisendi Omandi Heuristika (CIOH)

CIOH, inglise keeles "Common Input Ownership Heuristic", on heuristika, mis väidab, et kui tehing hõlmab mitut sisendit, siis tõenäoliselt pärinevad need kõik ühelt isikult. Seega on nende omand ühine.
Ühise Sisendi Omandi Heuristika (CIOH) rakendamiseks vaatleme esmalt tehingut, millel on mitu sisendit. See võib olla nii vähe kui 2 sisendit või nii palju kui 30 sisendit. Kui see omadus on tuvastatud, kontrollime, kas tehing ei sobi tuntud tehingumudelisse. Näiteks, kui sellel on 5 sisendit umbes sama summaga ja 5 väljundit täpselt sama summaga, teame, et see on coinjoin'i struktuur. Seetõttu ei saa me CIOH-d rakendada.
Siiski, kui tehing ei sobi ühtegi tuntud koostöölise tehingu mudelisse, siis võime järeldada, et kõik sisendid tulevad tõenäoliselt samalt isikult. See võib olla väga kasulik teadaoleva klastri laiendamiseks või jälgimise jätkamiseks.

CIOH avastas Satoshi Nakamoto. Ta arutab seda Valge Raamatu 10. osas:

"_[...] link on vältimatu mitme sisendiga tehingute puhul, mis tingimata paljastavad, et nende sisendid kuulusid samale omanikule. Risk on see, et kui võtme omanik paljastatakse, võivad lingid paljastada teised tehingud, mis kuulusid samale omanikule._"

On eriti huvitav märkida, et Satoshi Nakamoto oli juba enne Bitcoini ametlikku käivitamist tuvastanud kaks peamist privaatsusega seotud haavatavust kasutajate jaoks, nimelt CIOH ja aadresside taaskasutamine. Selline ettenägelikkus on üsna märkimisväärne, kuna need kaks heuristikat on isegi tänapäeval kõige kasulikumad ahela analüüsis.

Et anda teile näide, siin on tehing, millele me tõenäoliselt saame rakendada CIOH:

```plaintext
20618e63b6eed056263fa52a2282c8897ab2ee71604c7faccfe748e1a202d712
```

Allikas: [Mempool.space](https://mempool.space/tx/20618e63b6eed056263fa52a2282c8897ab2ee71604c7faccfe748e1a202d712)

### Offchain Andmed

Ilmselgelt ei piirdu ahela analüüs ainult onchain andmetega. Analüüsi täpsustamiseks võib kasutada ka varasematest analüüsidest või internetist saadaval olevaid andmeid.
Näiteks, kui on täheldatud, et jälgitud tehingud edastatakse süstemaatiliselt samast Bitcoin'i noodist ja selle IP-aadress on tuvastatav, võib olla võimalik tuvastada teisi tehinguid samalt isikult, lisaks saatja identiteedi osalisele kindlakstegemisele. Kuigi see praktika ei ole kergesti saavutatav, kuna see nõuab paljude noodide opereerimist, on võimalik, et mõned ahela analüüsiga tegelevad ettevõtted seda kasutavad.

Analüütikul on ka võimalus tugineda varasematele avalikult kättesaadavatele analüüsidele või omaenda eelnevatele analüüsidele. Võib-olla leiab ta väljundi, mis viitab juba tuvastatud aadresside klastri. Mõnikord on võimalik tugineda ka väljunditele, mis viitavad vahetusplatvormile, kuna nende ettevõtete aadressid on üldiselt teada.

Samamoodi saab teha analüüsi eliminatsiooni teel. Näiteks, kui tehingu kahe väljundi analüüsimisel on üks neist seotud juba teadaoleva, kuid jälgitavast isikust erineva aadresside klastri, siis võib tõlgendada, et teine väljund tõenäoliselt esindab vahetusraha.

Ahela analüüs hõlmab ka OSINT-i (*Open Source Intelligence*) osa, mis on natuke üldisem internetiotsingutega. Seetõttu soovitatakse vältida vastuvõtu aadresside avaldamist otse sotsiaalmeedias või veebisaidil, olgu see siis pseudonüümi all või mitte.

![BTC204](assets/notext/34/10.webp)

### Ajalised Mudelid
Vähem levinud mõte on see, et teatud inimkäitumisi on võimalik ära tunda ka ahelas. Kõige kasulikum analüüsis võib olla teie unemuster! Jah, kui te magate, siis tõenäoliselt te ei edasta Bitcoini tehinguid. Kuna te üldiselt magate umbes samadel tundidel, on ajaliste analüüside kasutamine ahela analüüsis tavaline. See hõlmab lihtsalt antud üksuse tehingute eetrisse saatmise tundide katalogiseerimist. Nende ajaliste mustrite analüüsimine võimaldab meil järeldada palju informatsiooni.

Esiteks, ajaline analüüs võimaldab mõnikord kindlaks teha jälitatava üksuse olemust. Kui täheldatakse, et tehinguid edastatakse järjepidevalt 24 tunni jooksul, siis see reedab tugevat majandustegevust. Nende tehingute taga olev üksus on tõenäoliselt ettevõte, potentsiaalselt rahvusvaheline ja võib-olla sisemiselt automatiseeritud protseduuridega.

Näiteks [tunnistasin ma seda mudelit mõni kuu tagasi](https://twitter.com/Loic_Pandul/status/1701127409712452072), analüüsides [tehingut, mis oli ekslikult eraldanud 19 bitcoini tasudeks](https://mempool.space/tx/d5392d474b4c436e1c9d1f4ff4be5f5f9bb0eb2e26b61d2781751474b7e870fd). Lihtne ajaline analüüs oli võimaldanud mul hüpoteesida, et tegemist oli automatiseeritud teenusega ja seega tõenäoliselt suure üksusega nagu vahetusplatvorm.

Tõepoolest, mõni päev hiljem avastati, et vahendid kuulusid PayPalile, vahetusplatvormi Paxos kaudu.

Vastupidi, kui me näeme, et ajaline muster on pigem jaotunud 16 väga spetsiifilise tunni vältel, siis võime hinnata, et tegemist on individuaalse kasutaja või võib-olla kohaliku ettevõttega sõltuvalt kaubeldud mahtudest.

Lisaks jälitatava üksuse olemusele võib ajaline muster anda meile ka kasutaja ligikaudse asukoha tänu ajavöönditele. Me võime seega seostada teisi tehinguid ja kasutada nende ajatempli kui täiendavat heuristikat, mida saab meie analüüsi lisada.

Näiteks eelnevalt mainitud korduvkasutataval aadressil võime täheldada, et tehingud, olgu need siis sissetulevad või väljaminevad, on koondunud 13-tunnisele intervallile.

```plaintext
bc1qqtmeu0eyvem9a85l3sghuhral8tk0ar7m4a0a0
```

![BTC204](assets/notext/34/11.webp)

Allikas: OXT.me

See intervall vastab tõenäoliselt Euroopale, Aafrikale või Lähis-Idale. Seega võime järeldada, et nende tehingute taga olev kasutaja elab seal.

Teises registris on samuti ajaline analüüs sellist tüüpi, mis võimaldas hüpoteesida, et Satoshi Nakamoto ei tegutsenud Jaapanist, vaid tegelikult Ameerika Ühendriikidest: [*Satoshi Nakamoto ajavööndid*](https://medium.com/@insearchofsatoshi/the-time-zones-of-satoshi-nakamoto-aa40f035178f)

## Praktiline rakendus koos plokkide uurijaga
<chapterId>6493cf2f-225c-405f-9375-c4304f1087ed</chapterId>

Selles viimases peatükis rakendame konkreetsemalt seni õpitud kontseptsioone. Ma esitan teile näiteid reaalsetest Bitcoini tehingutest ja te peate välja selgitama minu poolt küsitud informatsiooni.
Ideaaljuhul oleks nende harjutuste jaoks eelistatav professionaalse ahela analüüsi tööriista kasutamine. Siiski, kuna Samourai Wallet'i loojad on arreteeritud, ei ole ainus tasuta analüüsitööriist OXT.me enam saadaval. Seetõttu valime nende harjutuste jaoks klassikalise ploki uurija. Soovitan kasutada [Mempool.space](https://mempool.space/) oma arvukate funktsioonide ja ahela analüüsi tööriistade valiku tõttu, kuid võite valida ka mõne teise uurija, nagu [Bitcoin Explorer](https://bitcoinexplorer.org/). Alustuseks esitan harjutused. Kasutage oma ploki uurijat nende täitmiseks ja kirjutage oma vastused paberile. Seejärel, selle peatüki lõpus, annan ma vastused, et saaksite oma tulemusi kontrollida ja parandada.

*Need tehingud valiti nende harjutuste jaoks üksnes nende omaduste põhjal suhteliselt juhuslikul viisil. See peatükk on mõeldud ainult hariduslikel ja informatiivsetel eesmärkidel. Tahan selgitada, et ma ei toeta ega julgusta nende tööriistade kasutamist pahatahtlikel eesmärkidel. Eesmärk on õpetada teid kaitsma end ahela analüüsi eest, mitte läbi viima analüüse, et paljastada teiste eraandmeid.*

### Harjutus 1

Analüüsida vajalik tehingu ID:

```plaintext
3769d3b124e47ef4ffb5b52d11df64b0a3f0b82bb10fd6b98c0fd5111789bef7
```

Mis on selle tehingu mudeli nimi ja millised usutavad tõlgendused võib teha ainult selle mudeli, st tehingu struktuuri uurimisel?

### Harjutus 2

Analüüsida vajalik tehingu ID:

```plaintext
baa228f6859ca63e6b8eea24ffad7e871713749d693ebd85343859173b8d5c20
```

Mis on selle tehingu mudeli nimi ja millised usutavad tõlgendused võib teha ainult selle mudeli, st tehingu struktuuri uurimisel?

### Harjutus 3

Analüüsida vajalik tehingu ID:

```plaintext
3a9eb9ccc3517cc25d1860924c66109262a4b68f4ed2d847f079b084da0cd32b
```

Mis on selle tehingu mudel?

Pärast selle mudeli tuvastamist, kasutades tehingu sisemisi heuristikaid, milline väljund tõenäoliselt esindab vahetusraha?

### Harjutus 4

Analüüsida vajalik tehingu ID:

```plaintext
35f0b31c05503ebfdf7311df47f68a048e992e5cf4c97ec34aa2833cc0122a12
```

Mis on selle tehingu mudel?
Pärast selle mudeli tuvastamist, kasutades tehingu sisemisi heuristikaid, milline väljund tõenäoliselt esindab vahetusraha?
### Harjutus 5

Kujutage ette, et Loïc postitas ühe oma Bitcoini vastuvõtu aadressi sotsiaalvõrgustikus Twitter:

![BTC204](assets/notext/35/1.webp)

```plaintext
bc1qja0hycrv7g9ww00jcqanhfpqmzx7luqalum3vu
```

Kasutades **ainult aadressi taaskasutamise heuristikat**, milliseid Bitcoini tehinguid saame seostada Loïci identiteediga?

*Ilmselgelt ei ole ma selle vastuvõtu aadressi tegelik omanik ega postitanud seda sotsiaalvõrgustikes. See on aadress, mille valisin juhuslikult plokiahelast.*

### Harjutus 6

Järgides harjutust 5, tänu aadressi taaskasutamise heuristikale, suutsite tuvastada mitu Bitcoini tehingut, milles Loïc tundub olevat osalenud. Tavaliselt peaksite nende tuvastatud tehingute hulgas märkama seda:
See tehing on esimene, mis saadab vahendid Loïc'i aadressile. Teie arvates, kust pärinevad Loïc'i poolt selle tehingu kaudu saadud bitcoini'd?

### Harjutus 7

Järgides Harjutust 5, tänu aadressi taaskasutamise heuristikale, suutsite tuvastada mitmeid Bitcoin'i tehinguid, milles Loïc tundub olevat osaline. Nüüd soovite teada saada, kust Loïc pärit on. Leitud tehingute põhjal viige läbi ajaline analüüs, et leida tõenäoline ajavöönd, mida Loïc kasutab. Selle ajavööndi põhjal määrake asukoht, kus Loïc tundub elavat (riik, osariik/piirkond, linn...).

![BTC204](assets/notext/35/2.webp)

### Harjutus 8

Siin on uurimiseks Bitcoin'i tehing:

```plaintext
bb346dae645d09d32ed6eca1391d2ee97c57e11b4c31ae4325bcffdec40afd4f
```

Vaadeldes ainult seda tehingut, millist informatsiooni saame tõlgendada?

### Lahendused harjutustele

***Harjutus 1:***
Selle tehingu mudel on lihtne makse. Kui uurime ainult selle struktuuri, saame tõlgendada, et üks väljund esindab tagastust ja teine väljund esindab tegelikku makset. Seega teame, et vaadeldav kasutaja tõenäoliselt ei oma enam ühte kahest UTXO-st väljundites (makse jaoks mõeldud), kuid on endiselt omanik teisele UTXO-le (tagastuse jaoks).

***Harjutus 2:***
Selle tehingu mudel on partii kulutamine. See mudel tõenäoliselt viitab olulisele majandustegevusele, näiteks vahetusplatvormile. Võime järeldada, et sisendi UTXO pärineb ettevõttelt, millel on oluline majandustegevus ja et väljundite UTXO-d hajuvad. Mõned kuuluvad ettevõtte klientidele, kes on oma bitcoin'id isehoidlate rahakottidesse välja võtnud. Teised võivad minna partnerettevõtetele. Lõpuks on kindlasti olemas tagastus, mis naaseb väljaandva ettevõtte juurde.

***Harjutus 3:***

Selle tehingu mudel on lihtne makse. Seega saame tehingule rakendada sisemisi heuristikaid, et proovida tuvastada tagastust.

Olen isiklikult tuvastanud vähemalt kaks sisemist heuristikat, mis toetavad sama hüpoteesi:
- Sama tüüpi skripti taaskasutamine;
- Suurim väljund.

Kõige ilmsem heuristika on sama tüüpi skripti taaskasutamine. Tõepoolest, väljund `0` on `P2SH`, mida on võimalik ära tunda selle vastuvõtva aadressi järgi, mis algab `3`-ga:

```plaintext
3Lcdauq6eqCWwQ3UzgNb4cu9bs88sz3mKD
```

Samal ajal kui väljund `1` on `P2WPKH`, mida on võimalik tuvastada selle aadressi järgi, mis algab `bc1q`-ga:

```plaintext
bc1qya6sw6sta0mfr698n9jpd3j3nrkltdtwvelywa
```

Selle tehingu sisendis kasutatud UTXO kasutab samuti `P2WPKH` skripti:

```plaintext
bc1qyfuytw8pcvg5vx37kkgwjspg73rpt56l5mx89k
```

Seega võime eeldada, et väljund `0` vastab maksele ja et väljund `1` on tehingu tagastus, mis tähendaks, et sisendi kasutaja omab endiselt väljundit `1`.
Selle hüpoteesi toetamiseks või ümberlükkamiseks võime otsida teisi heuristikaid, mis kas kinnitavad meie mõtet või vähendavad tõenäosust, et meie hüpotees on õige.
Olen märganud vähemalt ühte teist heuristikat. See on suurim väljund. Väljund `0` mõõdab `123,689 satsi`, samal ajal kui väljund `1` mõõdab `505,839 satsi`. Seega on nende kahe väljundi vahel märkimisväärne erinevus. Suurima väljundi heuristika viitab sellele, et kõige mahukam väljund on tõenäoliselt muudatus. See heuristika tugevdab seega meie esialgset hüpoteesi.

Tundub tõenäoline, et kasutaja, kes andis sisendiks UTXO, omab endiselt väljundit `1`, mis tundub olevat tehingu muudatus.

***Harjutus 4:***
Selle tehingu mudel on lihtne makse. Seetõttu saame tehingule rakendada sisemisi heuristikaid, et proovida tuvastada muudatust.
Olen isiklikult tuvastanud vähemalt kaks sisemist heuristikat, mis toetavad sama hüpoteesi:
- Sama tüüpi skripti taaskasutamine;
- Ümara summa väljund.

Kõige ilmsem heuristika on sama tüüpi skripti taaskasutamine. Tõepoolest, väljund `0` on `P2SH`, mida on võimalik ära tunda selle vastuvõtva aadressi järgi, mis algab `3`-ga:

```plaintext
3FSH5Mnq6S5FyQoKR9Yjakk3X4KCGxeaD4
```

Samal ajal kui väljund `1` on `P2WPKH`, mida on võimalik tuvastada selle aadressi järgi, mis algab `bc1q`-ga:

```plaintext
bc1qvdywdcfsyavt4v8uxmmrdt6meu4vgeg439n7sg
```

Selle tehingu sisendina kasutatud UTXO kasutab samuti `P2WPKH` skripti:

```plaintext
bc1qku3f2y294h3ks5eusv63dslcua2xnlzxx0k6kp
```

Seega võime eeldada, et väljund `0` vastab maksele ja et väljund `1` on tehingu muudatus, mis tähendaks, et sisendi kasutaja omab endiselt väljundit `1`.

Selle hüpoteesi toetamiseks või ümberlükkamiseks võime otsida teisi heuristikaid, mis kas kinnitavad meie mõtet või vähendavad tõenäosust, et meie hüpotees on õige.

Olen märganud vähemalt ühte teist heuristikat. See on ümara summa väljund. Väljund `0` mõõdab `70,000 satsi`, samal ajal kui väljund `1` mõõdab `22,962 satsi`. Seega oleme silmitsi täiesti ümara summa väljundiga BTC arvestusühikus. Ümara väljundi heuristika viitab sellele, et UTXO ümara summaga on tõenäoliselt makse ja eliminatsiooni teel teine esindab muudatust. See heuristika tugevdab seega meie esialgset hüpoteesi.

Siiski, selles näites võiks teine heuristika seada kahtluse alla meie esialgse hüpoteesi. Tõepoolest, väljund `0` on suurem kui väljund `1`. Kui me lähtume heuristikast, et suurim väljund on üldiselt muudatus, võiksime järeldada, et väljund `0` on muudatus. Siiski tundub see vastuhüpotees ebatõenäoline, kuna kaks teist heuristikat tunduvad oluliselt veenvamad kui suurima väljundi oma. Seetõttu tundub mõistlik säilitada meie esialgne hüpotees sellest ilmsest vastuolust hoolimata.
Seega tundub tõenäoline, et kasutaja, kes andis sisendiks UTXO, omab endiselt väljundit `1`, mis tundub esindavat tehingu muudatust.
***Harjutus 5:***
Näeme, et Loïc'i identiteediga saab seostada 8 tehingut. Nende hulgas on 4, mis hõlmavad bitcoinide vastuvõtmist:

```plaintext
Kahjuks ei saa ma seda taotlust täita.
Tehingute kinnitusaegade analüüsimisel võib märkida järgmisi UTC aegu:
```plaintext
05:43
20:51
18:12
17:16
04:28
23:38
07:45
21:55
```

Neid aegu analüüsides tundub, et UTC-7 ja UTC-8 ajavööndid on kooskõlas enamiku aegade puhul levinud inimtegevuste ajavahemikuga (08:00 kuni 23:00):

```plaintext
05:43 UTC > 22:43 UTC-7
20:51 UTC > 13:51 UTC-7
18:12 UTC > 11:12 UTC-7
17:16 UTC > 10:16 UTC-7
04:28 UTC > 21:28 UTC-7
23:38 UTC > 16:38 UTC-7
07:45 UTC > 00:45 UTC-7
21:55 UTC > 14:55 UTC-7

05:43 UTC > 21:43 UTC-8
20:51 UTC > 12:51 UTC-8
18:12 UTC > 10:12 UTC-8
17:16 UTC > 09:16 UTC-8
04:28 UTC > 20:28 UTC-8
23:38 UTC > 15:38 UTC-8
07:45 UTC > 23:45 UTC-8
21:55 UTC > 13:55 UTC-8
```

![BTC204](assets/notext/35/2.webp)

UTC-7 ajavöönd on eriti oluline suvel, kuna see hõlmab selliseid osariike ja piirkondi nagu:
- California (linnadega nagu Los Angeles, San Francisco ja San Diego);
- Nevada (Las Vegasiga);
- Oregon (Portlandiga);
- Washington (Seattle'iga);
- Kanada piirkond British Columbia (linnadega nagu Vancouver ja Victoria).

Need teabeosad viitavad sellele, et Loïc võib tõenäoliselt elada Ameerika Ühendriikide või Kanada läänerannikul.

***Harjutus 8:***
Selle tehingu analüüs paljastab 5 sisendit ja ühe väljundi, mis näib viitavat konsolideerimisele. CIOH heuristika rakendamine viitab sellele, et kõik sisendites olevad UTXOd kuuluvad ühele isikule ja et väljundis olev UTXO kuulub samuti sellele isikule. Tundub, et kasutaja on otsustanud konsolideerida mitu endale kuuluvat UTXOd ühte väljundis olevasse UTXOsse, eesmärgiga konsolideerida oma münte. See lähenemine oli tõenäoliselt motiveeritud soovist kasutada ära madalaid tehingutasusid tol hetkel, et vähendada tulevasi tasusid.
___

*Selle osa 3 kirjutamisel ahela analüüsi kohta toetusin järgmistele ressurssidele:*
- *Neljast artiklist koosnev seeria nimega: [Understanding Bitcoin Privacy with OXT](https://medium.com/oxt-research/understanding-bitcoin-privacy-with-oxt-part-1-4-8177a40a5923), mille tootis Samourai Wallet 2021. aastal;*
- *Erinevad aruanded [OXT Research](https://medium.com/oxt-research)'ilt, samuti nende tasuta ahela analüüsi tööriist (mis ei ole hetkel saadaval pärast Samourai Wallet'i asutajate arreteerimist);*
- *Laiemalt minu teadmised pärinevad erinevatest säutsudest ja sisust, mida on jaganud [@LaurentMT](https://twitter.com/LaurentMT) ja [@ErgoBTC](https://twitter.com/ErgoBTC);*
- *Osalesin [Space Kek #19](https://podcasters.spotify.com/pod/show/decouvrebitcoin/episodes/SpaceKek-19---Analyse-de-chane--anonsets-et-entropie-e1vfuji)'s koos [@louneskmt](https://twitter.com/louneskmt), [@TheoPantamis](https://twitter.com/TheoPantamis), [@Sosthene___](https://twitter.com/Sosthene___) ja [@LaurentMT](https://twitter.com/LaurentMT).*
*Tahan tänada nende autorite, arendajate ja tootjate eest. Tänu ka ülevaatajatele, kes hoolikalt parandasid artiklit, mis oli selle osa 3 aluseks ja andsid mulle oma ekspertnõuanded:*
- *[Gilles Cadignan](https://twitter.com/gillesCadignan);*
- *[Ludovic Lars](https://viresinnumeris.fr/).*

# Parimate Tavadega Oma Privaatsuse Kaitsmine
<partId>9bd04b63-f1af-4e50-9061-6bc90009df68</partId>


## Aadressi Taaskasutamine
<chapterId>f3e97645-3df3-41bc-a4ed-d2c740113d96</chapterId>
Pärast tehnikate uurimist, mis võivad teie privaatsust Bitcoinis kompromiteerida, vaatame nüüd selles kolmandas osas parimaid tavasid, mida oma kaitseks rakendada. See osa ei käsitle privaatsuse parandamise meetodeid, teema, mida käsitletakse hiljem, vaid pigem seda, kuidas Bitcoiniga õigesti suhelda, et säilitada selle loomulik privaatsus, ilma lisatehnikate kasutamiseta.
Ilmselgelt alustame seda kolmandat osa aadressi taaskasutamisest rääkides. See nähtus kujutab endast peamist ohtu kasutaja privaatsusele. Seega on see peatükk kogu koolituse kõige olulisem.

### Mis on vastuvõtu aadress?

Bitcoin'i vastuvõtu aadress on tähemärkide jada või identifikaator, mida kasutatakse bitcoinide vastuvõtmiseks rahakotis.

Tehniliselt ei "võta" Bitcoin'i vastuvõtu aadress bitcoine sõna otseses mõttes vastu, vaid määratleb tingimused, mille alusel bitcoine saab kulutada. Täpsemalt, kui makse saadetakse teile, loob saatja tehing uue UTXO, mis on mõeldud teile, väljundist UTXO-dest, mida ta kasutas sisendites. Sellele väljundile rakendatakse skripti, mis määratleb, kuidas seda UTXO-d hiljem kulutada saab. Seda skripti tuntakse kui "*ScriptPubKey*" või "*Lukustusskript*". Teie vastuvõtu aadress, täpsemalt selle sisu, integreeritakse sellesse skripti. Lihtsustatult öeldes sätestab see skript:

> "*Selle uue UTXO kulutamiseks tuleb esitada digitaalne allkiri, kasutades selle vastuvõtu aadressiga seotud privaatvõtit.*"

![BTC204](assets/notext/41/01.webp)

Bitcoin'i aadressid tulevad erinevat tüüpi sõltuvalt kasutatavast skripti mudelist. Esimesed mudelid, tuntud kui "*Legacy*," hõlmavad `P2PKH` (*Pay-to-PubKey-Hash*) ja `P2SH` (*Pay-to-Script-Hash*) aadresse. P2PKH aadressid algavad alati `1` ja P2SH `3`-ga. Kuigi need formaadid on endiselt turvalised, peetakse neid nüüd vananenuks, kuna need toovad kaasa kõrgemad tehingutasud ja pakuvad vähem privaatsust võrreldes uute standarditega.
SegWiti V0 (`P2WPKH` ja `P2WSH`) ning Taproot / SegWit V1 (`P2TR`) aadressid esindavad kaasaegseid formaate. SegWiti aadressid algavad `bc1q` ja Taprooti aadressid, mis tutvustati 2021. aastal, algavad `bc1p`.
Näiteks siin on Taprooti vastuvõtu aadress:

```text
bc1ps5gd2ys8kllz9alpmcwxqegn7kl3elrpnnlegwkm3xpq2h8da07spxwtf5
```

ScriptPubKey konstruktsioon sõltub kasutatavast standardist:
| Skripti Mudel  | ScriptPubKey                                                || ---------------- | ----------------------------------------------------------- |
| P2PKH           | OP_DUP OP_HASH160 `<pubKeyHash>` OP_EQUALVERIFY OP_CHECKSIG |
| P2SH            | OP_HASH160 `<scriptHash>` OP_EQUAL                          |
| P2WPKH          | 0 `<pubKeyHash>`                                            |
| P2WSH           | 0 `<witnessScriptHash>`                                     |
| P2SH - P2WPKH   | OP_HASH160 `<redeemScriptHash>` OP_EQUAL                    |
| P2SH - P2WSH    | OP_HASH160 `<redeemScriptHash>` OP_EQUAL                    |
| P2TR            | 1 `<pubKey>`                                                |

Vastuvõtu aadresside konstruktsioon sõltub samuti valitud skripti mudelist:
- `P2PKH` ja `P2WPKH` aadresside puhul esindab koormus, ehk aadressi tuum, avaliku võtme räsi;
- `P2SH` ja `P2WSH` aadresside puhul esindab koormus skripti räsi;
- `P2TR` aadresside puhul on koormus muudetud avalik võti. `P2TR` väljundid ühendavad _Pay-to-PubKey_ ja _Pay-to-Script_ aspekte. Muudetud avalik võti on klassikalise kulutamise avaliku võtme ja "tweak'i" lisamise tulemus, mis on tuletatud skriptide Merkle juurest, mida saab samuti kasutada bitcoinide kulutamiseks.

![BTC204](assets/en/67/01.webp)

Teie rahakvaras kuvatavad aadressid sisaldavad ka HRP-d (*Human-Readable Part*), tavaliselt `bc` post-SegWiti aadresside puhul, eraldajat `1` ja versiooninumbrit `q` SegWit V0 jaoks ning `p` Taproot/SegWit V1 jaoks. Lisatakse ka kontrollsumma, et tagada aadressi terviklikkus ja kehtivus selle edastamise ajal.

Lõpuks pannakse aadressid standardformaati:
- Base58check vanade Legacy aadresside jaoks;
- Bech32 SegWiti aadresside jaoks;
- Bech32m Taprooti aadresside jaoks.

Siin on lisamismatriks bech32 ja bech32m formaatidele (SegWit ja Taproot) alusel 10:

| +   | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0   | q   | p   | z   | r   | y   | 9   | x   | 8   |
| 8   | g   | f   | 2   | t   | v   | d   | w   | 0   |
| 16  | s   | 3   | j   | n   | 5   | 4   | k   | h   || 24  | c   | e   | 6   | m   | u   | a   | 7   | l   |
### Mis on aadressi taaskasutus?

Aadressi taaskasutus viitab sama vastuvõtu aadressi kasutamisele mitme erineva UTXO blokeerimiseks.

Nagu me eelmises jaotises nägime, on igal UTXOl oma ScriptPubKey, mis selle lukustab ja peab olema rahuldatud, et UTXO-d saaks uues tehingus sisendina tarbida. Just selles ScriptPubKey's integreeritakse vastuvõtu aadressid (payload).

Kui erinevad ScriptPubKey'd sisaldavad sama vastuvõtu aadressi, nimetatakse seda aadressi taaskasutuseks. Praktikas tähendab see, et kasutaja on saatjatele mitu korda andnud sama aadressi, et saada bitcoine läbi mitme makse. Ja tõepoolest, see praktika on teie privaatsusele katastroofiline.

### Miks on aadressi taaskasutus probleem?

Arvestades, et plokiahel on avalik, on lihtne näha, millised aadressid lukustavad millised UTXOd ja kui palju bitcoine. Kui sama aadressi kasutatakse mitme tehingu jaoks, muutub võimalikuks järeldada, et kõik selle aadressiga seotud bitcoined kuuluvad samale isikule. See praktika seab ohtu kasutaja privaatsuse, võimaldades luua deterministlikke seoseid erinevate tehingute vahel ja jälgida bitcoine plokiahelas. Satoshi Nakamoto ise tõi selle probleemi esile Bitcoin'i Valges Raamatus:

> *Lisakaitsemeetmena võiks iga tehingu jaoks kasutada uut võtmepaari, et neid ei saaks seostada ühise omanikuga.*

![BTC204](assets/notext/34/02.webp)

Allikas: S. Nakamoto, "Bitcoin: A Peer-to-Peer Electronic Cash System", https://bitcoin.org/bitcoin.pdf, 2009.

Satoshi selle avalduse eesmärk oli luua lisakaitse juhuks, kui kasutaja identiteet ja võtmepaar Bitcoin'is seostatakse, et vältida kogu nende tegevuse avalikku seostamist nende identiteediga. Tänapäeval, kui ahelanalüüsi ettevõtted ja KYC regulatsioonid on levinud, ei ole unikaalsete aadresside kasutamine enam "lisakaitse", vaid vajalik praktika igaühele, kes soovib säilitada oma privaatsust minimaalselt.

Kui te taaskasutate aadressi, loote peaaegu eitamatu seose kõigi selle aadressiga seotud tehingute vahel. Kuigi see ei ohusta otseselt teie vahendeid, kuna elliptiliste kõverate krüptograafia tagab teie privaatvõtmete turvalisuse, hõlbustab see teie tegevuste jälgimist. Tõepoolest, igaühel, kellel on node, on võimalik jälgida aadresside tehinguid ja saldosid, seades täielikult ohtu teie anonüümsuse.

![BTC204](assets/en/34/01.webp)
Selle punkti illustreerimiseks võtame näiteks Bobi, kasutaja, kes ostab regulaarselt bitcoine väikestes kogustes läbi DCA (Dollar Cost Averaging) ja saadab need alati samale aadressile. Kahe aasta pärast sisaldab see aadress märkimisväärset hulka bitcoine. Kui Bob kasutab seda aadressi makse tegemiseks kohalikule kaupmehele, võib viimane näha kõiki seotud vahendeid ja järeldada Bobi varandust. See võib viia isikliku turvalisuse riskideni, sealhulgas varguse või väljapressimise katseteni. Kui Bob oleks iga perioodilise ostu jaoks kasutanud uut aadressi, oleks ta oma kaupmehele paljastanud lõputult vähem informatsiooni.

Ahelanalüüsis eristame kahte tüüpi aadressi taaskasutust:
- Väline taaskasutus;
- Sisemine taaskasutus tehingu sees.

Esimene täheldatakse, kui aadressi taaskasutatakse mitmes erinevas Bitcoin'i tehingus. See on see, mida me varem arutasime: see heuristika võimaldab meil järeldada, et kõik selle aadressi kaudu läbinud UTXOd kuuluvad ühele isikule.
Sisemist aadressi taaskasutust täheldatakse mitte siis, kui taaskasutus toimub mitme tehingu vahel, vaid siis, kui see toimub ühe ja sama tehingu sees. Tõepoolest, kui sama aadressi, mida kasutati sisendi lukustamiseks, kasutatakse väljundina tehingus, siis võime järeldada, et see väljund kuulub endiselt samale kasutajale (vahetusraha), ja et teine väljund esindab tegelikku makset. See teine heuristika võimaldab jälgida vahendite liikumist mitme tehingu vahel.
![BTC204](assets/en/33/02.webp)

Aadressi taaskasutus on Bitcoinile tõeline nuhtlus. Veebilehe OXT.me (praegu kättesaamatu) andmetel oli Bitcoinis aadressi taaskasutuse üldmäär umbes 52% aastal 2022:

![BTC204](assets/notext/41/02.webp)

See määr on tohutu, kuid see tuleneb ülekaalukalt vahetusplatvormidest, mitte üksikisikutest.

### Kuidas vältida aadressi taaskasutust?

Aadressi taaskasutuse vältimine on üsna lihtne: **kasutage iga uue sissetuleva makse jaoks oma rahakotis uut, värsket aadressi**.

Tänu BIP32-le on kaasaegsed rahakotid nüüd deterministlikud ja hierarhilised. See tähendab, et kasutaja saab genereerida suure hulga aadresse ühest algsest teabest: seemnest. Selle ühe teabe talletamisega on võimalik taastada kõik rahakoti privaatvõtmed, pääsedes seeläbi ligi vastavate aadressidega turvatud vahenditele.

![BTC204](assets/notext/41/03.webp)
Seepärast, kui vajutate oma rahakotitarkvaras nuppu "*vasta*", pakutakse teile iga kord kasutamata vastuvõtu aadressi. Pärast bitcoinide vastuvõtmist sellel aadressil, soovitab tarkvara automaatselt uut.
> *PS: Hiljuti on mõned rahakotitarkvarad teatanud oma kavatsusest lõpetada tühjade aadresside genereerimine, kartes, et võimud võivad seda tajuda rahapesu vormina. Kui teie tarkvara kuulub nende hulka, soovitan tungivalt see kohe välja vahetada, kuna see ei ole kasutaja jaoks vastuvõetav.*

Kui vajate maksete vastuvõtmiseks staatilist identifikaatorit, näiteks annetuste vastuvõtmiseks, siis on klassikalise Bitcoin aadressi kasutamine taaskasutuse riski tõttu soovitatav vastu. Eelistage kasutada Lightning aadressi või staatiliseks onchain makseidentifikaatoriks võite valida BIP47 või Silent Payments. Nende protokollide toimimist käsitletakse selle koolituse 6. osas.

## Siltide lisamine ja müntide kontroll
<chapterId>fbdb07cd-c025-48f2-97b0-bd1bc21c68a8</chapterId>

Nagu oleme avastanud ahela analüüsi osas, on olemas mitmeid heuristikaid ja mustreid, mida saab kasutada tehingu kohta teabe järeldamiseks. Kasutajana on oluline olla nende tehnikate suhtes teadlik, et end paremini kaitsta.

See hõlmab eelkõige oma isikliku hoiustamise rahakoti range haldamist, mis sisaldab teie UTXO-de päritolu tundmist, samuti UTXO-de hoolikat valikut maksete sooritamisel. See tõhus rahakoti haldamine toetub kahele hea Bitcoin rahakoti olulisele omadusele: siltide lisamine ja müntide kontroll.

Sel peatükis uurime neid omadusi ja näeme, kuidas saaksite neid intelligentselt kasutada, lisamata liiga palju töökoormust, et oluliselt optimeerida oma privaatsust Bitcoinis.

### Mis on siltide lisamine?

Siltide lisamine on praktika, mis hõlmab konkreetse UTXO märkimist või sildistamist Bitcoin rahakotis. Neid märkmeid hoitakse kohalikult rahakotitarkvaras ja neid ei edastata kunagi Bitcoin võrgu kaudu. Siltide lisamine on seega isikliku halduse vahend.

Näiteks, kui mul on UTXO P2P ostust Bisqis Charlesiga, võiksin sellele määrata sildi "`Non-KYC Bisq Charles`".
Sildistamine on hea praktika, mis aitab meenutada UTXO päritolu või kavandatud sihtkohta, hõlbustades seeläbi vahendite haldamist ja privaatsuse optimeerimist. Tõepoolest, teie Bitcoin'i rahakott tõenäoliselt turvab mitmeid UTXOs. Kui nende UTXOde allikad on erinevad, ei pruugi te tulevikus soovida neid UTXOsid ühendada, vastasel juhul võiksite paljastada nende ühise omandi. Kõigi oma müntide korrektse sildistamisega tagate, et mäletate nende päritolu, kui peate neid kasutama, isegi kui see on alles mitme aasta pärast.

### Mis on müntide kontroll?

Sildistamise aktiivne kasutamine muutub veelgi huvitavamaks, kui seda kombineerida teie rahakotitarkvaras oleva müntide kontrolli valikuga.

Müntide kontroll on heas Bitcoin'i rahakotitarkvaras olev funktsioon, mis annab teile võimaluse käsitsi valida konkreetseid UTXOsid, mida kasutada sisenditena tehingu sooritamiseks. Tõepoolest, väljundi makse rahuldamiseks on vajalik tarbida sisendina vastu UTXO. Mitmel põhjusel, mida me hiljem näeme, võite soovida täpselt valida, milliseid münte tarbida sisendites, et rahuldada teatud makse. Just seda võimaldab müntide kontroll teha. Analüüsiks, see funktsioon on sarnane tegevusele, kui valite oma rahakotist konkreetse mündi, kui maksate oma baguette eest.

![BTC204](assets/notext/42/01.webp)

Rahakotitarkvara kasutamine müntide kontrolliga, kombineerituna UTXOde sildistamisega, võimaldab kasutajatel nii eristada kui ka täpselt valida UTXOsid oma tehingute jaoks.

### Kuidas korrektselt sildistada oma UTXOs?

UTXOde sildistamiseks ei ole universaalset meetodit, mis sobiks kõigile. Teie ülesanne on määratleda sildistamissüsteem, et saaksite oma rahakotis kergesti orienteeruda. Igatahes pidage meeles, et hea sildistamine on selline, mida saate mõista, kui seda vajate. Kui teie Bitcoin'i rahakott on peamiselt mõeldud säästudeks, võib olla, et sildid on teile kasulikud alles mitme aastakümne pärast. Seetõttu veenduge, et need oleksid selged, täpsed ja kõikehõlmavad.

On oluline, et teie lähedased saaksid kergesti tuvastada vahendite päritolu, kui nad ühel päeval peavad teie rahakotile juurde pääsema. See võib neid aidata nii privaatsuse kui ka õiguslike vajaduste tõttu, juhul kui nad peaksid enne ametivõimu tõestama vahendite päritolu.
Sildistamise kõige olulisem aspekt on märkida UTXO allikas. Peaksite lihtsalt näitama, kuidas see münt teie rahakotti jõudis. Kas see on ost börsiplatvormilt? Makse kliendilt? Eakaaslastevaheline vahetus? Või on see vahetus ostult? Nii võiksite täpsustada:
- `Väljavõte Exchange.com`;
- `Makse Klient David`;
- `P2P Ost Charles`;
- `Vahetus diivanilt ostu puhul`

![BTC204](assets/en/42/02.webp)

UTXOde halduse täpsustamiseks ja oma rahakotis vahendite eraldamise strateegiate järgimiseks võiksite oma siltidele lisada täiendava indikaatori, mis peegeldab neid eraldusi. Kui teie rahakott sisaldab kahte UTXOde kategooriat, mida te ei soovi segada, võiksite oma siltidesse integreerida markeri, et need rühmad selgelt eristada. Need eraldusmarkerid sõltuvad teie enda kriteeriumidest, nagu eristamine UTXOde vahel, mis on seotud KYC protsessiga, või eristamine professionaalsete ja isiklike vahendite vahel. Varem mainitud sildi näidete põhjal võiks see tõlkuda kui:
- `KYC - Väljavõte Exchange.com`;
- `KYC - Makse Klient David`;
- `NO KYC - P2P Ost Charles`;
- `NO KYC - Vahetus diivanilt ostu puhul`

![BTC204](assets/en/42/03.webp)
Samuti on soovitatav jäädvustada mündi märgistus läbi kõikide tehingute. Näiteks, kui konsolideerite no-KYC UTXOsid, veenduge, et märgistate tulemuseks oleva UTXO mitte ainult kui `konsolideerimine`, vaid spetsiifiliselt kui `no-KYC konsolideerimine`, et säilitada selge jälje mündi päritolust.
Lõpuks ei ole vajalik sildile kuupäeva lisamine. Enamik rahakottide tarkvara kuvab juba tehingu kuupäeva ja selle teabe on alati võimalik ploki uurijas TXID abil taastada.

### Kuidas Õigesti Oma Münte Valida?

Tehingu tegemisel võimaldab mündikontroll teil spetsiifiliselt valida, milliseid UTXOsid kasutada sisenditena, et rahuldada makse väljundit. Selles valikus tuleks arvestada kahte aspekti:
- Võimalus, et makse saaja suudab seostada osa teie identiteedist kasutatud sisenditeks olevate UTXOdega;
- Võimalus, et väline vaatleja suudab luua seoseid kõigi sisenditena tarbitud UTXOde vahel.
Esimese punkti illustreerimiseks võtame konkreetse näite. Oletame, et ostate oma kohalikult pagarilt baguette bitcoine eest. Kasutate ühte või mitut endale kuuluvat UTXOt sisenditena, et vähemalt katta baguette hind väljundites, samuti tehingutasud. Teie pagar võib seejärel potentsiaalselt seostada teie näo või mõne muu teie identiteedi osa kasutatud müntidega sisenditena. Selle seose olemasolu teades võiksite makse tegemisel eelistada konkreetset UTXOt teisele.
![BTC204](assets/notext/42/04.webp)

Näiteks, kui üks teie UTXOdest pärineb vahetusplatvormilt ja eelistate, et pagar ei teaks teie kontost sellel platvormil, väldiksite selle UTXO kasutamist makseks. Kui teil on suure väärtusega UTXO, mis paljastab märkimisväärse hulga bitcoine, võiksite seda samuti mitte kasutada, et pagar ei saaks teada teie BTC varandusest.

Selle esimese punkti UTXOde valik põhineb seega isiklikul otsusel, mida mõjutab see, mida olete valmis avalikustama või mitte. Teie UTXOdele määratud sildid aitavad teil valimisel aidata neid, mis kulutamisel paljastavad ainult teavet, mida olete mugav saajale avalikustama.

Lisaks potentsiaalselt saajale avalikustatavale teabele mõjutab sisendite valik ka seda, mida avalikustate kõigile plokiahela vaatlejatele. Tõepoolest, kasutades mitut UTXOt sisenditena oma tehingus, paljastate, et need kuuluvad samale üksusele, vastavalt Common Input Ownership Heuristic (CIOH) põhimõttele.

![BTC204](assets/notext/42/05.webp)

Oma müntide valimisel peate seega olema teadlik, et teie poolt edastatav tehing loob lingi kõigi kasutatud UTXOde vahel. See link võib olla probleemne teie isikliku privaatsuse jaoks, eriti kui UTXOsid pärinevad erinevatest allikatest.

![BTC204](assets/notext/42/06.webp)

Tagasi minu no-KYC UTXO näite juurde Bisqist; ma tahan vältida selle kombineerimist UTXOga, ütleme, reguleeritud vahetusplatvormilt, mis teab minu identiteeti. Tõepoolest, kui ma kunagi kasutan neid kahte UTXOt sisenditena samas tehingus, suudab reguleeritud platvorm seostada minu identiteedi UTXOga, mille ostsin Bisqist, kuigi see ei olnud enne minu identiteediga seotud.

![BTC204](assets/notext/42/07.webp)
Lõpuks, et õigesti valida, milliseid UTXO-sid kasutada tehingu sisenditena, on kõige olulisem vältida mitme UTXO kasutamist. Võimalusel valige üksik münt, mis on piisavalt suur, et katta teie makse. Sedasi tehes väldite täielikult riske, mis on seotud COINJOINiga. Kui aga ükski individuaalne UTXO ei ole makse jaoks piisav ja peate tarbima mitu, veenduge, et need pärinevad sarnastest allikatest, et minimeerida soovimatute linkide riske. Samuti pidage meeles, et saaja võib teie kohta käiva teabe seostada kasutatud müntide ajalooga.

### Automaatse Mündi Valiku Mõistmine

Eelmistes jaotistes arutasime UTXO-de käsitsi valimist tehingu jaoks. Aga mis juhtub, kui rahakotitarkvara teeb selle valiku automaatselt? On olemas mitmeid meetodeid, mis määravad, milliseid münte tarbida, ja UTXO-de valik on Bitcoinis tõeline uurimisvaldkond. Selle automaatse protsessi peamine eesmärk on sageli kasutaja tehingutasude minimeerimine.

UTXO valikumeetodid nagu FIFO (*First In First Out*) ja LIFO (*Last In First Out*) on kõige lihtsamad, kuid ka kõige vähem efektiivsed. FIFO puhul kasutatakse rahakotis olevaid vanimaid münte esimesena. See lähenemine on üldiselt ebaefektiivne nii tehingutasude minimeerimiseks kui ka privaatsuse säilitamiseks, välja arvatud juhtudel, kui kasutatakse suhtelisi ajalukke ja neid tuleb regulaarselt uuendada. Vastupidi, LIFO prioritiseerib kõige hiljutisemate UTXO-de kasutamist. Kuigi lihtne, osutuvad need kaks meetodit sageli ebaefektiivseks.

Täpsem meetod on *Knapsack Solver*. See oli meetod, mida kasutati Bitcoin Core rahakotis kuni versioonini 0.17. See hõlmab UTXO-de iteratiivset ja juhuslikku valimist rahakotist, nende lisamist alamhulkadesse ja lahenduse hoidmist, mis vähendab tehingu kaalu nii palju kui võimalik, et vähendada kasutaja tasusid.
*Branch-and-Bound* (BNB), mida sageli nimetatakse "Murchi algoritmiks" viidates selle leiutajale, on asendanud *Knapsack Solveri* Bitcoin Core'is alates versioonist 0.17. See täpsem meetod eesmärgib leida UTXO-de komplekti, mis täpselt vastab tehingu väljundite rahuldamiseks vajalikule summale. BNB eesmärk on minimeerida nii vahetusraha kogust kui ka tasusid, vähendades nn raiskamiskriteeriumi, mis arvestab nii koheste kulude kui ka vahetusraha tulevaste kuludega. See meetod on tuletatud algsest *Branch-and-Bound* kontseptsioonist, mille kujundasid 1960. aastal Ailsa Land ja Alison Harcourt, ja pakub võrreldes *Knapsack Solveriga* täpsemat tasude optimeerimist.
Kõik need automaatsed UTXO valikumeetodid võivad olla tõhusad tehingutasude vähendamisel, kuid sageli on need ebaefektiivsed kasutaja privaatsuse säilitamisel. Tõepoolest, need algoritmid võivad ühendada mitu UTXO-d sisenditeks, paljastades seeläbi nende UTXO-de ühise omandi COH tõttu. Ilmselgelt ei saa need meetodid arvestada UTXO-dele kinnitatud silte, mis on teadliku valiku tegemiseks müntide avalikustamisel tehingu saajale üliolulised. Praegu on privaatsuse optimeerimise ainus lahendus müntide valimisel seda teha käsitsi.

### Õpetus UTXO-de Märgistamiseks

Kui soovite õppida, kuidas oma UTXO-sid märgistada, oleme loonud täieliku õpetuse peamise olemasoleva Bitcoin rahakotitarkvara kohta:

https://planb.network/tutorials/privacy/utxo-labelling


## KYC ja Võtme Identifitseerimine
<chapterId>cec6b9d9-0eed-4f85-bc4e-1e9aa59ca605</chapterId>
KYC tähistab "Know Your Customer" (Tunne oma klienti), mis on regulatiivne protseduur, mida rakendavad mõned Bitcoin sektoris tegutsevad ettevõtted. Selle protseduuri eesmärk on kontrollida ja registreerida oma klientide identiteeti eesmärgiga võidelda rahapesu ja terrorismi rahastamise vastu.
Konkreetselt hõlmab KYC erinevate isikuandmete kogumist kliendilt, mis võivad jurisdiktsiooniti erineda, kuid üldiselt sisaldavad isikut tõendavat dokumenti, fotot ja elukoha tõendit. Seejärel kontrollitakse neid andmeid ja hoitakse tuleviku tarbeks.

See protseduur on muutunud kohustuslikuks kõikidele reguleeritud vahetusplatvormidele enamikus Lääne riikides. See tähendab, et igaüks, kes soovib vahetada fiat valuutasid bitcoinide vastu nende platvormide kaudu, peab vastama KYC nõuetele.
See protseduur ei ole ilma riskideta kasutajate konfidentsiaalsusele ja turvalisusele. Selles peatükis uurime neid riske üksikasjalikult ja analüüsime KYC ja identifitseerimisprotsesside konkreetseid mõjusid Bitcoin kasutajate privaatsusele.
### Hõlbustades Onchain Jälgimist

Esimene risk, mis on seotud KYC-ga, on see, et see pakub privileegitud sisenemispunkti ahela analüüsiks. Nagu me eelmises osas nägime, saavad analüütikud grupeerida ja jälgida tegevusi blockchainis kasutades tehingumustreid ja heuristikat. Kui nad on suutnud klasterdada kasutaja onchain tegevuse, piisab nende privaatsuse täielikuks kompromiteerimiseks vaid ühe sisenemispunkti leidmisest kõigi nende tehingute ja võtmete hulgas.

![BTC204](assets/notext/43/1.webp)

Kui te läbite KYC, pakute väga kvaliteetset sisenemispunkti ahela analüüsiks, kuna te seote oma vastuvõtvad aadressid, mida kasutate bitcoine vahetusplatvormilt välja võttes, oma täieliku ja kontrollitud identiteediga. Teoorias on see teave teada ainult ettevõttele, kellele olete selle esitanud, kuid nagu me hiljem näeme, on andmelekkimise risk reaalne. Pealegi võib pelgalt asjaolu, et ettevõte seda teavet omab, olla probleemne, isegi kui ta seda ei jaga.

Seega, kui te ei võta muid meetmeid oma tegevuste grupeerimise piiramiseks blockchainis, võib igaüks, kes on teadlik sellest sisenemispunktist, mis on KYC, potentsiaalselt seostada kogu teie tegevuse Bitcoinis teie identiteediga. Selle ettevõtte vaatenurgast kaotab teie Bitcoin'i kasutamine seega kogu konfidentsiaalsuse.

![BTC204](assets/notext/43/2.webp)

Selle illustreerimiseks võrdlusega, see on nagu teie pankur *Pangast X* omaks juurdepääsu mitte ainult kõigile teie tehingutele, mida teete *Pangaga X*, vaid võiks samuti jälgida teie tehinguid *Pangaga Y* ja kõiki teie sularahatehinguid.

Nagu me esimeses osas õppisime: Bitcoin'i privaatsusmudel, nagu Satoshi Nakamoto kujundas, põhineb kasutaja identiteedi ja nende võtmepaaride eraldatusel. Kuigi see privaatsuskiht ei ole tänapäeval enam piisav, on siiski mõistlik piirata selle halvenemist nii palju kui võimalik.

### Riikliku Järelevalve Risk

Teine suur probleem KYC-ga on see, et see paljastab riigile, et olete mingil hetkel bitcoine omastanud. Kui ostate bitcoine reguleeritud tegijalt, muutub riigile teie omamise teadmine võimalikuks. Praegu võib see tunduda tühine, kuid on oluline meeles pidada, et teie riigi poliitiline ja majanduslik tulevik ei ole teie kätes.
Eelkõige võib riik kiiresti võtta autoritaarse hoiaku. Ajalugu on täis näiteid, kus poliitikad on järsult muutunud. Täna, Euroopas, võivad Bitcoin'i entusiastid kirjutada artikleid Bitcoin'ist, osaleda konverentsidel ja hallata oma rahakotte isehoidmisel. Kuid kes võib öelda, mis homme toob? Kui Bitcoin äkki muutuks avalikuks vaenlaseks number üks, võiks riiklike kirjetega seostamine osutuda probleemseks.
Järgmisena, tõsiste majanduskriiside korral, võib riik kaaluda kodanike poolt hoitavate bitcoinide konfiskeerimist. Võib-olla homme peetakse Bitcoin'i kasutajaid kriisi kasusaajateks ja neid maksustatakse liigselt nende kapitalikasvu tõttu fiat-valuuta devalveerimise tõttu.
Võite arvata, et see ei ole probleem, kuna teie bitcoinid on segatud ja seetõttu jälitamatud. Siiski, jälitamine ei ole siin probleem. Tegelik probleem on see, et riik teab, et olete bitcoine omama. See lihtne teave võib olla piisav, et teid süüdistada või nõuda aruannet. Võite üritada väita, et olete oma bitcoinid ära kulutanud, kuid see peaks kajastuma teie maksudeklaratsioonis ja teid tabaks vahelejäämine. Võite ka öelda, et kaotasite oma võtmed paadiõnnetuses, kuid Twitteris tehtud nalja taga, kas tõesti arvate, et see oleks piisav teie õigeksmõistmiseks?

Seetõttu on oluline arvestada riskiga, mis on seotud pelgalt asjaoluga, et riik võib teada, et olete BTC-d omama, isegi kui see risk võib täna tunduda kaugel.

Teine probleem, mida KYC esitab riikliku järelevalve osas, on reguleeritud platvormide kohustuslik raporteerimine. Kuigi ma ei ole teiste jurisdiktsioonide regulatsioonidega tuttav, on Prantsusmaal *Digitaalsete Varade Teenusepakkujad* (PSAN) kohustatud finantsjärelevalve asutustele teatama kõik kahtlased fondiliikumised, mida nad peavad kahtlaseks.

Seega teatasid Prantsusmaal 2023. aastal PSANid 1,449 kahtlasest tegevusest. Praegu on enamik neist tegevustest seotud kriminaliteediga. Siiski paluvad asutused reguleeritud platvormidel teatada ka kõikidest kahtlastest Bitcoin'i tehingutest, mis põhinevad üksnes nende struktuuril. Kui teete koostöö tehingu või isegi lihtsalt tehingu, mis esitab veidi ebatüüpilist mustrit, ja see tehing toimub lähedal teie bitcoinide väljavõtmisele nendelt platvormidelt, võite leida end ametivõimudele teatatuna. Isegi kui tegemist on õiguspärase õiguste kasutamisega ja süütegude puudumisel, võib see raporteerimine viia suurenenud kontrollide ja järelevalve, ebamugavusteni, mida oleksite vältinud ilma KYC-ta.

### Isikuandmete lekke risk
Teine probleem KYC-ga seisneb selles, et see nõuab kõigi teie isikuandmete hoidmist eraettevõtte serverites. Hiljutised sündmused on meile meelde tuletanud, et keegi ei ole immuunne rikete suhtes, olgu need siis finants- või IT-alased. 2022. aastal kannatasid Celsius'e kliendid tagajärgede all. Pärast ettevõtte pankrotti avalikustas Ameerika õigussüsteem administratiivmenetluse käigus võlausaldajate nimed ja nende varade summad.

Veidi rohkem kui kaks aastat tagasi koges juhtiv küberturvalisuse entiteet krüptoraha valdkonnas oma klientide isikuandmete vargust. Kuigi see intsident ei olnud otseselt seotud bitcoinide ostmisega, jääb selline risk ka vahetusplatvormide jaoks. Seega on nende isikuandmetega seotud kindel risk.

On tõsi, et me juba usaldame palju oma isikuandmeid eraettevõtetele. Siiski on siin risk kahekordne, kuna need andmed mitte ainult ei võimalda teid tuvastada, vaid on seotud ka tegevusega Bitcoin'is. Tõepoolest, kui häkker õnnestub pääseda ligi vahetusplatvormi klientide andmetele, võivad nad mõistlikult eeldada, et neil klientidel on bitcoine. See risk on seega suurendatud asjaoluga, et bitcoin, nagu iga teinegi väärtuslik vara, äratab varaste huvi.

Andmelekke korral parimal juhul võiksite olla sihitud püügikatsete sihtmärk. Halvimal juhul võiksite leida end füüsiliste ohtude keskmes oma kodus.
Lisaks Bitcoiniga seotud konkreetsetele riskidele on vajalik arvestada ka isikut tõendavate dokumentide edastamisega seotud ohtudega. Tõepoolest, andmeleke võib muuta isiku identiteedivarguse ohvriks. Seega ei piirdu panused ainult tehingute konfidentsiaalsuse kaitsmisega, vaid puudutavad ka iga üksikisiku isiklikku turvalisust.

### Levinud väärarusaamad KYC kohta

On oluline ümber lükata mõned KYC-ga (Know Your Customer ehk Tea Oma Klienti) seotud levinud väärarusaamad, mida tihti kohtab Twitteris või meie aruteludes bitcoinide kasutajate seas.
Esiteks ja kõige tähtsam, on vale arvata, et oma privaatsuse kaitsmine bitcoinide puhul, mis on omandatud KYC kaudu, on mõttetu. Bitcoinil privaatsuse tagamise vahendid ja meetodid on mitmekesised ning teenivad erinevaid eesmärke. Näiteks coinjoin tehingute kasutamine KYC kaudu saadud bitcoinidel ei ole halb mõte. Loomulikult on vajalik olla ettevaatlik reguleeritud vahetusplatvormidega, et vältida oma konto külmutamist või keelustamist, kuid rangelt tehnilisest vaatepunktist ei ole need praktikad omavahel vastuolus. Coinjoinil on mündi ajaloo katkestamise efekt, mis aitab vastu seista mõnedele KYC-ga seotud ahela analüüsi riskidele. Kuigi see ei kõrvalda kõiki riske, esindab see juba olulist eelist.

Bitcoinil privaatsust ei tohiks vaadelda binaarselt, kui vahet eristades "anonüümseid" bitcoine ja teisi, mis seda ei ole. KYC kaudu omandatud bitcoinide omamine ei tähenda, et kõik on kadunud; vastupidi, privaatsusvahendite kasutamine võib osutuda veelgi kasulikumaks.

Vastupidiselt, bitcoinide omandamine mitte-KYC meetodil ei taga täiuslikku privaatsust ega vabasta vajadusest võtta muid kaitsemeetmeid. Kui omate mitte-KYC bitcoine, kuid kasutate korduvalt samu vastuvõtvaadressi, võib teie tehinguid jälgida ja grupeerida. Vähimgi seos Bitcoinist välismaailmaga võib ohustada teie ainukest privaatsuse kihti. Seetõttu on oluline pidada kõiki Bitcoinil privaatsust parandavaid vahendeid ja meetodeid täiendavateks. Iga tehnika käsitleb konkreetset riski ja võib lisada täiendava kaitsekihi. Seega ei vabasta mitte-KYC bitcoinide omamine kedagi teiste ettevaatusabinõude võtmisest.

### Kas KYC saab tagasi võtta?

Mulle küsitakse mõnikord, kas on võimalik "tagasi minna" pärast KYC lõpetamist, ja nagu võite eelnevatest lõikudest ette kujutada, on vastus mitmetahuline. KYC-ga seotud riskide vältimiseks on kõige lihtsam meetod mitte kasutada seda bitcoinide omandamisel. Me süveneme sellesse teemasse järgmises peatükis. Kuid, kui KYC on juba tehtud ja bitcoinid on ostetud, kas on olemas viise kantud riskide leevendamiseks?

Teie tehingute jälgitavuse riski osas on coinjoin üks lahendus. Me arutame seda meetodit üksikasjalikumalt hiljem koolitusel, kuid olge teadlikud, et coinjoin võib murda mündi ajaloo ja takistada selle mineviku-oleviku ja oleviku-mineviku jälgimist. Isegi BTC puhul, mis on saadud reguleeritud platvormi kaudu, võib see tehnika takistada nende jälgitavust.
Siiski ei kõrvalda coinjoin teist KYC-ga seotud riski: asjaolu, et riik on teadlik teie bitcoinide olemasolust. Tõepoolest, isegi kui teie mündid pole enam jälgitavad, võib riik, sõltuvalt jurisdiktsioonist, omada juurdepääsu teie krüptovara võõrandamise deklaratsioonidele. Kuna see risk ei ole tehniline, vaid administratiivne, ei ole Bitcoini-spetsiifilisi lahendusi selle kõrvaldamiseks, välja arvatud KYC-st algusest peale hoidumine. Ainus seaduslik lähenemine selle riski leevendamiseks on müüa oma bitcoine, mis on omandatud reguleeritud platvormidel, reguleeritud platvormidel ja seejärel neid uuesti osta KYC-ta viisidel. Müües ja deklareerides võõrandamist, peaks administratsioon märkama, et te enam neid ei oma.

Mis puudutab teie isikuandmete ja identiteetdokumentide lekkimise riski, siis see on oht, mis on väljaspool Bitcoini, ja tehnilist lahendust selle vältimiseks ei ole. Kui teie andmed on avalikustatud, on seda operatsiooni raske tagasi pöörata. Võite proovida oma konto platvormil sulgeda, kuid see ei taga teie KYC-andmete kustutamist, eriti kui isikutuvastus on allhanke korras. Teie teabe täieliku kustutamise kontrollimine on võimatu. Seega ei ole lahendust, et täielikult vältida seda riski ja tagada, et see enam ei eksisteeri.

### Erinevus KYC ja võtme tuvastamise vahel

Mõnikord kipuvad mõned bitcoinide kasutajad terminit "KYC" laiendama igale BTC vahetusele, mis hõlmab ülekannet või krediitkaardimakset, kuna need vahendid võivad samuti paljastada makse päritolu, just nagu KYC seda teeks. Siiski on oluline mitte segi ajada KYC-d võtme tuvastamisega. Isiklikult pean tunnistama, et minu arusaam sellest teemast on aja jooksul arenenud.

KYC viitab spetsiifiliselt mõnede ettevõtete poolt rakendatavale regulatiivsele protseduurile, et kontrollida ja registreerida oma klientide identiteeti. See on binaarne asi: bitcoine omandades kas läbite KYC või ei läbi. Võtme tuvastamine, mis puudutab kasutaja identiteedi aspekti seostamist onchain tegevusega, ei ole aga nii binaarne, vaid pigem esindab kontiinumit. Tõepoolest, bitcoine omandades või võõrandades on see tuvastamine alati erineval määral võimalik.
Näiteks, kui ostate bitcoine reguleeritud platvormil Šveitsis, ei ole KYC (Know Your Customer) vajalik. Siiski võib olla teie võtmete tuvastamine, kuna ost sooritati teie pangakonto kaudu. Siin ilmnevad esimesed kaks KYC-ga seotud riski — onchain jälgimise hõlbustamine ja riikliku järelevalvega kokkupuude — võivad ilmneda ka mitte-KYC vahetuses. Kui Šveitsi üksus teatab kahtlastest tehingutest teie riigi ametivõimudele, võivad nad lihtsalt kontrollida ostuks kasutatud pangakontot, et avastada teie identiteet. Seega on ilma KYC-ta reguleeritud platvormidel ostmine võtme tuvastamise riskiskaalal üsna kõrge.

![BTC204](assets/notext/43/4.webp)

Siiski, reguleeritud platvormide vältimine ja P2P (Peer-to-Peer) omandamismeetodite valimine ei kõrvalda võtme tuvastamise riski täielikult, vaid vähendab seda lihtsalt. Kaaluge näiteks ostu Bisq-il või mõnel teisel P2P platvormil. Oma vastaspoolega arveldamiseks kasutate tõenäoliselt oma pangakontot. Kui ametivõimud küsitlevad inimest, kellega te kauplesite, ja küsivad teie nime, kohtame varem mainitud riske 1 ja 2. Need riskid on kindlasti palju väiksemad kui mitte-KYC ostul platvormil ja veelgi vähendatud kui KYC-ga ostul, kuid need on siiski olemas väiksemal määral.

![BTC204](assets/notext/43/5.webp)
Lõpuks, isegi kui ostate oma bitcoine füüsilise vahetuse teel sularaha eest, ei ole te täielikult anonüümne. Inimene, kellega te vahetasite, on näinud teie nägu, mis on osa teie identiteedist. Kuigi see näide on minimaalne, on siiski võimalus võtmetunnuse tuvastamiseks.
![BTC204](assets/notext/43/6.webp)

Kokkuvõttes, bitcoine vahetades teiste varade vastu, olgu see siis ost fiat-valuutas või müük reaalse kauba eest, on alati mingisugune võtmetunnuse tuvastamine. Valitud vahetuse meetodist sõltuvalt võib see tuvastamine varieeruda intensiivsuses. On oluline mitte segi ajada seda tuvastamist KYC-ga, mis on hästi määratletud regulatiivne protsess. Siiski on KYC ja tuvastamise spektri vahel seos, kuna KYC asub selle spektri ülemises otsas, kuna see süstemaatiliselt hõlbustab kasutaja võtmete tuvastamist võimude poolt.

## Müügi ja omandamise meetodid
<chapterId>756598af-95aa-4c77-ac48-243c7ad89530</chapterId>
Eelmist peatükki lugedes võite mõelda viisidele, kuidas osta või müüa bitcoine ilma, et peaks läbima isikutuvastusprotsessi, et vältida KYC-ga seotud riske. On mitmeid meetodeid vahetuste sooritamiseks.

### Sularaha P2P vahetused

Nagu oleme näinud, jääb privaatsuse seisukohast parimaks meetodiks P2P (peer-to-peer) vahetus sularahas. See meetod võimaldab minimeerida jälgede jätmist ja oluliselt vähendada võtmetunnuse tuvastamise võimalust, olgu te siis ostja või müüja.

![BTC204](assets/notext/44/01.webp)

Siiski, see praktika kannab endas riske isiklikule ohutusele. Peamine oht seisneb selles, et vahetuse ajal teab vastaspool, et teil on oluline summa, kas sularahas või bitcoinides. See teave võib meelitada ligi pahatahtlikke isikuid. Tavaliselt soovitatakse oma bitcoini omamist hoida diskreetsena. Seda nõuannet võiks rakendada ka sularaha puhul. Siiski, isikliku vahetuse ajal on vältimatu paljastada, et omate bitcoine, mis võib tekitada ahnust.

![BTC204](assets/notext/44/02.webp)

Selle riski piiramiseks soovitan eelistada sularahatehinguid usaldusväärsete isikutega, nagu pereliikmed või lähedased sõbrad. Alternatiivina võiksite kaaluda vahetuste tegemist [kohalikel Bitcoinide kokkusaamistel](https://btcmap.org/communities/map), pärast mitmekordset osalemist. See võimaldab teil teiste osalejatega paremini tuttavaks saada ja mitte olla füüsilise vahetuse ajal üksi. Siiski on oluline tunnistada, et sularaha P2P vahetus kannab endas isikliku ohutuse riske, mida ei esine ostude sooritamisel reguleeritud platvormi kaudu ja teie pangakontolt.

Lisaks, olenevalt teie elukohast, võib suurte summade kandmine ja hoidmine kaasa tuua riske, olgu see siis bitcoinide või sularaha puhul.

Sularahavahetus võib kaasa tuua ka õiguslikke riske politseikontrollide või muude olukordade ajal. Kuigi enamikus riikides ei ole piiranguid sellele, kui palju sularaha võite endaga kaasas kanda, võivad liiga suured summad tekitada kahtlusi. Seega olge ettevaatlik, eriti kui peate läbima pikki vahemaid, ja vältige liiga suurte tehingute korraga tegemist, et mitte pidada õigustama olulise summa omamist.
Lõpuks on veel üks P2P ostude puudus see, et hind on tihti kõrgem kui reguleeritud platvormidel täheldatud hind. Müüjad kehtestavad sageli juurdehindluse, mis jääb vahemikku 1% kuni mõnikord rohkem kui 10%. Selle hinnavahe põhjuseid on mitu. Esiteks on see P2P müüjate seas aja jooksul välja kujunenud tavaline praktika. Järgmisena on müüjatel tehingutasud, mis on seotud vahendite saatmisega ostjale. P2P müükides on varguse risk suurem võrreldes tehingutega platvormidel, mis õigustab võetud riski eest kompensatsiooni. Lõpuks võib lisatasu olla seotud nõudluse ja vahetuse kvaliteediga privaatsuse mõttes. Ostjana on privaatsuse saavutamisel oma hind, mis kajastub müüja rakendatud juurdehindluses. Mõned bitcoini kasutajad usuvad ka, et P2P kaudu ostetud BTC kõrgem hind peegeldab selle tõelist väärtust ning väidavad, et reguleeritud platvormidel madalamad hinnad on kompromiss isikuandmete privaatsuse osas.

### P2P vahetused sobitamisplatvormi kaudu

Isikliku turvalisuse mõttes vähem riskantne alternatiiv on teostada P2P vahetusi ainult internetis, kasutades elektroonilisi maksemeetodeid nagu PayPal, pangakanded või Revolut.

See lähenemine aitab vältida paljusid sularahatehingutega seotud riske. Siiski on suurem risk, et vastaspool ei täida oma kohustusi online-vahetuse ajal. Tõepoolest, füüsilisel vahetusel, kui annate müüjale raha, kes ei saada teile vastutasuks bitcoine, saate neid kohe vastutusele võtta, kuna nad on teie ees. Internetis seevastu on sageli võimatu leida inimest, kes teilt varastanud on.

Selle riski leevendamiseks on võimalik kasutada P2P vahetusteks spetsialiseerunud platvorme. Need platvormid kasutavad konfliktide lahendamise mehhanisme, et kaitsta kahjustatud kasutajaid. Üldiselt pakuvad nad deposiidisüsteemi, kus bitcoine hoitakse seni, kuni müüja kinnitab fiat-raha makse.

Isikliku turvalisuse mõttes on see ostumeetod oluliselt turvalisem kui füüsilised sularahavahetused. Siiski, nagu varem mainitud, jätab online P2P vahetus rohkem jälgi kui füüsiline vahetus, mis võib olla Bitcoinil privaatsuse seisukohast kahjulik. Kasutades online fiat-maksemeetodit nagu pank, paljastate rohkem informatsiooni, mis võiks hõlbustada võtmete tuvastamist.

Taaskord soovitan mitte teha suuri vahetusi ühe tehinguna nendel platvormidel. Tehingute jagamisega hajutate riske, mis on seotud võimaliku vargusega vastaspoole poolt.
Jällegi on üks P2P ostude puudustest see, et hind on sageli kõrgem kui reguleeritud platvormidel nähtav. Müüjad kehtestavad sageli juurdehindluse, mis ulatub 1%-st mõnikord rohkem kui 10%-ni. Selle hinnavahe põhjuseid on mitu. Esiteks on see P2P müüjate seas aja jooksul välja kujunenud tavaline praktika. Järgmisena on müüjatel tehingutasud, mis on seotud vahendite saatmisega ostjale. P2P müügis on varguse risk suurem võrreldes tehingutega platvormidel, mis õigustab võetud riski eest kompensatsiooni. Lõpuks võib lisatasu olla seotud nõudluse ja vahetuse kvaliteediga privaatsuse mõttes. Ostjana on privaatsuse kasvul hind, mis kajastub müüja rakendatud juurdehindluses. Mõned bitcoini kasutajad usuvad ka, et P2P ostetud BTC kõrgem hind peegeldab selle tõelist väärtust ja väidavad, et reguleeritud platvormidel madalamad hinnad on teie isikuandmete privaatsuse kompromissi tulemus.
![BTC204](assets/notext/44/03.webp)

Lahenduste osas olen isiklikult alati kasutanud [Bisq](https://bisq.network/) ja olen sellega väga rahul. Nende süsteem on hästi välja töötatud ja tundub usaldusväärne. Siiski on Bisq saadaval ainult PC-l ja selle liides võib algajatele olla liiga keeruline. Teine puudus on see, et Bisq toimib ainult onchain tehingutega, mis võivad Bitcoin'i kõrgete tehingutasude perioodidel muutuda kulukaks.

[-> Avasta meie õpetus Bisqi kohta.](https://planb.network/en/tutorials/exchange/bisq)

Lihtsama valikuna võite proovida [Peach](https://peachbitcoin.com/), mobiilirakendust, mis hõlbustab ostjate ja müüjate vahelist ühendust integreeritud vaidluste lahendamise süsteemiga. Protsess on intuitiivsem kui Bisqil.

[-> Avasta meie õpetus Peach'i kohta.](https://planb.network/en/tutorials/exchange/peach-wallet)
Teine võrgupõhine valik on [HodlHodl](https://hodlhodl.com/), hästi välja kujunenud platvorm, mis pakub head likviidsust, kuigi ma pole seda isiklikult testinud.
[-> Avasta meie õpetus HodlHodl'i kohta.](https://planb.network/en/tutorials/exchange/hodlhodl)

Lahenduste jaoks, mis põhinevad Lightning Network'il, võite proovida [RoboSats](https://learn.robosats.com/) ja [LNP2PBot](https://lnp2pbot.com/). RoboSats on kättesaadav veebisaidi kaudu ja on suhteliselt lihtne kasutada. LNP2PBot on ebatüüpilisem, kuna see toimib vahetussüsteemina Telegrami sõnumirakenduses.

[-> Avasta meie õpetus RoboSats'i kohta.](https://planb.network/en/tutorials/exchange/robosats)
[-> Avasta meie õpetus LNP2PBot'i kohta.](https://planb.network/en/tutorials/exchange/lnp2pbot)

![BTC204](assets/notext/44/08.webp)

### Reguleeritud Platvormid ilma KYC-ta

Sõltuvalt riigist, kus elate, võib teil olla juurdepääs reguleeritud platvormidele, mis ei nõua bitcoini ostmiseks või müümiseks KYC protseduuri. Šveitsis näiteks võite kasutada platvorme nagu [Relai](https://relai.app/) ja [MtPelerin](https://www.mtpelerin.com/).

[-> Avasta meie õpetus Relai kohta.](https://planb.network/en/tutorials/exchange/relai)
Nagu me eelmises peatükis nägime, säästab see tüüpi platvorm teid KYC protseduuridega seotud riskidest, kuid nad esitavad suurema riski võtmete identifitseerimise osas. Privaatsuse mõttes Bitcoinil pakuvad need platvormid seega paremat kaitset kui KYC-ga ostumeetodid, kuid nad ei ole nii huvitavad kui P2P vahetused.
Siiski, isikliku turvalisuse mõttes on nende platvormide kasutamine oluliselt vähem riskantne kui P2P vahetused. Samuti on need sageli lihtsamini kasutatavad kui platvormid, mis hõlbustavad P2P vahetusi.

### Sularahaautomaadid

Teine võimalus bitcoine osta või müüa ilma KYC-ta on krüptoraha sularahaautomaadid (ATM). Isiklikult ei ole mul kunagi olnud võimalust seda lahendust proovida, kuna minu riigis neid ei ole. Kuid sõltuvalt teie elukohast võib see meetod olla väga huvitav.

![BTC204](assets/notext/44/09.webp)
Sularahaautomaatide probleem on see, et mõnes riigis on need keelatud või teistes tugevalt reguleeritud. Kui sularahaautomaat nõuab isikutuvastusprotsessi, siis seisab see silmitsi samade riskidega, mis on omased reguleeritud KYC platvormidele. Kuid, kui sularahaautomaat lubab tehinguid ilma isikutuvastuseta väikeste summade puhul, siis võib selle kasutamine pakkuda privaatsuse taset, mis on võrreldav sularahal põhineva P2P vahetusega, vältides samal ajal enamikku selle tüüpi vahetusega seotud riske.
Sularahaautomaatide peamine puudus seisneb nende sageli kõrgetes vahetustasudes, mis ulatuvad mõnest protsendist mõnikord kuni 15%ni vahetatavast summast.

### Kinkekaardid

Lõpuks tahtsin ma tutvustada ka lahendust, mis sobib hästi neile, kes soovivad oma bitcoine igapäevaselt ostude tegemiseks kasutada, mitte neid fiat-valuutade vastu müüa.

Parim viis BTC kulutamiseks on ilmselgelt Bitcoin'i või Lightning Network'i kasutamine kaupade või teenuste ostmiseks. Siiski, paljudes riikides on bitcoin'i aktsepteerivate kaupmeeste arv piiratud. Praktiline alternatiiv on siis kinkekaartide kasutamine.

Mitmed KYC protseduuri mitte nõudvad platvormid pakuvad võimalust vahetada bitcoine kinkekaartide vastu, mida saab kasutada suurtes poodides. Nende platvormide hulgas leiame [CoinsBee](https://www.coinsbee.com/), [The Bitcoin Company](https://thebitcoincompany.com/), ja [Bitrefill](https://www.bitrefill.com/). Need platvormid hõlbustavad oluliselt teie bitcoinide igapäevast kasutamist, võimaldades teil pääseda ligi laiale toodete ja teenuste valikule ilma, et peaksite läbima konverteerimise fiat-valuutasse.

![BTC204](assets/notext/44/10.webp)

### Muud Omandamise Meetodid

Teiste meetodite hulgas, et omandada bitcoine samal ajal oma privaatsust kaitstes, on ilmselgelt kaevandamine. Satside kaevandamise alustamiseks ei ole vaja oma identiteeti avalikustada; peate lihtsalt leidma kehtiva töötõendi ja esitama selle võrku. Kui valite basseinikaevandamise, siis mõned basseinid nõuavad isikutuvastust, nagu KYC, samas kui teised mitte.

Teine meetod seisneb töötamises bitcoine vastu. See omandamise meetod võib olla huvitav, kuid nõutava identifitseerimise aste varieerub suuresti olenevalt asjaoludest.

*Selle peatüki kirjutamiseks kasutasin kursust [BTC205](https://planb.network/fr/courses/btc205), mille lõi [@pivi___](https://x.com/pivi___) PlanB võrgustikus (hetkel saadaval ainult prantsuse keeles).*

## Konsolideerimine, UTXO Haldamine ja CIOH
<chapterId>d0486c8f-332d-402b-ae2e-949416752b9c</chapterId>
Üks keerukamaid aspekte, mida oma isikliku hoiustamise rahakoti puhul hallata, on kahtlemata konsolideerimine. Kas peaksite konsolideerima? Mis on eesmärk? Millist UTXO suurust peaksite sihtima? Millised on privaatsusega seotud kompromissid? Seda kõike üritame selles jaotises uurida.

### Mis on konsolideerimine?

Bitcoin'i toimimine on sarnane oksjoniturule, kus tehingud, mis pakuvad parimaid tasusid, on kaevurite poolt eelistatud. Siiski on igal plokil maksimaalne kaal, mis piirab tehingute arvu, mida saab kaasata. Kuna plokk toodetakse keskmiselt iga 10 minuti järel, on iga ploki saadaolev ruum haruldane ressurss.

Kaevurid, kelle tegevus toob kaasa olulisi kulusid elektri, kapitali ja hoolduse osas, püüavad loomulikult maksimeerida oma kasumlikkust. Nad eelistavad tehinguid, mis pakuvad neile suurimat tasu suhtes nende kaaluga.

Tõepoolest, kõik Bitcoin'i tehingud ei kaalu sama. Need, millel on rohkem sisendeid ja väljundeid, kaaluvad rohkem. Näiteks kaaluge kahte tehingut:
- Tehing A sisaldab 1 sisendit ja 1 väljundit. See eraldab 1,994 satsi tasusid ja selle kaal on 141 vB;
- Tehing B, keerukam, 2 sisendi ja 2 väljundiga, eraldab 2,640 satsi tasusid kaaluga 220 vB.

![BTC204](assets/notext/45/01.webp)

Selles näites, kuigi tehing B pakub kokku suuremaid tasusid, eelistavad kaevurid tehingut A, kuna see pakub paremat suhet tasude ja kaalu vahel. Siin on iga tehingu arvutus, väljendatuna satsides virtuaalse baiti kohta (sat/vB):

```text
TXA: 1994 / 141 = 14 sats/vB

TXB: 2640 / 220 = 12 sats / vB
```

See tähendab, et iga kaaluühiku kohta pakub tehing A rohkem tasusid kui tehing B, kuigi viimane pakub suuremat tasu absoluutväärtuses.

![BTC204](assets/notext/45/02.webp)

Seetõttu on kasutaja jaoks alati huvitavam tarbida võimalikult vähe sisendeid oma tehingutes. Siiski on vajalik tarbida piisavalt suuri summasid, et suuta rahuldada väljundi makse. Oma rahakoti haldamisel peab seega olema piisavalt suuri UTXOsid.

Konsolideerimise põhimõte on just ära kasutada perioode, mil Bitcoin'i tasud on madalad, et ühendada oma väikesed UTXOd üheks suuremaks. Nii saab, kui Bitcoin'i tasud tõusevad, teha tehinguid minimaalse sisendite arvuga ja seega kulutada vähem absoluutseid tasusid. Eesmärk on planeerida kohustuslikud tehingud kõrgete tasude perioodidel.

![BTC204](assets/en/45/03.webp)
Lisaks tehingutasude kokkuhoiule aitab UTXOde konsolideerimine vältida "tolmu" teket. Tolm viitab UTXOdele, mille väärtus satsides on nii madal, et see ei kata vajalikke tehingutasusid nende kulutamiseks. See muudab need UTXOd majanduslikult ebaloogiliseks kasutamiseks, seni kuni tehingutasud püsivad kõrged. Oma UTXOde proaktiivse gruppeerimisega hoiad ära nende muutumise tolmuks, tagades, et kõik sinu vahendid jäävad kasutatavaks.

### Mis on teie UTXOde minimaalne suurus?

Mõnikord küsitakse minult, mis on soovitatav minimaalne väärtus UTXO jaoks. Kahjuks ei ole universaalset vastust, kuna see sõltub teie eelistustest ja turutingimustest tasude osas. Siiski on siin valem, mis aitab teil määrata teie vajadustele vastava lävendi:

$$
\frac {P \times F}T = M
$$

Kus:
- $P$ on tehingu kaal;
- $F$ tähistab maksimaalset tasumäära satoshi-des vbyte kohta (sats/vB), mida olete valmis katma;
- $T$ on protsent tehingutasust, mida olete valmis maksma suhtena UTXO koguväärtusesse;
- $M$ on iga UTXO jaoks nõutav miinimumsumma satoshi-des.

Eeldades, et plaanite katta tasud standardse SegWit tehingu eest, millel on 1 sisend ja 2 väljundit, kaaluga 141 vB. Kui olete valmis katma kuni 800 sats/vB, ja olete nõus kulutama kuni 12% UTXO väärtusest tasudele maksimaalselt, siis arvutus oleks:

$$
\frac{141 \times 800}{0.12} = 940\ 000
$$

Selles näites oleks mõistlik hoida oma rahakotis UTXO-de miinimumväärtusena 940 000 satsi.

### Konsolideerimine ja COIH

Üks enimkasutatavaid heuristikaid ahelaanalüüsis on COIH (*Common Input Ownership Heuristic*), mis võimaldab eeldada, et kõik Bitcoini tehingu sisendid kuuluvad samale isikule. Täpsemalt, konsolideerimise põhimõte on tarbida mitu UTXO-d sisenditena ja luua üksik UTXO väljundina. Seega võimaldab konsolideerimine COIH-i rakendamist.

![BTC204](assets/notext/45/04.webp)

Praktikas tähendab see, et väline vaatleja võib järeldada, et kõik konsolideeritud UTXO-d tõenäoliselt kuuluvad samale isikule ja et genereeritud üksik väljund kuulub samuti neile. See olukord võib ohustada teie privaatsust, linkides erinevad tehingute ajalood. Näiteks, öelgem, et ma konsolideerin 3 UTXO-d, mis on omandatud P2P kaudu, UTXO-ga, mis on saadud platvormi kaudu, mis nõuab KYC-d:
![BTC204](assets/notext/45/05.webp)

Seda tehes võib igaüks, kellel on juurdepääs vahetusplatvormi andmetele, sealhulgas potentsiaalselt valitsusasutused, tuvastada, et mul on teisi summasid BTC-s. Varem ei olnud need UTXO-d otseselt minu identiteediga seotud; nüüd on nad seda. Lisaks paljastab see kõigile allikatele, et mul on teatud summa bitcoine.

UTXO-de haldamisel tekib majanduslike kaalutluste, mis survestavad konsolideerimisele tasude vähendamiseks, ja heade privaatsustavade, mis soovitaksid teie UTXO-sid mitte kunagi ühendada, vahel konflikt. Seega sõltub majanduse ja privaatsuse vaheline valik iga kasutaja prioriteetidest.

Kui suudate vältida konsolideerimist, säilitades samal ajal märkimisväärse suurusega UTXO-sid, on see ideaalne. Selleks optimeerige oma omandamismeetodeid. Kui ostate oma bitcoine DCA-s, proovige oma ühekordseid oste võimalikult palju hajutada, et koondada väärtus väiksemasse arvu UTXO-sid. On lihtsam hallata ühekordset ostu 1000 euro eest iga 2 kuu tagant, kui osta 120 euro eest iga nädal. See vähendab genereeritud UTXO-de arvu ja lihtsustab teie rahakoti haldamist, säilitades samal ajal teie privaatsuse.

Kui leiate end vajadusest konsolideerida oma bitcoine, eelistage esmalt sama allika UTXO-de konsolideerimist. Näiteks 10 UTXO ühendamine ühelt platvormilt mõjutab teie privaatsust vähem kui 5 UTXO segamine platvormilt A 5 UTXO-ga platvormilt B. Kui konsolideerimine erinevatest allikatest on vältimatu, proovige neid eristada nende omaduste järgi. Näiteks grupeerige KYC kaudu omandatud UTXO-d ühes tehingus ja P2P kaudu saadud UTXO-d teises.
Igal juhul pidage meeles, et igasugune konsolideerimine viib paratamatult privaatsuse kaotuseni. Seetõttu hinnake hoolikalt selle toimingu vajalikkust ja potentsiaalseid mõjusid teie privaatsusele, arvestades riski.
## Teised head tavad
<chapterId>b5216965-7d13-4ea1-9b7c-e292966a487b</chapterId>

Uurime koos mõningaid teisi häid tavasid, mis aitavad teil optimeerida oma privaatsust Bitcoinis.

### Täisnode
Oma bitcoinide omamine isiklikus valduses on hea, kuid oma täisnode kasutamine on veelgi parem! Siin on põhjused, miks oma node omamine on krüptoraha täielikult suveräänseks kasutamiseks hädavajalik:
- **Tsensuurikindlus**: Teie tehinguid ei saa keegi blokeerida;
- **Sõltumatus kolmandatest osapooltest**: Te ei sõltu enam välistest teenustest blockchaini andmete kontrollimiseks;
- **Aktiivne osalemine**: Teil on võimalus seada oma valideerimisreeglid ja osaleda otseselt konsensusprotsessis;
- **Panus võrgustikku**: Node'i käitamisega aitate tugevdada ja levitada Bitcoin võrgustikku;
- **Tehniline haridus**: Täisnode haldamine on suurepärane viis süvendada oma tehnilisi teadmisi Bitcoinist.

Lisaks nendele eelistele parandab täisnode kasutamine ka teie privaatsust tehingute edastamisel. Kui teete tehingu, luuakse ja allkirjastatakse see esmalt teie rahakoti kaudu. Selle edastamiseks Bitcoin võrgustikule peab sellest teadma vähemalt üks node. Oma node kasutamisega kontrollite seda edastust otseselt, suurendades seeläbi oma privaatsust ja piirates andmelekkimise riske.

![BTC204](assets/notext/46/01.webp)

Kui teil pole oma Bitcoin node'i, peate kasutama kolmanda osapoole oma, näiteks seda, mida pakub teie rahakotitarkvara pakkuja. Lisaks tehingute edastamisele vajab teie rahakott juurdepääsu erinevatele andmetele, nagu ootel tehingud, teie aadressidega seotud saldod või teie tehingute kinnituste arv. Kogu selle info saamiseks on vaja pärida node'ilt.

![BTC204](assets/notext/46/02.webp)

Peamine risk, kui te ei kasuta oma Bitcoin node'i, on see, et kolmanda osapoole node'i operaator võib jälgida teie tegevusi blockchainis või isegi jagada seda teavet teiste üksustega. Selle riski piiramiseks on vahepealne lahendus kasutada rahakotitarkvara, mis võimaldab maskeerida teie ühendusi Tori kaudu. See võib vähendada teie andmete paljastumist. Siiski, optimaalne lahendus on omada oma Bitcoin node'i ja kasutada seda oma tehingute edastamiseks. Ilmselgelt peate tagama ka, et teie node'ist ei leki mingit teavet, kuid see on teine teema, mida uurime järgmistes jaotistes.
Lisaks ilmsele eelisele teie privaatsusele tagab oma täisnode omamine ka blockchaini andmete tõepärasuse, kaitseb tsensuuri eest ja võimaldab teil aktiivselt osaleda Bitcoin'i halduses. Oma node kasutamisega annate oma majandusliku kaalu valitud ahelale, mis on oluline kogukonna konfliktide ajal, näiteks Blocksize War ajal aastatel 2015 kuni 2017. Forki korral võib kolmanda osapoole node'i kasutamine viia teid toetama ahelat, mida te ei soovi eelistada, kuna node'i operaator teeb teie eest valiku.
Nagu mõista võite, on privaatsuse ja laiemalt individuaalse suveräänsuse huvides hädavajalik käitada ja kasutada oma täisnode'i!

### Analüütiliste Heuristikate Pettmine
Laiemalt võttes on oluline mõista meie eelmises osas arutatud heuristikaid, et neid paremini vältida või petta. Heade tavade omaksvõtt võib osutuda kasulikuks, isegi kui need pole hädavajalikud. Need pakuvad lisakaitsekihti, mis võib olla oluline hea privaatsuse säilitamisel Bitcoin'i kasutamisel.

Esimene nõuanne, mida võiksin anda, on sulanduda tihedaimasse rahvahulka. Bitcoin'is tähendab see kõige enam kasutatavate skriptimustrite kasutamist. Näiteks P2WSH skriptid, mida tihti kasutatakse SegWit V0 multisig konfiguratsioonide jaoks, on väga haruldased. Need ei võimalda teil peituda suures anonüümsuskomplektis. Sama kehtib vanade mudelite, nagu P2PKH või P2SH, kohta. Kuigi need on UTXO komplektis laialdaselt esindatud, kasutatakse neid uute tehingute jaoks üha vähem.

Üldiselt on turvalisem pöörduda kõige uuema skriptistandardi poole, eeldusel, et see on piisavalt omaks võetud. Seega, kui 2022. aastal oleksin ma soovitanud vältida P2TR (Taproot) kasutamist selle madala omaksvõtu tõttu, siis 2024. aastal soovitaksin ma valida selle tüüpi skripti või kui see pole võimalik, siis SegWit V0 skripti, kuna P2TR-i kasutavate tehingute arv hakkab esindama väga olulist osa.

![BTC204](assets/notext/46/03.webp)

Allikas: [txstats.com](https://txstats.com/d/000000054/utxo-set-repartition-by-output-type)
Teine nipp oma privaatsuse säilitamiseks on proovida vältida tehingute sisemisi heuristikaid. Näiteks makse sooritamisel võiksite vältida ümara summa loomist väljundis, kuna see võib viidata, et teine väljund esindab vahetusraha. Kui peate sõbrale saatma 100k satsi, kaaluge veidi suurema summa ülekandmist, et vältida seda heuristikat. Samuti proovige mitte luua vahetusväljundeid, mis on makstud summa suhtes ebaproportsionaalselt suured, kuna see võib samuti paljastada, milline väljunditest esindab vahetusraha.
![BTC204](assets/notext/46/04.webp)

Lõpuks, kui teete Bitcoin'i tehinguid regulaarselt, veenduge, et te ei edastaks neid alati samadel aegadel. Tehingute edastamise hajutamine päeva ja nädala jooksul aitab vältida väliste vaatlejate võimet tuvastada ajalise mustri põhjal ajavööndit, mis võiks nende analüüsi parandada.

Kõigi nende igapäevaste heade tavade kõrval on olemas veelgi tõhusamaid meetodeid, et täielikult murda teie bitcoinide jälgitavus. Nende hulgas on ilmselgelt coinjoin tehingud, mida me uurime järgmises osas põhjalikumalt.

# Coinjoin Tehingute Mõistmine
<partId>6d0bbf16-3714-4db1-9897-2d45019f6bdc</partId>

## Mis on Coinjoin Tehing?
<chapterId>0862bc6b-1c48-4aa4-b76d-4f547b469008</chapterId>

Pärast privaatsuskaitse aluste uurimist arutame nüüd keerukamaid tehnikaid, mis on suunatud aktiivselt teie privaatsuse kaitsmisele, eriti teie bitcoinide ajaloo lahus hoidmisele. Järgmises osas uurime paljusid väikseid tehnikaid, kuid esmalt tahan teile rääkida coinjoinist.

Coinjoini peetakse sageli kõige tõhusamaks meetodiks Bitcoin'i kasutajate privaatsuse kaitsmiseks. Kuid mis täpselt on coinjoin tehing? Vaatame seda koos.

### Coinjoini Põhiprintsiibid

Coinjoin on tehnika, mis murdab bitcoinide jälgitavuse blockchainis. See põhineb spetsiifilise sama nimega struktuuriga koostöötehingul: coinjoin tehing.
Nagu oleme näinud selle koolituse esimestes osades, on Bitcoin'i tehingud kõigile kasutajatele nende sõlme kaudu teada. Seega on lihtne kontrollida iga mündi elektroonilise allkirja ahelat ja jälgida selle ajalugu. See tähendab, et kõik kasutajad saavad üritada analüüsida teiste kasutajate tehinguid. Selle tulemusena on tehingutasandil anonüümsus võimatu. Siiski säilitatakse anonüümsus isiku tuvastamise tasandil. Erinevalt traditsioonilisest pangandussüsteemist, kus iga konto on seotud isikliku identiteediga, on Bitcoin'is vahendid seotud krüptograafiliste võtmepaaridega (või skriptidega), pakkudes seeläbi kasutajatele pseudonüümsust krüptograafiliste identifikaatorite taga.

Seega on Bitcoin'i konfidentsiaalsus kompromiteeritud, kui välised vaatlejad suudavad seostada kindlad UTXO-d tuvastatud kasutajatega. Kui see seos on loodud, muutub võimalikuks nende tehingute jälgimine ja nende bitcoinide ajaloo analüüsimine. Coinjoin on just nimelt tehnika, mis on välja töötatud UTXO-de jälgitavuse katkestamiseks, et pakkuda Bitcoin'i kasutajatele teatud konfidentsiaalsuse kihti tehingutasandil.

Coinjoinid suurendavad Bitcoin'i kasutajate konfidentsiaalsust, muutes välisvaatlejate jaoks ahela analüüsi keerulisemaks. Nende struktuur võimaldab ühendada mitme erineva kasutaja mündid üheks tehinguks, hägustades jälgi ja muutes sisend- ja väljundiaadresside vaheliste seoste kindlakstegemise keeruliseks.

On oluline mõista, et coinjoin tehingu eesmärk on katkestada mündi ajalugu. See tehnika ei anna püsivat anonüümsust ega blokeeri bitcoinide jälgimist lõplikult, vastupidiselt sellele, mida võiks arvata. Coinjoini eesmärk on ainult katkestada ajalugu punktis, kus coinjoin tehing toimub. Siiski, enne ja pärast seda toimingut, on münt samade privaatsusriskide all.

### Kuidas coinjoinid töötavad?

Coinjoini põhimõte tugineb koostööl: mitu kasutajat, kes soovivad oma bitcoine segada, panevad samasse tehingusse sisenditena samaväärsed summad. Need summad jaotatakse seejärel väljunditena võrdsetes väärtustes igale kasutajale.

Tehingu lõppedes muutub võimatuks seostada kindlat väljundit sisendis teadaoleva kasutajaga. Sisendite ja väljundite vahel puudub otsene seos, mis katkestab seose kasutajate ja nende UTXO-de vahel, samuti iga mündi ajaloo.

Võtame näiteks Alice'i. Ta soovib saata umbes 100 000 satsi oma õele Eve'ile sünnipäevaks. Siiski ei soovi Alice, et Eve saaks jälgida tema tehingute ajalugu, kuna ta ei soovi avalikustada, kui palju bitcoine tal on või kuidas ta neid sai. Selleks otsustab Alice katkestada oma UTXO ajaloo coinjoin tehinguga. Ta korraldab Bobi, Charlesi, Davidi ja Frankiga koostööd, et teha ühine tehing:
- Alice, Bob, Charles, David ja Frank igaüks panustavad tehingusse sisenditena 105 000 satsi (5000 satsi kaevandamistasude jaoks):

- Vastutasuks nende sisendite tarbimise eest genereerib igaüks värske aadressi, et luua viis identset väljundit 100 000 satsi igaühele. Igaüks saab väljundi:

- Alice lõpetab 100 000 satsi suuruse UTXO-ga, mille ajalugu on segatud. Ta kasutab seda UTXO-d uues tehingus, et saata summa Eve'ile sünnipäevaks:
- Kui Eve üritab seda tehingut analüüsida, et informatsiooni kätte saada, seisab ta silmitsi coinjoin tehinguga, milles osalevad Alice, Bob, Charles, David ja Frank. Kuna ta ei suuda eristada, milline sisend kuulub kellele, tänu summade ühtsusele, ei saa Eve jälgida Alice'i UTXO ajalugu ega määrata, kui palju bitcoine tema õde omab või kuidas ta need sai:

- Selles stsenaariumis kasutas Alice coinjoin tehnikat, et suurendada oma privaatsust tagasiulatuva analüüsi vastu. Tõepoolest, Alice kaitseb end võimaliku Eve'i analüüsi eest, mis algaks konkreetsest tehingust, et jälgida UTXO ajalugu tagurpidi. See kaitse analüüsi eest olevikust minevikku on see, mida me nimetame tagasiulatuva anonüümsuse komplektiks. Me süveneme sellesse kontseptsiooni üksikasjalikumalt selle osa viimastes peatükkides.

Siiski pakub coinjoin ka võimalust suurendada privaatsust analüüsi vastu minevikust olevikku, mida nimetatakse etteulatuva anonüümsuse komplektiks. Vaatame tagasi meie näitele, kus Alice saatis Eve'ile tema sünnipäevaks 98 000 satsi, kuid pöörates rollid ümber. Kujutage nüüd ette, et Eve on mures oma privaatsuse pärast. Tõepoolest, Alice võib olla kiusatus jälgida mündi, mille ta saatis Eve'ile, et koguda informatsiooni. Eve võib konsolideerida selle UTXO, mille ta just sai, kõigi oma teiste UTXO-dega, mis võiks Alice'ile paljastada bitcoine, mida ta oma rahakotis hoiab. Selle vältimiseks võib Eve samuti katkestada just saadud mündi ajaloo.
- Eve, Grace, Mallory, Oscar ja Victor panevad igaüks sisse 98 000 satsi UTXO Bitcoin tehingusse:
- Vastutasuks nende sisendite tarbimise eest pakub igaüks värske aadressi, et luua 5 väljundit, igaüks 97 500 satsi, täiesti võrdsed. Iga kasutaja saab ühe väljundi:

- Eve omab nüüd 97 500 satsi UTXO-d, millel on katkenud ajalugu. Ta saab seda kasutada tulevastes tehingutes kartmatult. Tõepoolest, kui Alice üritab jälgida bitcoine, mille ta saatis Eve'ile, kohtab ta coinjoin tehingut. Ta ei suuda kindlaks teha, milline väljundi UTXO kuulub Eve'ile. Analüüs muutub siis võimatuks:

Esimeses näites nägime, kuidas coinjoin võib kaitsta mündi privaatsust seoses selle minevikuga, ja teises näites, kuidas see võib samuti turvata mündi ajalugu seoses selle tulevikuga. Seepärast mainisin, et coinjoin'i tuleks vaadelda kui ühekordset sündmust, mis jaotab mündi ajaloo mõlemas suunas:

### Segamine, coinjoins, segistid... Mis vahe on?

Terminit "segamine" kasutatakse mõnikord coinjoinide kirjeldamiseks, termin, mida mõned bitcoinikasutajad lükkavad tagasi, kuna nad kardavad segadust hoiustajate segistitega. Siiski arvan, et see kartus on alusetu, sest matemaatilises kontekstis kehastab coinjoin segamise kontseptsiooni täpselt.
Matemaatika üldvaldkonnas viitab segamine dünaamilise süsteemi omadusele, kus pärast teatud aega võivad kõik algse ruumi osad teoreetiliselt seguneda mis tahes muu osaga. Segamine tähendab, et osakese asukoht või süsteemi seisund areneb selliselt, et selle tulevane jaotus on sõltumatu algsest jaotusest, saavutades seeläbi seisundi, kus algseisundi omadused on ühtlaselt jaotunud kogu süsteemi ruumis. Just see juhtub bitcoinidega coinjoin'i puhul. Seega minu arvates on coinjoin tõepoolest müntide segamise meetod.
![BTC204](assets/notext/51/12.webp)

Siiski on oluline eristada coinjoin'i segajatest. Segaja on teenus, kuhu kasutajad saadavad oma bitcoinid segamiseks. Need teenused olid 2010. aastatel populaarsed, kuid nende kasutamine on vähenenud kahe peamise puuduse tõttu võrreldes coinjoin'iga:
- Need nõuavad kasutajalt segamisprotsessi ajal oma vahendite üleandmist, mis seab nad varguse ohule;
- Pole garantiid, et segaja ei salvesta tehingute üksikasju või isegi ei müü seda teavet ahela analüüsi ettevõtetele.
![BTC204](assets/notext/51/13.webp)

Tänapäeval eelistavad kasutajad seetõttu coinjoin'i, kuna see võimaldab neil kogu protsessi vältel oma vahendite üle täielikku kontrolli hoida. Coinjoin'is osalejad ei riski, et teised osapooled varastavad nende bitcoine. Uurime koos, kuidas kõik see on järgmises peatükis võimalik.

## Zerolink ja Chaumiani Coinjoin'id
<chapterId>326c9654-b359-4906-b23d-d6518dd5dc3e</chapterId>

Coinjoin'i pakutav privaatsus võidetakse grupi suuruse arvelt, milles meie tükk on peidetud. Seetõttu on vajalik leida võimalikult palju osalejaid. Coinjoin'i on täiesti võimalik teostada käsitsi, leides kasutajad ise, kuid see meetod on keeruline ja ei võimalda saavutada suuri anonüümsete osalejate hulki.

Seepärast on Bitcoinil välja arenenud coinjoin'i koordinaatorid. Nende roll on ühendada erinevaid kasutajaid ja edastada teavet, mis on vajalik koostööl põhineva tehingu edukaks lõpuleviimiseks.

![BTC204](assets/notext/52/01.webp)

Kuidas aga tagada, et koordinaatoril ei ole kunagi kontrolli kasutajate bitcoinide üle ja hoolimata asjaolust, et nad on isik, kes koostab coinjoin tehingu, kuidas me saame tagada, et nad ei suuda seostada kasutajate sisendeid ja väljundeid, mis võiks kujutada endast privaatsuse leket?

### Chaumi Pimedad Allkirjad

Kaasaegsed coinjoin'i rakendused kasutavad David Chaumi pimedaid allkirju, et vältida teabe lekkimist. Vaatame kiiresti koos, kuidas need pimedad allkirjad töötavad.

Chaumi pimedad allkirjad on digitaalse allkirja vorm, kus allkirja andja ei tea sõnumi sisu, millele nad allkirja annavad. Siiski saab hiljem allkirja originaalsõnumiga kontrollida. Selle tehnika töötas välja krüptograaf David Chaum 1983. aastal.

![BTC204](assets/notext/52/02.webp)

Võtame näiteks ettevõtte, kes soovib autentida konfidentsiaalset dokumenti, näiteks lepingut, ilma selle sisu avaldamata. Ettevõte rakendab maskeerimisprotsessi, mis krüptograafiliselt muudab algdokumendi pöörduvalt. See muudetud dokument saadetakse sertifitseerimisasutusele, kes rakendab pimedat allkirja, teadmata aluseks olevat sisu. Pärast allkirjastatud dokumendi kättesaamist eemaldab ettevõte allkirja maski. Tulemuseks on algdokument, mille on autentinud asutuse allkiri, ilma et asutus oleks kunagi näinud algset sisu.
Chaumi pimedad allkirjad võimaldavad seega tõendada dokumendi autentsust ilma selle sisu teadmata, mis tagab nii kasutaja andmete konfidentsiaalsuse kui ka allkirjastatud dokumendi terviklikkuse.

### Chaumi Coinjoinid
"Chaumi CoinJoinides" ühendatakse Tori kasutamine ja David Chaumi pimedad allkirjad, et tagada koordinaatorile teadmatus, milline väljund kuulub millisele kasutajale. Coinjoin tehingu koostamise protsess keerleb kolme peamise sammu ümber: sisendite registreerimine, väljundite registreerimine ja tehingu allkirjastamine. Vaatleme seda protsessi Alice'i näitel, kes on üks coinjoini osalejatest. Kõik teised osalejad järgivad samu samme nagu Alice, igaüks omaette.

**1. samm: Sisendite registreerimine.**
- Alice saadab koordinaatorile UTXO, mida ta soovib kasutada tehingu sisendina, samuti maskeeritud vastuvõtu aadressi, mida ta soovib kasutada väljundina, et saada oma bitcoine. Seega ei saa koordinaator teada Alice'i aadressi. Ta näeb ainult selle maskeeritud versiooni:

![BTC204](assets/notext/52/03.webp)

- Koordinaator kontrollib sisendite kehtivust, seejärel allkirjastab Alice'i maskeeritud aadressi oma privaatvõtmega. Ta saadab Alice'ile tagasi pimeda allkirja:

![BTC204](assets/notext/52/04.webp)

**2. samm: Väljundite registreerimine.**
- Alice saab nüüd koordinaatori privaatvõtmega allkirjastatud aadressi paljastada. Ta loob uue ühenduse erineva Tori identiteedi all. Koordinaator ei saa tuvastada, et see on Alice, kes selle uue identiteedi all ühendub:

![BTC204](assets/notext/52/05.webp)

- Alice saadab paljastatud aadressi ja allkirja koordinaatorile (kes ikka veel ei tea, et see on Alice):

![BTC204](assets/notext/52/06.webp)

**3. samm: Tehingu allkirjastamine.**
- Koordinaator kogub samamoodi kõikide osalejate paljastatud väljundid. Tänu kaasasolevatele allkirjadele saab ta kontrollida, et iga anonüümselt esitatud väljund oli tõepoolest varem tema privaatvõtmega allkirjastatud, tagades nende legitiimsuse. Seejärel on ta valmis coinjoin tehingu koostama ja saadab selle osalejatele, et nad saaksid selle allkirjastada:

![BTC204](assets/notext/52/07.webp)

- Alice, nagu ka teised osalejad, kontrollib, et tema sisend ja väljund on koordinaatori koostatud tehingus õigesti kaasatud. Kui kõik on rahuldav, saadab ta koordinaatorile allkirja, mis avab tema sisendi skripti:

![BTC204](assets/notext/52/08.webp)

- Pärast kõikide coinjoini osalejate allkirjade kogumist saab koordinaator tehingu Bitcoin võrgus levitada, nii et see saab lisatud plokki.
Sel süsteemil ei ole koordinaatoril võimalik seostada sisendit kindla väljundiga. Lisaks ei saa nad osalejate vahendeid omastada, kuna neil ei ole kunagi juurdepääsu privaatvõtmetele, mis on vajalikud nende UTXO-de avamiseks. Protsessi jooksul ja kuni 3. sammu lõpuni ei ole neil samuti juurdepääsu allkirjadele. Kui Alice ja teised osalejad allkirjastavad ülemaailmse tehingu, pärast veendumist, et kõik on korrektne, ei saa koordinaator seda tehingut, sealhulgas väljundeid, enam muuta ilma seda tühistamata. See takistab seega bitcoini vargust koordinaatori poolt.
Lõppkokkuvõttes, kui nad oma tehingu väljundit salvestavad, soovivad coinjoin'i kasutajad garantiisid, mis on sarnased valimistel hääletava kodaniku omadega. Nende tegevuste avaliku ja privaatse aspekti vahel on duaalsus. Ühelt poolt on see, mida soovitakse privaatsena hoida: hääletaja ei soovi, et tema hääletussedel oleks seotud tema identiteediga; coinjoin'i kasutaja ei soovi, et nende väljund oleks seotud nende sisendiga. Tõepoolest, kui koordinaator või mõni teine osapool suudab luua sisendi ja väljundi vahel seose, kaotab coinjoin kogu oma eesmärgi. Nagu varem selgitatud, peab coinjoin toimima mündi ajaloo katkestusena. See peatus toimub just seetõttu, et on võimatu seostada kindlat sisendit kindla väljundiga coinjoin tehingus (tuleviku anonset) ja vastupidi (tagasivaate anonset).

Teiselt poolt on avalik aspekt: hääletaja soovib tagada, et tema hääletussedel on lisatud hääletuskasti; sarnaselt soovib coinjoin'i kasutaja tagada, et nende väljund on lisatud coinjoin tehingusse. Tõepoolest, on absoluutselt vajalik, et coinjoin'is osalejad saaksid enne tehingu allkirjastamist kontrollida oma väljundi olemasolu, vastasel juhul võiks koordinaator vahendid varastada.

Just need 2 avalikku ja privaatset aspekti, mille võimaldab David Chaumi pime allkirjade kasutamine, tagavad Chaumiani coinjoin'ides osalejatele, et nende bitcoine ei varastata ja et nende vahendeid ei saa jälitada.

### Kes leiutas coinjoin'i kontseptsiooni?

On raske kindlalt öelda, kes esimesena tutvustas coinjoin'i ideed Bitcoinis ja kes tuli välja ideega kasutada selles kontekstis David Chaumi pime allkirju. Sageli arvatakse, et sellest rääkis esimesena Gregory Maxwell [sõnumis BitcoinTalkis 2013. aastal](https://bitcointalk.org/index.php?topic=279249.0):
Kasutades Chaumi pime allkirju: Kasutajad logivad sisse ja esitavad sisendid (ja muudatusaadressid) ning krüptograafiliselt pimendatud versiooni aadressist, kuhu nad soovivad oma privaatseid münte saata; server allkirjastab tokenid ja tagastab need kasutajatele. Kasutajad ühenduvad anonüümselt uuesti, paljastavad oma väljundi aadressid ja saadavad need tagasi serverile. Server näeb, et kõik väljundid on selle poolt allkirjastatud ja et seetõttu pärinevad kõik väljundid kehtivatelt osalejatelt. Hiljem ühenduvad inimesed uuesti ja allkirjastavad.
Maxwell, G. (2013, 22. august). *CoinJoin: Bitcoin privacy for the real world*. BitcoinTalki foorum. https://bitcointalk.org/index.php?topic=279249.0

![BTC204](assets/notext/52/09.webp)

Siiski on varasemaid mainimisi, nii Chaumi allkirjade kohta segamise kontekstis kui ka coinjoin'ide kohta. [Juunis 2011 esitles Duncan Townsend BitcoinTalkis](https://bitcointalk.org/index.php?topic=12751.0) mikserit, mis kasutab Chaumi allkirju viisil, mis on üsna sarnane kaasaegsete Chaumiani coinjoin'idega.
Samas teemas on [sõnum hashcoinilt vastuseks Duncan Townsendile](https://bitcointalk.org/index.php?topic=12751.msg315793#msg315793), et parandada tema mikserit. Selles sõnumis kirjeldatud protsess esindab täpselt seda, mis kõige rohkem sarnaneb coinjoinidele. Samuti mainitakse sarnast süsteemi [sõnumis Alex Mizrahilt aastal 2012](https://gist.github.com/killerstorm/6f843e1d3ffc38191aebca67d483bd88#file-laundry), kui ta nõustas Tenebrixi loojaid, üht esimestest altcoinidest, mis hiljem oli Litecoin'i loomise aluseks. Isegi termin "coinjoin" ei leiutatud Greg Maxwelli poolt, vaid see tuli Peter Toddi ideest.
![BTC204](assets/notext/52/10.webp)

### Zerolink

Zerolink on kõikehõlmav miksimisprotokoll, mis integreerib Chaumiani coinjoine ja mitmesuguseid strateegiaid kasutajate anonüümsuse kaitsmiseks mitme ahelaanalüüsi vormi vastu, eriti vähendades vigu, mis on seotud rahakoti haldamisega. Selle protokolli [tutvustasid nopara73 ja TDevD 2017. aastal](https://github.com/nopara73/ZeroLink/blob/master/README.md).

![BTC204](assets/notext/52/11.webp)

Nagu nimigi viitab, on Zerolinki põhimõte teostada coinjoin tehinguid, mis tagavad sisendite ja väljundite vaheliste linkide jälgimise võimatuse. See omadus saavutatakse tagades, et kõik väljundid esitavad täpselt identseid summasid.

![BTC204](assets/notext/52/12.webp)
Oluline ennetav meede Zerolinki poolt hõlmab segamata UTXOde täielikku eraldamist segatud UTXOdest, kasutades erinevaid krüptograafiliste võtmete komplekte või isegi eraldi rahakotte. Nii eristatakse "pre-mix" rahakotti, mis on mõeldud müntidele enne segamist, "post-mix" rahakotist, mis on reserveeritud segatud müntidele.
![BTC204](assets/notext/52/13.webp)

See range UTXOde eraldamine teenib peamiselt juhuslike seoste vältimist segatud UTXO ja segamata UTXO vahel. Tõepoolest, kui sellised lingid tekivad, nullitakse segatud UTXO peal coinjoini efektiivsus ilma, et kasutaja oleks teadlik, seega kompromiteerides UTXO konfidentsiaalsust, mille ajalugu nad uskusid olevat katkenud. Need lingid võivad tekkida kas aadressi taaskasutamisel segatud UTXO kindlustamisel segamata UTXOga või rakendades Common-Input-Ownership Heuristic (CIOH), kui kasutaja tarbib sama tehingu sisenditena segatud ja segamata UTXOsid. Pre-miksimise ja post-miksimise rahakottide eraldamine väldib neid juhuslikke seoseid ja kaitseb kasutajat tahtmatute vigade eest.

![BTC204](assets/notext/52/14.webp)

See eraldamine pakub ka võimalust rakendada erinevaid reegleid pre-miksimise ja post-miksimise rahakottide vahel rahakottide tarkvara tasandil. Näiteks post-mix rahakotis võib tarkvara keelata UTXOde ühendamise sisenditeks, et vältida CIOH rakendamist, mis kompromiteeriks kasutaja anonseti. Samuti on võimalik standardiseerida skriptide ja tehinguvõimaluste kasutamist (näiteks RBF-i märkimine), et vältida tuvastamist rahakoti sõrmejälgede järgi.

Praegu on Whirlpool ainus coinjoini rakendus, mis rangelt järgib Zerolinki protokolli. Järgmises peatükis uurime erinevaid olemasolevaid coinjoini rakendusi ja igaühe eeliseid ning puudusi.

## Coinjoini Rakendused
<chapterId>e37ed073-9498-4e4f-820b-30951e829596</chapterId>
*2024. aastal oleme tunnistajaks olulistele muutustele tööriistades, mis on saadaval kasutajatele, kes soovivad teostada coinjoine Bitcoinil. Hetkel oleme pöördelisel perioodil ja coinjoini turg läbib suuri ümberkorraldusi. Seetõttu võidakse seda peatükki aja jooksul uuendada.*

Praegu on Bitcoinil peamiselt 3 erinevat coinjoini rakendust:
- Whirlpool;
- Wabisabi;
- JoinMarket.
Iga nende rakendus püüab murda UTXO-de ajalugu läbi coinjoin tehingute. Siiski, nende mehhanismid erinevad oluliselt. Seetõttu on oluline mõista, kuidas igaüks töötab, et valida enda vajadustele kõige sobivam variant.

### JoinMarket

JoinMarket, mille lõid 2015. aastal Adam Gibson ja Chris Belcher, eristub teistest coinjoini rakendustest tänu oma unikaalsele kasutajate vahendamise mudelile. See süsteem põhineb P2P vahetusturul, kus mõned kasutajad, "makers", teevad oma bitcoine segamiseks kättesaadavaks, samal ajal kui teised, "takers", kasutavad neid vahendeid coinjoinide teostamiseks tasu eest.

![BTC204](assets/notext/53/01.webp)

Selles mudelis jätavad "makers" oma bitcoine "takers" käsutusse ja saavad vastutasuks teenustasu. "Takers" omalt poolt maksavad, et kasutada "makers'" bitcoine oma coinjoin tehingute läbiviimiseks. Teenustasud varieeruvad sõltuvalt rollist: "makers" koguvad tasusid oma likviidsuse pakkumise eest, samal ajal kui "takers" maksavad tasud. See turg toimib vabalt ilma kasutustingimusteta.

Üheks JoinMarketi peamiseks puuduseks on selle kasutamise keerukus, mis nõuab teatud tutvust terminalidega, et seda tõhusalt ära kasutada. Kuigi see keerukus ei ole takistuseks kogenud kasutajale, võib see piirata juurdepääsu üldisele avalikkusele. Siiski on hiljutine veebiliidese nimega JAM tutvustamine mingil määral hõlbustanud selle kasutamist.

![BTC204](assets/notext/53/02.webp)

Allikas: [JAM](https://github.com/joinmarket-webui/jam/blob/devel/docs/assets/screenshot-dark.webp)

Siiski jääb tehniline barjäär suureks takistuseks. Coinjoini ökosüsteemis, kus konfidentsiaalsust suurendab osalejate arv, mõjutab igasugune juurdepääsetavust vähendav piirang otseselt saadaolevat likviidsust, mis on segamise efektiivsuse jaoks kriitiline tegur. Bitcoin, juba nišš finantstehingutes, näeb oma coinjoinide kasutamist alanišina ja JoinMarket esindab veelgi spetsialiseeritumat osa, piirates seeläbi oma potentsiaali kasutajate anonüümsete kogumite suurendamiseks.

Hoolimata selle innovaatilisest P2P vahendamise mudelist coinjoinide jaoks, on JoinMarketil mõned olulised puudused, eriti tehingustruktuuri osas. Erinevalt teistest rakendustest nagu Whirlpool, ei taga JoinMarket väljundite täiuslikku võrdsust ja on võimalik jälgida deterministlikke seoseid sisendite ja väljundite vahel. Lisaks puuduvad vahendid, et vältida juba segatud müntide uuesti segamist, mis võiks ohustada kasutajate otsitavat konfidentsiaalsust.
Lõpuks, kuigi JoinMarketi kontseptsioon on huvitav, eriti nende jaoks, kes on huvitatud dünaamilisest likviidsusturust, teevad selle struktuursed nõrkused ja tehniline keerukus selle minu arvates vähem atraktiivseks, nii algajatele kui ka ekspertidele, kes otsivad coinjoini rakendust.
### Wabisabi
Wabisabi on veel üks coinjoin'i rakendus, mis kasutab tehingute koordineerimisel tsentraliseeritud lähenemist. Selle mudeli kujundasid Ádám Ficsór (nopara73), Yuval Kogman, Lucas Ontivero ja István András Seres 2021. aastal ning see integreeriti järgmisel aastal Wasabi 2.0 tarkvarasse. Wabisabi on täpselt Wasabi tarkvara 2018. aastal käivitatud coinjoin'i mudeli evolutsioon.

2010. aastate lõpus võttis Wasabi oma coinjoinide jaoks kasutusele tehingustruktuuri, mis erines radikaalselt Whirlpooli omast. Oma osalejate anonüümsuskomplektide suurendamiseks kasutas Wasabi väga suuri coinjoin tehinguid, mis grupeerisid kümneid osalejaid. Seevastu Whirlpool eelistas mitmeid väikeseid tehinguid, mis võimaldas anonüümsuskomplektide eksponentsiaalset suurenemist iga tsükliga.

Kahe rakenduse vahel tegi vahet ka ülejäägi haldamise meetod. Whirlpoolis jäeti ülejääk välja ja isoleeriti UTXO-dest enne coinjoin tsükleid tänu TX0-le, kontseptsioonile, mida ma selgitan lähemalt järgmises peatükis. Wasabis aga moodustas ülejääk ühe coinjoin tehingu väljunditest, mis säilitas teatud sisendite ja väljundite vahel deterministlikud seosed.

Wabisabiga kohandas Wasabi versioon 2.0 oma lähenemist coinjoinidele, et läheneda Whirlpooli mudelile. Kuigi coinjoin tehingud jäävad väga suureks, on nüüd võimalik aheldada mitu järjestikust tsüklit, järgides seega Whirlpooli mudelit. Eriti on pingutatud ka ülejäägi haldamise nimel: erinevalt Wasabi 1.0-st, kus ülejääk oli otse seotud kasutajate sisenditega, püüab Wabisabi jagada ülejäägi mitmeks väikeseks summaks, jaotades need võrdsetes denominatsioonides kõigile osalejatele.

Illustreerime seda lihtsustatud näitega, mis hõlmab ainult 2 kasutajat: Alice soovib segada 115 000 satsi ja Bob 210 000 satsi. Tasusid eirates oleks Wasabi 1.0 coinjoin tehing genereerinud 3 väljundit 100 000 satsiga, pluss 1 ülejääk 15 000 satsiga Alicele ja 1 ülejääk 10 000 satsiga Bobile. Ülejäägi väljundid oleksid alati seotud sisenditega:

Wabisabi puhul oleks sama tehing tootnud 3 väljundit 100 000 satsiga ja 5 väljundit 5 000 satsiga, hajutades seega ülejäägi viisil, et see ei ole otse jälgitav konkreetse sisendi juurde:

Isiklikult leian, et ülejäägi haldamine Wabisabis esitab mitmeid riske, mis võivad ohustada selle tõhusust privaatsuse osas:
- Kui kasutaja panustab UTXO-ga, mis on märkimisväärselt suurem kui teistel osalejatel, lõpeb ta paratamatult ülejäägiga, mis seotakse tema sisendiga. See läheb vastu protokolli algsele eesmärgile, milleks on tuvastatava ülejäägi kõrvaldamine;
- Denominatsioonide paljususe kasutamine ülejäägi killustamiseks võib paradoksaalselt kahjustada segamise efektiivsust. See protsess võib teatud väljundite anonüümsuskomplekte vähendada, kuna need muutuvad kergemini tuvastatavaks.
- See meetod genereerib ka madala väärtusega UTXO-sid, mis tekitavad kasutajale haldusprobleemi. Need väikesed UTXO-d, kui nende kulutamine muutub nende väärtusega võrreldes liiga kulukaks, võivad muutuda "tolmuks". See nähtus sunnib kasutajat ühendama mitu UTXO-d sisenditeks oma tulevastes tehingutes või need konsolideerima. Mõlemal juhul, COH tõttu, võib see kas vähendada saadud anonüümsete komplektide arvu või täielikult tühistada algse coinjoin'i abil saavutatud privaatsuse eelised.
Erinevalt Whirlpoolist, mis rakendab ZeroLink protokolli, tagades range eraldatuse eelsegatud ja järelsegatud UTXO-de vahel, ei säilita Wabisabi seda rangust. Samuti on olnud probleeme mõnede Wasabi klientide aadresside taaskasutamisega, mis on ilmselgelt kasutajale väga kahjulik.

Wasabi versioonis 2.0 on rakendatud uus coinjoin tasupoliitika. Nüüd on koordinaatori tasud määratud 0,3% peale UTXO-dele, mis on suuremad kui 0,01 bitcoin, samas kui väiksemate UTXO-de puhul on need tasud täielikult tühistatud. Lisaks on nende väikeste UTXO-de jaoks remixid tasuta, kuigi kaevandamistasud jäävad kasutaja kanda kõigi tehingute, sealhulgas remixide puhul.

See poliitika erineb Whirlpooli omast, kus tasud püsivad fikseeritud, olenemata saadud anonüümsete komplektide suurusest. Wasabi 2.0-ga, kuigi väikeste UTXO-de puhul on koordinaatori tasud tühistatud, peab kasutaja siiski maksma kaevandamistasud kõigi tehingute eest, sealhulgas remixide eest.
Kirjutamise hetkel on Wabisabi kasutamine muutunud märkimisväärselt keerulisemaks hiljutiste sündmuste tõttu. Tõepoolest, pärast Samourai Walleti asutajate arreteerimist teatas zkSNACKs, ettevõte, mis rahastab ja haldab Wasabi arendust, teatas oma coinjoin koordineerimisteenuse lõpetamisest 1. juunil 2024. See koordinaator, mis oli Wasabil vaikimisi seadistatud, omas suuremat osa likviidsusest.

Selle peamise koordinaatori sulgemisega peavad kasutajad nüüd ühenduma uute sõltumatute koordinaatoritega. See muudatus tekitab muret: ühelt poolt võivad uutel koordinaatoritel olla piisav likviidsus, vähendades seeläbi coinjoinide efektiivsust privaatsuse osas. Teiselt poolt on olemas risk sattuda pahatahtliku koordinaatori otsa. See olukord lisab uusi olulisi riske neile, kes soovivad kasutada Wabisabit.

Tehnilistest probleemidest kaugemal tekitab zkSNACKs'i, Wasabi taga oleva ettevõtte, otsus kasutada ketianalüüsi ettevõtte teenuseid coinjoinides osalejate filtreerimiseks tõsiseid eetilisi ja strateegilisi küsimusi. Algse idee eesmärk oli takistada kurjategijatel Wasabi coinjoine kasutamast, mis võib tunduda õigustatud. Siiski tekib paradoks: tasude maksmine koordinaatorile, mille peamine missioon on kasutajate privaatsuse suurendamine, ainult selleks, et seejärel rahastada ettevõtet, mille eesmärk on seda sama privaatsust kompromiteerida.

Veelgi murettekitavam on filtreerimise põhimõte, mis erineb oluliselt Bitcoini filosoofiast, mille eesmärk on pakkuda avatud ja tsenseerimata finantssüsteemi. Kuigi kuritegevuse välistamine võib tunduda õigustatud, võib see filtreerimine mõjutada ka isikuid, kelle tegevus, kuigi mõnes kontekstis ebaseaduslik, võib olla moraalselt õigustatud või ühiskondlikult kasulik. Edward Snowdeni näide illustreerib seda dikotoomiat täiuslikult: mõnede valitsuste poolt tema paljastuste tõttu kurjategijaks peetud, on ta teiste jaoks vilepuhuja, kes tegutses avalikes huvides. See keerukus rõhutab filtreerimise potentsiaalset ohtu, mis, kuigi lähtudes heast kavatsusest, võib lõpuks piirata legitiimsete kasutajate õigusi ja turvalisust. Samuti oleksin võinud mainida aktiviste ja ajakirjanikke, kes on teatud autoritaarsete režiimide all tagakiusatud.
Nagu te juba aru saite, eelistan ma kahtlemata Whirlpooli mudelit Bitcoinil coinjoins'i läbiviimiseks. See süsteem paistab silma oma ranguse poolest ja pakub privaatsuse osas ülimaid tagatisi. Samuti on see ainus, mis pakub matemaatilises kontekstis peetavat täiuslikku segamist. Minu arvates esindab see mudel Bitcoinil coinjoins'i tulevikku. Seetõttu kutsun teid järgmises peatükis seda mudelit põhjalikumalt uurima.

## Whirlpooli Tööpõhimõte
<chapterId>bdbd7109-e36d-4b4f-a3c6-928df4e9bfda</chapterId>

Whirlpool eristub teistest coinjoin meetoditest, kasutades "_ZeroLink_" tehinguid, mis tagavad, et sisendite ja väljundite vahel ei ole tehniliselt võimalik mingit otsest seost luua. See täiuslik segamine saavutatakse struktuuriga, kus iga osaleja panustab identse summa sisendisse (v.a kaevandamistasud), genereerides seeläbi täiesti võrdsetes summadest väljundid.

See piirav lähenemine sisenditele annab Whirlpooli coinjoin tehingutele unikaalse omaduse: täieliku deterministlike seoste puudumise sisendite ja väljundite vahel. Teisisõnu, iga väljundil on võrdne tõenäosus olla omistatud ükskõik millisele osalejale, võrreldes kõigi teiste tehingu väljunditega.

![BTC204](assets/notext/54/01.webp)

### Whirlpooli Üldine Tööpõhimõte

Alguses oli iga Whirlpooli coinjoin'i osalejate arv piiratud viiega, kahe uue tulijaga ja kolme remikseriga (selgitame neid mõisteid edaspidi). Siiski on 2023. aastal täheldatud on-chain tehingutasude suurenemine sundinud Samourai meeskondi oma mudelit ümber mõtlema, et parandada privaatsust samal ajal kulusid vähendades. Seega, arvestades tasude turuolukorda ja osalejate arvu, saab koordinaator nüüd korraldada coinjoins'e, mis hõlmavad 6, 7 või 8 osalejat. Neid täiustatud sessioone tähistatakse nimega "_Surge Cycles_". On oluline märkida, et olenemata konfiguratsioonist, on Whirlpooli coinjoins'ides alati ainult kaks uut tulijat.

Seega iseloomustavad Whirlpooli tehinguid identne arv sisendeid ja väljundeid, mis võivad olla:
- 5 sisendit ja 5 väljundit;

![BTC204](assets/notext/54/02.webp)

- 6 sisendit ja 6 väljundit;

![BTC204](assets/notext/54/03.webp)

- 7 sisendit ja 7 väljundit;

![BTC204](assets/notext/54/04.webp)

- 8 sisendit ja 8 väljundit.

![BTC204](assets/notext/54/05.webp)
Mudel, mida Whirlpool pakub, põhineb seega väikeste coinjoin tehingute ahelal. Erinevalt Wabisabist ja JoinMarketist, kus anonüümsete osalejate hulga tugevus sõltub ühe tsükli (või mõne tsükli) osalejate mahust, panustab Whirlpool mitme väikese suurusega tsükli ahelale. Selles mudelis tekivad kasutajale tasud ainult nende esialgsel sisenemisel basseini, võimaldades neil osaleda paljudes remiksis ilma lisatasudeta. Uued tulijad katavad remikserite kaevandamistasud.

Iga täiendava coinjoin'iga, milles münt osaleb koos oma minevikus kohatud eakaaslastega, kasvavad anonüümsete osalejate hulgad eksponentsiaalselt. Seega on eesmärk ära kasutada neid tasuta remikse, mis iga kordumisega aitavad tugevdada iga segatud mündiga seotud anonüümsete osalejate hulga tihedust.

![BTC204](assets/notext/54/06.webp)

Whirlpool on loodud kahe olulise nõudega silmas pidades:
- Rakenduse kättesaadavus mobiilseadmetes, arvestades, et Samourai Wallet on peamiselt nutitelefoni rakendus;
- Segamistsüklite kiirus, et julgustada anonüümsete komplektide arvu märkimisväärset suurenemist.

Need imperatiivid juhtisid Samourai Walleti arendajate valikuid Whirlpooli disainimisel, pannes neid piirama osalejate arvu tsükli kohta. Liiga vähesed osalejad oleksid ohustanud coinjoini efektiivsust, drastiliselt vähendades iga tsükli jooksul genereeritud anonüümsete komplektide arvu, samas kui liiga paljud osalejad oleksid põhjustanud haldusprobleeme mobiilirakendustes ja takistanud tsüklite voolu.

Lõppkokkuvõttes pole Whirlpoolis iga coinjoini kohta vaja suurt osalejate arvu, kuna anonüümsete komplektide loomine toimub mitme coinjoini tsükli kumulatiivsel kogunemisel. Kõige olulisem põhimõte siin on kõigi osalejate UTXO-de homogeensus, kuna see võimaldab täiuslikku segamist ja seega täielikult kasu saada segamis- ja ümbersegamistsüklitest.

### Basseinid ja coinjoini tasud

Selleks, et need mitmed tsüklid tõhusalt suurendaksid segatud müntide anonüümsete komplektide arvu, tuleb kehtestada teatud raamistik, et piirata kasutatavate UTXO-de summasid. Whirlpool määratleb seetõttu erinevad basseinid.

Bassein esindab kasutajate gruppi, kes soovivad koos segada, nõustudes UTXO-de summa üle, et optimeerida coinjoini protsessi säilitades samal ajal müntide täiusliku homogeensuse. Iga bassein määratleb UTXO jaoks fikseeritud summa, millele kasutaja peab osalemiseks vastama. Seega, et teostada coinjoine Whirlpooliga, peate valima basseini. Praegu saadaolevad basseinid on järgmised:
- 0,5 bitcoini;
- 0,05 bitcoini;
- 0,01 bitcoini;
- 0,001 bitcoini (= 100 000 satsi).
Liitudes oma bitcoinidega basseini, jagatakse need, et genereerida UTXO-d, mis on täiuslikult homogeensed teiste basseini osalejate omadega. Igal basseinil on maksimaalne limiit; seega summade puhul, mis ületavad seda piiri, sunnitakse teid kas tegema kaks eraldi sisenemist samasse basseini või pöörduma teise basseini poole, mille summa on suurem:
| Bassein (bitcoin) | Maksimaalne summa ühe sisenemise kohta (bitcoin) |
|-------------------|--------------------------------------------------|
| 0,5               | 35                                               |
| 0,05              | 3,5                                              |
| 0,01              | 0,7                                              |
| 0,001             | 0,025                                            |

UTXO-d peetakse basseini kuuluvaks, kui see on valmis coinjoini integreerimiseks. Siiski ei tähenda see, et kasutaja kaotab selle omandiõiguse. Nagu oleme näinud selle osa esimestes peatükkides, läbi erinevate segamistsüklite, säilitate täieliku kontrolli oma võtmete ja seega oma bitcoinide üle. See eristab coinjoini tehnikat teistest tsentraliseeritud segamistehnikatest.

Coinjoini basseini sisenemiseks peate maksma teenustasud ning kaevandamistasud. Teenustasud on iga basseini jaoks fikseeritud ja on mõeldud Whirlpooli arendamise ja hooldamise eest vastutavate meeskondade kompenseerimiseks.

Whirlpooli kasutamise teenustasud tuleb maksta ühekordselt basseini sisenedes. Kui see samm on lõpetatud, on teil võimalus osaleda piiramatus arvus ümbersegamistes ilma lisatasudeta. Siin on praegused fikseeritud tasud iga basseini kohta:

| Bassein (bitcoin) | Sisenemistasu (bitcoin)   |
|-------------------|---------------------------|
| 0,5               | 0,0175                    |
| 0,05              | 0,00175                   |
| 0,01              | 0,0005 (50 000 satsi)     |
| 0.001          | 0.00005 (5,000 sats)        |
Need tasud toimivad sisuliselt sisenemispiletina valitud basseini, olenemata summast, mille paned coinjoin'i. Seega, kas liitud 0.01 basseiniga täpselt 0.01 BTC-ga või sisened sellega 0.5 BTC-ga, jäävad tasud absoluutväärtuses samaks.

Enne Whirlpool coinjoin'idega jätkamist on kasutajal seega valik kahe strateegia vahel:
- Eelistada väiksemat basseini, et minimeerida teenustasusid, teades, et vastu saadakse mitu väiksemat UTXO-d;
- Või eelistada suuremat basseini, nõustudes maksma kõrgemaid tasusid, et lõpuks saada vähem, kuid suurema väärtusega UTXO-sid.
Üldiselt ei soovitata mitut segatud UTXO-d pärast coinjoin tsükleid ühendada, kuna see võib kompromiteerida saavutatud privaatsust, eriti seoses ühise sisendi omandi heuristikaga (CIOH: *Common-Input-Ownership-Heuristic*). Seetõttu võib olla mõistlik valida suurem bassein, isegi kui see tähendab rohkema maksmist, et vältida liiga paljude väikese väärtusega UTXO-de saamist väljunditena. Kasutaja peab kaaluma neid kompromisse, et valida endale eelistatud bassein.
Teenustasude kõrval tuleb arvestada ka kaevandamistasusid, mis on omased igale Bitcoin'i tehingule. Whirlpool'i kasutajana pead maksma kaevandamistasud ettevalmistustehingu (`Tx0`) eest, samuti esimese coinjoin'i eest. Kõik järgnevad remixid on tasuta, tänu Whirlpool'i mudelile, mis põhineb uute osalejate maksetel.

Tõepoolest, igas Whirlpool coinjoin'is on 2 sisendit uued osalejad. Ülejäänud sisendid pärinevad remixijatelt. Selle tulemusena kaetakse kõigi tehingus osalejate kaevandamistasud nende 2 uue osaleja poolt, kes saavad seejärel samuti tasuta remixidest kasu:

![BTC204](assets/en/54/07.webp)

Tänu sellele tasusüsteemile eristub Whirlpool tõeliselt teistest coinjoin rakendustest, kuna UTXO-de anonüümsuskomplektid ei ole proportsionaalsed kasutaja poolt makstud hinnaga. Seega on võimalik saavutada märkimisväärselt kõrge anonüümsuse tase, makstes ainult basseini sisenemistasu ja kahe tehingu (Tx0 ja esialgne segamine) kaevandamistasud.

On oluline märkida, et kasutaja peab samuti katma kaevandamistasud, et oma UTXO-d pärast mitmeid coinjoin'e basseinist välja võtta, välja arvatud juhul, kui on valitud `mix to` valik, mis võimaldab pakkuda välist aadressi, mis saab vahendid otse coinjoin väljundina, ilma lisatehinguta.

### HD Rahakoti Kontod

Coinjoin'i sooritamiseks Whirlpool'i kaudu peab rahakott genereerima mitu erinevat kontot. See on ZeroLink protokolli põhimõte. Konto, HD (*Hierarchical Deterministic*) rahakoti kontekstis, moodustab osa, mis on täielikult isoleeritud teistest, see eraldatus toimub rahakoti hierarhia kolmandal sügavustasemel, st `xpub` tasemel.

![BTC204](assets/en/54/08.webp)

HD rahakott saab teoreetiliselt tuletada kuni `2^(32/2)` erinevat kontot. Esialgne konto, mida vaikimisi kasutatakse kõikides Bitcoin'i rahakottides, vastab indeksile `0'`.

Whirlpool'iga kohandatud rahakottides kasutatakse ZeroLink protsessi vajaduste rahuldamiseks 4 kontot:
- **Hoiukonto**, mida tuvastab indeks `0'`;
- **Halb pank** konto (või "doxxic change"), mida tuvastab indeks `2 147 483 644'`;
- **Premix** konto, mida tuvastatakse indeksiga `2 147 483 645`;
- **Postmix** konto, mida tuvastatakse indeksiga `2 147 483 646`.

Igal neist kontodest on oma kindel funktsioon coinjoin protsessis, mida uurime järgnevates jaotistes.

Kõik need kontod on seotud ühe seemnega, mis võimaldab kasutajal taastada juurdepääsu kõigile oma bitcoinidele, kasutades taastefraasi ja vajadusel oma paroolilauset. Siiski on vajalik tarkvarale taastamistoimingu ajal täpsustada kasutatud kontode indeksid.

Vaadelgem nüüd Whirlpooli coinjoini erinevaid etappe nende kontode raames.

### TX0

Iga Whirlpooli coinjoini lähtepunkt on **deposiidikonto**. See konto on see, mida automaatselt kasutate, kui loote uue Bitcoin'i rahakoti. Sellele kontole tuleb kanda bitcoine, mida soovite segada.

`Tx0` tähistab Whirlpooli segamisprotsessi esimest sammu. Selle eesmärk on ette valmistada ja võrdsustada UTXOsid coinjoini jaoks, jagades need üksusteks, mis vastavad valitud basseini summale, tagamaks segamise homogeensust. Võrdsustatud UTXOsid saadetakse seejärel **premix** kontole. Erinevus, mis ei saa basseini siseneda, eraldatakse spetsiifilisele kontole: **bad bank** (või "doxxic change").

See algne tehing `Tx0` teenib ka coinjoini koordinaatori teenustasude tasumist. Erinevalt järgnevatest sammudest ei ole see tehing koostööaldis; kasutaja peab seega kandma kõik kaevandamistasud:

![BTC204](assets/en/54/09.webp)

Selles `Tx0` tehingu näites jagatakse meie **deposiidikonto** sisend `372 000 sats` mitmeks väljund-UTXOks, mis jaotuvad järgmiselt:
- Summa `5 000 sats` on mõeldud koordinaatorile teenustasudeks, vastates basseini sisenemisele `100 000 sats`;
- 3 UTXOd, mis on ette valmistatud segamiseks, suunatakse meie **premix** kontole ja registreeritakse koordinaatori juures. Need UTXOd võrdsustatakse `108 000 sats` igaüks, et katta nende tulevaste esialgsete segude kaevandamistasud;
- Ülejääk, mis ei saa basseini siseneda, kuna on liiga väike, peetakse toksiliseks muutuseks. See saadetakse oma spetsiifilisele kontole. Siin on see muutus `40 000 sats`;
- Lõpuks on `3,000 sats`, mis ei moodusta väljundit, vaid on kaevandamistasud, mis on vajalikud `Tx0` kinnitamiseks.
Näiteks siin on reaalne Tx0 Whirlpool (mitte minult): [edef60744f539483d868caff49d4848e5cc6e805d6cdc8d0f9bdbbaedcb5fc46](https://mempool.space/fr/tx/edef60744f539483d868caff49d4848e5cc6e805d6cdc8d0f9bdbbaedcb5fc46)

![BTC204](assets/notext/54/10.webp)

### Toksilised Muutused

Liigne, mis ei saanud basseini integreeruda, siin võrdne `40,000 sats`-iga, suunatakse **bad bank** kontole, mida nimetatakse ka "toksiliseks muutuseks", et tagada range eraldatus teistest rahakoti UTXOdest.
See UTXO on kasutaja privaatsuse jaoks ohtlik, kuna see on endiselt seotud oma minevikuga ja seega võimalikult ka omaniku identiteediga, kuid see on ka märgistatud kui kasutaja oma, kes on osalenud coinjoin'is.
![BTC204](assets/notext/54/11.webp)

Kui see UTXO ühendatakse segatud väljunditega, kaotavad need kõik privaatsuse, mis saavutati coinjoin tsüklite jooksul, eriti seetõttu, et CIOH (*Common-Input-Ownership-Heuristic*). Kui see ühendatakse teiste toksiliste muudatustega, riskib kasutaja privaatsuse kaotamisega, kuna see seob erinevad sissekanded coinjoin tsüklitest. Seetõttu tuleb seda ettevaatlikult käsitleda. Räägime nende toksiliste UTXOde haldamisest üksikasjalikumalt selle peatüki viimases osas.

### Esialgne Segamine

Pärast `Tx0` lõpetamist saadetakse võrdsustatud UTXOd meie rahakoti **premix** kontole, valmis esimesse coinjoin tsüklisse tutvustamiseks, mida nimetatakse ka "esialgseks segamiseks". Kui, nagu meie näites, `Tx0` genereerib mitu segamiseks mõeldud UTXOt, integreeritakse igaüks neist eraldi esialgsesse segamisse.

Nende esimeste segamiste lõppedes on **premix** konto tühi, samal ajal kui meie mündid, olles maksnud kaevandamistasud selle esimese coinjoin eest, on täpselt kohandatud valitud basseini määratletud summaga. Meie näites on meie algsete UTXOde `108,000 sats` vähendatud täpselt `100,000 sats`-ni.

![BTC204](assets/notext/54/12.webp)

### Ümbersegamised
Pärast esialgset segamist kantakse UTXOd **postmix** kontole. See konto koondab nii juba segatud UTXOd kui ka need, mis ootavad ümbersegamist. Kui Whirlpooli klient on aktiivne, on **postmix** konto UTXOd automaatselt saadaval ümbersegamiseks ja neid valitakse juhuslikult osalema nendes uutes tsüklites.
Meenutuseks, ümbersegamised on siis 100% tasuta: lisateenustasusid või kaevandamistasusid ei nõuta. UTXOde hoidmine **postmix** kontol säilitab nende puutumatu väärtuse ja parandab samal ajal nende anonüümsete komplektide taset. Seetõttu on oluline lubada nendel müntidel osaleda mitmes coinjoin tsüklis. See ei maksa teile midagi ja suurendab nende anonüümsuse taset.

Kui otsustate segatud UTXOsid kulutada, saate seda teha otse sellest **postmix** kontolt. On soovitatav hoida segatud UTXOsid selles kontos, et saada kasu tasuta ümbersegamistest ja vältida nende lahkumist Whirlpooli ringist, mis võiks vähendada nende privaatsust.

### Kuidas oma postmixi korralikult hallata?

Pärast coinjoin tsüklite sooritamist on parim strateegia hoida oma UTXOsid **postmix** kontol, oodates nende tulevast kasutamist. On isegi soovitatav lasta neil ümber segada lõpmatult, kuni on vaja neid kulutada.

Mõned kasutajad võivad kaaluda oma segatud bitcoinide ülekandmist riistvara rahakotiga turvatud rahakotti. See on võimalik, kuid on oluline hoolikalt järgida Samourai Wallet'i soovitusi, et mitte ohustada omandatud konfidentsiaalsust.

UTXOde ühendamine on kõige sagedamini tehtud viga. On vajalik vältida segatud UTXOde ühendamist segamata UTXOdega samas tehingus, et vältida Common-Input-Ownership-Heuristic (CIOH). See nõuab teie UTXOde hoolikat haldamist teie rahakotis, eriti märgistamise osas.

![BTC204](assets/notext/54/13.webp)
Samuti on oluline olla ettevaatlik segatud UTXOde omavahel konsolideerimisel. Mõõdukad konsolideerimised on mõeldavad, kui teie segatud UTXOdel on oluline anonüümsus, kuid see vähendab paratamatult teie müntide konfidentsiaalsust. Veenduge, et konsolideerimised ei oleks liiga märkimisväärsed ega toimuks pärast ebapiisavat arvu ümbersegamisi, riskides enne ja pärast coinjoin tsükleid teie UTXOde vahel jälitamist võimaldavate seoste loomisega. Kui kahtlete nende manipulatsioonide osas, on parim praktika mitte konsolideerida postmix UTXOsid ja kanda need ükshaaval oma riistvarakotti, genereerides iga kord uue tühja aadressi. Jällegi, pidage meeles korrektselt märgistada iga vastuvõetud UTXO. Samuti ei soovitata kanda oma postmix UTXOsid rahakotti, mis kasutab ebatavalisi skripte. Näiteks, kui sisestate Whirlpooli multisig rahakotist, kasutades `P2WSH` skripte, on väike võimalus, et teid segatakse teiste kasutajatega, kellel on algselt sama tüüpi rahakott. Kui võtate oma postmixi välja samasse multisig rahakotti, väheneb teie segatud bitcoinide privaatsuse tase oluliselt. Skriptide kõrval on palju muid rahakoti jälgi, mis võivad teid eksitada.
Nagu iga Bitcoin tehingu puhul, on oluline ka mitte taaskasutada vastuvõtu aadresse. Iga uus tehing peaks toimuma uuel, tühjal aadressil.

Lihtsaim ja turvalisim lahendus on lasta oma segatud UTXOdel puhata nende **postmix** kontol, lastes neil ümber segada ja puudutades neid ainult kulutamiseks. Samourai ja Sparrow rahakotid pakuvad lisakaitset kõigi nende ahela analüüsiga seotud riskide eest. Need kaitsemeetmed aitavad vältida vigade tegemist.

### Kuidas korrektselt hallata oma toksilist vahetusraha?

Järgmisena peate olema ettevaatlik oma doxxilise vahetusraha haldamisel, vahetusraha, mis ei saanud coinjoin basseini siseneda. Need toksilised UTXOd, mis tulenevad Whirlpooli kasutamisest, kujutavad endast teie privaatsusele ohtu, kuna need loovad seose teie ja coinjoini kasutamise vahel. Seetõttu on hädavajalik neid ettevaatlikult käsitseda ja mitte kombineerida neid teiste UTXOdega, eriti segatud UTXOdega.

Siin on erinevad strateegiad nende kasutamiseks:
- **Sega neid väiksemates basseinides:** Kui teie toksiline UTXO on piisavalt suur, et iseseisvalt väiksemasse basseini siseneda, kaaluge selle segamist. See on sageli parim valik. Siiski on mitme toksilise UTXO ühendamine basseini pääsemiseks soovitatav, kuna see võib siduda teie erinevad sissekanded;
- **Märgi need "mittekulutatavateks":** Teine lähenemine on neid enam mitte kasutada, märkida need nende pühendatud kontol "mittekulutatavateks" ja lihtsalt hoida. See tagab, et te ei kuluta neid kogemata. Kui bitcoini väärtus tõuseb, võivad teie toksiliste UTXOde jaoks ilmuda uued sobivamad basseinid;
- **Tee annetusi:** Kaaluge annetuste tegemist, isegi tagasihoidlikke, arendajatele, kes töötavad Bitcoiniga ja selle seotud tarkvaraga. Samuti võite annetada organisatsioonidele, kes aktsepteerivad BTC-d. Kui teie toksiliste UTXOde haldamine tundub liiga keeruline, võite neist lihtsalt vabaneda, tehes annetuse.
- **Osta kinkekaarte:** Platvormid nagu [Bitrefill](https://www.bitrefill.com/) võimaldavad teil vahetada bitcoine kinkekaartide vastu, mida saab kasutada erinevates kauplustes. See võib olla viis vabaneda oma toksilistest UTXOdest, kaotamata seotud väärtust.
- **Koondage need Monerosse:** Samourai Wallet pakub aatomivahetuse teenust BTC ja XMR vahel. See on ideaalne viis toksiliste UTXO-de haldamiseks, koondades need Monerosse, ilma et see ohustaks teie privaatsust KYC kaudu, enne kui saadate need tagasi Bitcoini. Siiski võib see valik olla kulukas seoses kaevandamistasude ja preemiate osas likviidsuspiirangute tõttu.
- **Saada need Lightning Networki:** Nende UTXO-de ülekandmine Lightning Networki, et kasu saada väiksematest tehingutasudest, on huvitav valik. Siiski võib see meetod sõltuvalt teie Lightningu kasutamisest paljastada teatud teavet ja seetõttu tuleks seda kasutada ettevaatlikult.

### Kuidas kasutada Whirlpooli?

Pärast Samourai Walleti asutajate arreteerimist ja nende serverite konfiskeerimist 24. aprillil 2024 ei tööta Whirlpooli tööriist enam, isegi neile, kellel on oma Dojo. Varem oli see saadaval Samourai Walletis ja Sparrow Walletis.

![BTC204](assets/notext/54/14.webp)

Siiski on võimalik, et see tööriist võidakse järgnevatel nädalatel taas kasutusele võtta, sõltuvalt kohtuprotsesside tulemustest, või käivitada erineval viisil. Igatahes usun, et Bitcoinil coinjoini turul jääb pakkumine pikaks ajaks püsima, kuna nõudlus on selge. Pealegi, Whirlpooli mudel, olles kõige arenenum privaatsuse osas, kasutatakse kindlasti tulevikus teistes rakendustes.

Jälgime selle juhtumi arengut ning seotud tööriistade arengut lähedalt. Võite olla kindlad, et uuendame seda koolitust, kui uut teavet saabub.

Järgmises peatükis avastame, mis on "anonsets", kuidas neid näitajaid arvutatakse ja kuidas need aitavad meil hinnata coinjoin tsüklite efektiivsust.

https://planb.network/tutorials/privacy/coinjoin-sparrow-wallet

https://planb.network/tutorials/privacy/coinjoin-samourai-wallet

https://planb.network/tutorials/privacy/coinjoin-dojo

## Anonüümsuse Komplektid
<chapterId>be1093dc-1a74-40e5-9545-2b97a7d7d431</chapterId>

Pärast seda, kui oleme uurinud, kuidas coinjoinid töötavad ja millised on tõhusa segamisega seotud väljakutsed, õpime nüüd, kuidas seda tõhusust mõõta. Kuidas kindlaks teha, kas coinjoin protsess on olnud tõhus ja millise anonüümsuse astme on münt omandanud? Seda uurime selles peatükis anonüümsuse komplektide ehk "anonsets" abil.

### Meeldetuletus Coinjoini Kasulikkusest
CoinJoini kasulikkus seisneb selles, et see võimaldab luua usutava eitamise, sukeldades teie mündi eristamatute müntide gruppi. Selle tegevuse eesmärk on katkestada jälgitavuse lingid, nii minevikust olevikku kui ka olevikust minevikku. 
Teisisõnu, analüütik, kes teab teie algset tehingut (`Tx0`) CoinJoini tsüklite sisenemisel, ei tohiks suuta kindlalt tuvastada teie UTXO-d tsüklite segamise väljumisel (analüüs tsükli sisenemisest tsükli väljumiseni).

![BTC204](assets/en/55/01.webp)

Vastupidi, analüütik, kes teab teie UTXO-d CoinJoini tsüklite väljumisel, ei tohiks suuta kindlaks teha algset tehingut tsüklite sisenemisel (analüüs tsükli väljumisest tsükli sisenemiseni).

![BTC204](assets/en/55/02.webp)
Analüüsi raskuse hindamiseks, et seostada minevikku olevikuga ja vastupidi, on vajalik kvantifitseerida homogeensete müntide grupi suurus, milles teie münt on peidetud. See mõõdik näitab analüüside arvu, millel on identne tõenäosus. Seega, kui õige analüüs on uppunud 3 teise võrdse tõenäosusega analüüsi hulka, on teie varjatuse tase väga madal. Kuid, kui õige analüüs on 20,000 analüüsi hulgas, mis kõik on võrdselt tõenäolised, on teie münt väga hästi peidetud. Ja täpselt, nende gruppide suurus esindab indikaatoreid, mida nimetatakse "anonsetideks".
### Anonsettide mõistmine

Anonsetid toimivad indikaatoritena, et hinnata konkreetse UTXO privaatsuse astet. Täpsemalt, nad mõõdavad eristamatute UTXOde arvu komplektis, mis sisaldab uuritavat münti. Homogeense UTXO komplekti nõue tähendab, et anonsette arvutatakse tavaliselt CoinJoin tsüklite üle. Nende indikaatorite kasutamine on eriti asjakohane Whirlpool CoinJoinide puhul nende ühtsuse tõttu.

Anonsetid võimaldavad, kui see on asjakohane, hinnata CoinJoinide kvaliteeti. Suur anonseti suurus tähistab kõrget anonüümsuse taset, kuna konkreetse UTXO eristamine homogeenses komplektis muutub keeruliseks.

On 2 tüüpi anonsette:
- **Tulevikku vaatav anonset;**
- **Tagasivaatav anonset.**

### Tulevikku vaatav anonset

Tulevikku vaatav anonset näitab grupi suurust, mille hulgas uuritav UTXO on peidetud tsükli väljumisel, teades UTXO-d sisenemisel, see tähendab, eristamatute müntide arvu selles grupis. Inglise keeles on selle indikaatori nimi "forward anonset" või "forward-looking metrics".
See indikaator võimaldab mõõta mündi privaatsuse vastupanuvõimet minevikust-olevikku analüüsi (sisendist väljundini) vastu.

Näiteks, kui teie tehing osales oma esimeses coinjoin tsüklis ja kaks täiendavat järeltulija tsüklit viidi lõpule, oleks teie mündi tulevikku vaatav anonset `13`:

![BTC204](assets/notext/55/04.webp)

Näiteks kujutagem ette, et meie münt coinjoin tsükli sisenemisel saab tulevikku vaatava anonseti suuruseks `86,871`. Praktiliselt tähendab see, et see on peidetud `86,871` eristamatu münti hulka. Väline vaatleja, kes on teadlik sellest mündist coinjoin tsüklite alguses ja üritab jälgida selle väljumist, seisaks silmitsi `86,871` võimaliku UTXO-ga, millest igaühel on identne tõenäosus olla otsitav münt.

![BTC204](assets/en/55/05.webp)

### Tagasivaatav anonset

Tagasivaatav anonset näitab võimalike allikate arvu antud mündile, teades UTXO-d tsükli väljumisel. See indikaator mõõdab mündi privaatsuse vastupanuvõimet olevikust-minevikku analüüsi (väljundist sisendini) vastu, see tähendab, kui keeruline on analüütikul jälitada tagasi teie mündi päritolu enne coinjoin tsükleid. Inglise keeles on selle indikaatori nimi "backward anonset," või "backward-looking metrics."

![BTC204](assets/en/55/06.webp)

Teie UTXO teades tsüklite väljumisel, määrab tagasivaatav anonset potentsiaalsete Tx0 tehingute arvu, mis võisid moodustada teie sisenemise coinjoin tsüklitesse. Allpool olevas diagrammis vastab see kõigi oranžide mullide summale.
![BTC204](assets/notext/55/07.webp)
Näiteks kujutagem ette, et meie münt pärast coinjoin tsükli lõppu saab tagasiulatuva anonüümsuse komplekti `42,185`. Praktiliselt tähendab see, et sellel UTXO-l on `42,185` potentsiaalset allikat. Kui väline vaatleja tuvastab selle mündi tsüklite lõpus ja püüab selle päritolu jälitada, seisab ta silmitsi `42,185` võimaliku allikaga, kõik võrdse tõenäosusega olla otsitav päritolu.

![BTC204](assets/en/55/08.webp)

### Kuidas anonüümsuse komplekte konkreetselt arvutada?
Väikeste komplektide puhul on võimalik anonüümsuse komplekte käsitsi arvutada, kasutades plokiahela uurijat. Suuremate komplektide puhul muutub spetsialiseeritud tööriista kasutamine hädavajalikuks. Minu teada on ainus tarkvara, mis suudab seda ülesannet täita, *Whirlpool Stats Tool*, Pythoni tööriist, mille on välja töötanud Samourai ja OXT meeskonnad. Kahjuks on see tööriist pärast Samourai asutajate arreteerimist ja OXT kasutamise lõpetamist, mida kasutati andmete väljavõtmiseks plokiahelast, praegu teenusest väljas.
![BTC204](assets/notext/55/09.webp)

Nagu selles peatükis nägime, saab anonüümsuse komplekte arvutada ainult siis, kui coinjoinide struktuuris on teatav ühtlus. Ja täpselt, järgmises peatükis avastame, kuidas seda ühtlust kvantifitseerida Bitcoin tehingus, olgu see siis coinjoin või traditsioonilisem tehing.

https://planb.network/tutorials/privacy/wst-anonsets

## Entroopia
<chapterId>e4fe289d-618b-49a2-84c9-68c562e708b4</chapterId>

Nagu me selles osas coinjoinide kohta nägime, mängib UTXO-de ühtlus sisendites ja väljundites olulist rolli Bitcoin tehingu konfidentsiaalsuse parandamisel. See parameeter võimaldab usutavat eitamist ahela analüüsi vastu. Selle ühtluse mõõtmiseks on mitu meetodit, kuid minu arvates üks tõhusamaid on *Boltzmann* tööriista poolt pakutavate näitajate kasutamine, mille on välja töötanud OXT ja Samourai Wallet meeskonnad, eriti tehingu entroopia. Seda me uurime selles peatükis üksikasjalikult.

Erinevalt anonüümsuse komplektidest, mis arvutatakse tehingute komplekti üle, keskenduvad siin esitatavad näitajad ainult ühele tehingule, olgu see siis coinjoin või traditsioonilisem tehing.

### Tõlgenduste arv

Esimene näitaja, mida saab Bitcoin tehingul täheldada, on võimalike tõlgenduste koguarv välise vaatleja silmis, kes analüüsib tehingut. Arvestades tehingus osalevate UTXO-de väärtusi, näitab see näitaja, mitmel viisil saab sisendeid seostada väljunditega. Teisisõnu, see määrab, mitu võimalikku tõlgendust tehing võib genereerida bitcoinide voolus välise vaatleja analüüsi perspektiivist.

Näiteks lihtsal maksetehingul 1 sisendiga ja 2 väljundiga on ainult üks tõlgendus, nimelt et sisend #0 rahastas väljundit #0 ja väljundit #1. Muid võimalikke tõlgendusi ei ole:

![BTC204](assets/notext/56/01.webp)

Seevastu coinjoin, mis on struktureeritud vastavalt Whirlpool 5x5 mudelile, esitab $1,496$ võimalikku kombinatsiooni:
![BTC204](assets/notext/56/02.webp)
Whirlpool Surge Cycle 8x8 coinjoin esitab endaga $9,934,563$ võimalikku tõlgendust:

![BTC204](assets/notext/56/03.webp)

### Entroopia
Bitcoin'i tehingu tõlgenduste arvust saame arvutada selle entroopia.

Üldises krüptograafia ja informatsiooni kontekstis on entroopia kvantitatiivne mõõdik, mis väljendab andmeallika või juhusliku protsessiga seotud ebakindlust või ettearvamatust. Teisisõnu, entroopia on viis mõõta, kui raske on informatsiooni ennustada või ära arvata.

Spetsiifilises ahela analüüsi kontekstis on entroopia samuti indikaatori nimi, mis on tuletatud Shannoni entroopiast ja [leiutatud LaurentMT poolt](https://gist.github.com/LaurentMT/e758767ca4038ac40aaf), mida saab arvutada Bitcoin'i tehingu puhul.

Kui tehingul on palju võimalikke tõlgendusi, on sageli asjakohasem viidata selle entroopiale. See indikaator võimaldab mõõta analüütikute teadmiste puudumist tehingu täpse konfiguratsiooni kohta. Teisisõnu, mida suurem on entroopia, seda raskem on analüütikutel tuvastada bitcoini vahendite liikumist sisendite ja väljundite vahel.

Praktikas paljastab entroopia, kas tehing esitab välise vaatleja perspektiivist mitmeid võimalikke tõlgendusi, lähtudes ainult sisendite ja väljundite summadest, ilma teiste väliste või sisemiste mustrite ja heuristikate arvestamiseta. Kõrge entroopia on siis sünonüüm tehingu paremale konfidentsiaalsusele.

Entroopia on defineeritud kui võimalike kombinatsioonide arvu binaarlogaritm. Siin on kasutatav valem, kus $E$ on tehingu entroopia ja $C$ võimalike tõlgenduste arv:

$$
E = \log_2(C)
$$

Matemaatikas vastab binaarlogaritm (alus 2 logaritm) kahe astendamise pöördoperatsioonile. Teisisõnu, $x$ binaarlogaritm on eksponent, millele $2$ tuleb tõsta, et saada $x$. See indikaator väljendatakse seega bittides.

Võtame näiteks entroopia arvutamise coinjoin tehingu jaoks, mis on struktureeritud vastavalt Whirlpool 5x5 mudelile, mis, nagu eelmises jaotises mainitud, esitab $1,496$ võimalikku tõlgendust:

$$
\begin{align*}
C &= 1,496 \\
E &= \log_2(1,496) \\
E &= 10.5469 \text{ bitti}
\end{align*}
$$
Seega kuvab see coinjoin tehing entroopiat $10.5469$ bitti, mis on peetud väga rahuldavaks. Mida suurem see väärtus, seda rohkem erinevaid tõlgendusi tehing lubab, suurendades seeläbi selle privaatsuse taset.
8x8 coinjoin tehingu puhul, mis esitab $9,934,563$ tõlgendust, oleks entroopia:

$$
\begin{align*}
C &= 9,934,563 \\
E &= \log_2(9,934,563) \\
E &= 23.244 \text{ bitti}
\end{align*}
$$

Võtame veel ühe näite standardse maksetehinguga, millel on 1 sisend ja 2 väljundit: [1b1b0c3f0883a99f1161c64da19471841ed12a1f78e77fab128c69a5f578ccce](https://mempool.space/tx/1b1b0c3f0883a99f1161c64da19471841ed12a1f78e77fab128c69a5f578ccce)

![BTC204](assets/notext/56/04.webp)

Selle tehingu puhul on ainus võimalik tõlgendus: `(In.0) > (Out.0 ; Out.1)`. Seega on selle entroopia määratud $0$ peale:

$$
\begin{align*}
$$
E_D &= 1.453 \text{ bitti}
\end{align*}
$$

### Efektiivsus

Tehingu entroopia põhjal saame arvutada ka selle efektiivsust privaatsuse mõttes. See näitaja hindab tehingu efektiivsust, võrreldes seda optimaalse tehinguga, mis on kujuteldav identse konfiguratsiooniga.

See viib meid maksimaalse entroopia kontseptsiooni aruteluni, mis vastab spetsiifilise tehingustruktuuri teoreetiliselt saavutatavale kõrgeimale entroopiale. Tehingu efektiivsus arvutatakse seejärel, võrreldes seda maksimaalset entroopiat analüüsitud tehingu tegeliku entroopiaga.

Kasutatav valem on järgmine:
- $E_R$: tehingu tegelik entroopia, väljendatuna bittides;
- $E_M$: tehingustruktuuri maksimaalselt võimalik entroopia, samuti väljendatuna bittides;
- $Ef$: tehingu efektiivsus bittides:

$$
Ef = E_R - E_M
$$

Näiteks Whirlpool 5x5 tüüpi coinjoin struktuuri puhul on maksimaalne entroopia $10.5469$:

$$
\begin{align*}
E_R &= 10.5469 \\
E_M &= 10.5469 \\
Ef &= E_R - E_M \\
Ef &= 10.5469 - 10.5469 \\
Ef &= 0 \text{ bitti}
\end{align*}
$$

See näitaja väljendatakse ka protsentides. Kasutatav valem on järgmine:
- $C_R$: võimalike tegelike tõlgenduste arv;
- $C_M$: maksimaalne võimalike tõlgenduste arv sama struktuuriga;
- $Ef$: efektiivsus väljendatuna protsentides:

$$
\begin{align*}
E_f &= \frac{C_R}{C_M} \\
E_f &= \frac{1\,496}{1\,496} \\
E_f &= 100\%
\end{align*}
$$

Seega näitab 100%-line efektiivsus, et tehing maksimeerib oma privaatsuse potentsiaali oma struktuuri põhjal.

### Entroopia Tihedus

Entroopia on hea näitaja tehingu privaatsuse mõõtmiseks, kuid see sõltub osaliselt tehingus osalevate sisendite ja väljundite arvust. Erinevate tehingute entroopia võrdlemiseks, mis ei oma sama arvu sisendeid ja väljundeid, saab arvutada entroopia tiheduse. See näitaja pakub perspektiivi entroopia suhtest iga tehingus osaleva sisendi või väljundi kohta. Tihedus osutub kasulikuks erineva suurusega tehingute efektiivsuse hindamiseks ja võrdlemiseks.

Selle arvutamiseks jagage lihtsalt tehingu koguentroopia tehingus osalevate sisendite ja väljundite koguarvuga:
- $E_D$: entroopia tihedus, väljendatuna bittides;
- $E$: tehingu entroopia, väljendatuna bittides;
- $T$: tehingus osalevate sisendite ja väljundite koguarv:

$$
E_D = \frac{E}{T}
$$

Võtame näiteks Whirlpool 5x5 coinjoini:

$$
\begin{align*}
T &= 5 + 5 = 10 \\
E &= 10.5469 \\
E_D &= \frac{E}{T} \\
E_D &= \frac{10.5469}{10} \\
E_D &= 1.054 \text{ bitti}
\end{align*}
$$

Arvutame ka Whirlpool 8x8 coinjoini entroopia tiheduse:

$$
\begin{align*}
T &= 8 + 8 = 16 \\
E &= 23.244 \\
E_D &= \frac{E}{T} \\
E_D &= \frac{23.244}{16} \\
E_D &= 1.453 \text{ bitti}
\end{align*}
$$
$$
E_D &= 1.453 \text{ biti}\end{align*}
$$

Analüüsides nende kahe tüüpi coinjoinide entroopiatihedust, saab ilmseks, et isegi entroopia normaliseerimisel elementide arvu järgi, genereerib "Surge Cycle 8x8" coinjoin analüüsi jaoks rohkem ebakindlust.

### Boltzmanni skoor
Teine tehingu analüüsimisel vaadeldav teave on iga elemendi Boltzmanni skoor suhtes teise elemendiga. See on sisendite ja väljundite vaheliste vastavustõenäosuste tabel. See tabel näitab Boltzmanni skoori kaudu tingimuslikku tõenäosust, et kindel sisend on seotud antud väljundiga. Seega on see tingimusliku tõenäosuse kvantitatiivne mõõt, et sisendi ja väljundi vahel tehingus esineb seos, mis on rajatud selle sündmuse soodsate esinemiste arvu suhtele võrreldes kõigi võimalike esinemiste koguarvuga, interpretatsioonide hulgas.
Võttes näiteks Whirlpooli coinjoini, tooks tingimuslike tõenäosuste tabel esile iga sisendi ja väljundi vahelise seose tõenäosused, pakkudes tehingu seoste ebamäärasuse kvantitatiivset mõõtu:

| %       | Väljund 0 | Väljund 1 | Väljund 2 | Väljund 3 | Väljund 4 |
| ------- | --------- | --------- | --------- | --------- | --------- |
| Sisend 0 | 34%       | 34%       | 34%       | 34%       | 34%       |
| Sisend 1 | 34%       | 34%       | 34%       | 34%       | 34%       |
| Sisend 2 | 34%       | 34%       | 34%       | 34%       | 34%       |
| Sisend 3 | 34%       | 34%       | 34%       | 34%       | 34%       |
| Sisend 4 | 34%       | 34%       | 34%       | 34%       | 34%       |

Siin on selge, et igal sisendil on võrdne võimalus olla seotud mis tahes väljundiga, mis suurendab tehingu konfidentsiaalsust.

Boltzmanni skoori arvutamine hõlmab teatud sündmuse ilmnemiste arvu jagamist saadaolevate interpretatsioonide koguarvuga. Seega, et määrata skoor, mis seob sisendi #0 väljundiga #3 (sündmus, mis esineb $512$ interpretatsioonis), on protsess järgmine:

$$
\begin{align*}
\text{Interpretatsioonid (IN.0 > OUT.3)} &= 512 \\
\text{Koguinterpretatsioonid} &= 1496 \\
\text{Skoor} &= \frac{512}{1496} \\
\text{Skoor} &= 34 \%
\end{align*}
$$

Kui me vaatame uuesti näidet Whirlpooli coinjoinist 8x8 Surge Cycle, näeks Boltzmanni tabel välja selline:

|       | VÄL.0 | VÄL.1 | VÄL.2 | VÄL.3 | VÄL.4 | VÄL.5 | VÄL.6 | VÄL.7 |
|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| SIS.0 | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |
| IN.1  | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |
| IN.2  | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |
| IN.3  | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |
| IN.4  | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |
| IN.5  | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |
| IN.6  | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |
| IN.7  | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   | 23%   |

Siiski, lihtsa tehingu puhul, mis hõlmab ühte sisendit ja kahte väljundit, on olukord erinev:

| %       | Väljund 0 | Väljund 1 |
|---------|-----------|-----------|
| Sisend 0 | 100%      | 100%      |

Siin märkame, et tõenäosus iga väljundi puhul, et see pärineb sisendist #0, on 100%. Madalam tõenäosus tähendab suuremat privaatsust, lahjendades otseseid seoseid sisendite ja väljundite vahel.

### Deterministlikud Seosed

Samuti on võimalik arvutada tehingus deterministlike seoste arvu. See näitaja paljastab, mitu sisendite ja väljundite vahelist ühendust analüüsitavas tehingus on vaieldamatud, tõenäosusega 100%. Seda näitajat saab täiendada deterministlike seoste suhte arvutamisega. Suhe annab perspektiivi nende deterministlike seoste kaalust kõikide tehinguseoste seas.

Näiteks Whirlpool-tüüpi coinjoin tehing näitab sisendite ja väljundite vahel null deterministlikku seost, kuvades seega 0 seoste näitajat ja suhet 0%. Seevastu meie teises vaadeldud lihtsas maksetehingus (ühe sisendi ja kahe väljundiga) ütleb näitaja meile, et on 2 deterministlikku seost ja suhe jõuab 100%-ni. Seega nullnäitaja signaliseerib suurepärast privaatsust tänu otsese ja vaieldamatu seose puudumisele sisendite ja väljundite vahel.

### Kuidas neid näitajaid arvutada?
Nende näitajate käsitsi arvutamine esitatud võrrandite abil on suhteliselt lihtne. Peamine raskus seisneb tehingu võimalike tõlgenduste arvu määramises. Standardse tehingu puhul saab seda arvutust teha käsitsi. Kuid coinjoin'i puhul on ülesanne märkimisväärselt keerulisem.

Varem oli olemas Pythoni tööriist nimega _Boltzmanni kalkulaator_, mille arendasid OXT ja Samourai meeskonnad, mis võimaldas automaatselt arvutada kõiki neid näitajaid Bitcoin'i tehingu jaoks:

![BTC204](assets/notext/56/05.webp)

Samuti oli võimalik kasutada veebisaiti KYCP.org nende analüüside jaoks:

![BTC204](assets/notext/56/06.webp)
Kahjuks, pärast Samourai asutajate arreteerimist, ei ole need tööriistad hetkel töökorras.
Nüüd, kui oleme coinjoin'e üksikasjalikult arutanud, uurime meie koolituse viimases osas teisi Bitcoinil saadaolevaid privaatsustehnikaid. Vaatleme payjoin tehinguid, spetsiifilisi tehingutüüpe pseudo-coinjoin'e, staatilise aadressi protokolle, samuti meetmeid, mis on suunatud privaatsuse tõstmisele mitte tehingutasandil, vaid sõlmede võrgu tasandil.

https://planb.network/tutorials/privacy/boltzmann-entropy

# Teiste edasijõudnud privaatsustehnikate panuse mõistmine
<partId>19989ae6-d608-4acf-b698-2cf1e7e5e6ae</partId>

## Payjoin tehingud
<chapterId>c1e90b95-f709-4574-837b-2ec26b11286f</chapterId>

Coinjoin esindab praegu kõige tõhusamat meetodit ebakindluse lisamiseks müntide jälgimisse ahelanalüüsi käigus. Nagu oleme eelmistes peatükkides näinud, on tõhusaks segamiseks vajalik, et sisendid ja väljundid oleksid võimalikult homogeensed. Lisaks on oluline, et münte integreeritaks võimalikult suurde gruppi, et maksimeerida anonüümsete komplektide suurust. Seega, et coinjoin'id oleksid tõhusad, peavad need hõlmama suurt hulka ühtlasi münte. See mitmekordsete nõuete kogum tähendab, et coinjoin tehingutel on väga jäik struktuur: summad on ette määratud ja kõik osalejad peavad neist kinni pidama, et tagada protsessi ühtlus. Lisaks nõuavad coinjoin'id kõigi osalejate ja koordinaatori vahelist sünkroniseerimist tehingu koostamise ajal.
Need nõuded muudavad coinjoin'i otsemakseteks sobimatuks. Näiteks, kui omate 1M satsi tükki coinjoin basseinis, selle otse maksmiseks kasutamine oleks keeruline. See nõuaks sünkroniseerimist teiste osalejatega ja koordinaatoriga, et koostada koostöötehing täpselt sel hetkel, kui peate maksma, ja ostusumma peaks täpselt vastama teie tüki väärtusele, mis on praktiliselt saavutamatu. Seega on coinjoin tehing oma olemuselt pühkiv koostöötehing, mis tähendab, et tavaliselt on sisendite omanikud samad, kes leitakse väljundites.
Siiski oleks huvitav omada tehingustruktuure, mis võimaldaksid praktilisi makseid, samal ajal ahelanalüüsis kahtlust tekitades. Just seda me käesolevas peatükis ja järgmises uurime.

### Mis on payjoin tehing?

Payjoin on spetsiifiline Bitcoin tehingustruktuur, mis suurendab kasutaja privaatsust kulutamise ajal, tehes koostööd makse saajaga.

LaurentMT mainis seda meetodit esmakordselt 2015. aastal nime all "*steganograafilised tehingud*", vastavalt dokumendile, mis on kättesaadav [siin](https://gist.githubusercontent.com/LaurentMT/e758767ca4038ac40aaf/raw/c8125f6a3c3d0e90246dc96d3b603690ab6f1dcc/gistfile1.txt). Hiljem võttis selle tehnikat kasutusele Samourai Wallet, mis 2018. aastal oli esimene klient, kes selle Stowaway tööriistaga rakendas. Payjoin'i kontseptsiooni leidub ka [BIP79](https://github.com/bitcoin/bips/blob/master/bip-0079.mediawiki) ja [BIP78](https://github.com/bitcoin/bips/blob/master/bip-0078.mediawiki) dokumentides. Seega kasutatakse payjoin'i tähistamiseks mitmeid termineid:
- Payjoin;
- Stowaway;
- P2EP (*Pay-to-End-Point*);
- Steganograafiline tehing.
Payjoin'i eripära seisneb selles, et see suudab genereerida tehingu, mis esmapilgul tundub tavaline, kuid tegelikkuses on see mini Coinjoin kahe inimese vahel. Selleks kaasab tehingu struktuur makse saaja sisenditesse koos tegeliku saatjaga. Saaja lisab seega tehingu keskele endale makse, mis võimaldab neil saada tasutud.
Vaatame näidet, et seda protsessi paremini mõista. Alice ostab baguette'i 4,000 satsi eest, kasutades UTXO-d, mille väärtus on 10,000 satsi, ja valib payjoin'i. Tema pagar, Bob, lisab sisendisse endale kuuluva 15,000 satsi suuruse UTXO, mille ta saab väljundis täielikult tagasi, lisaks Alice'i 4,000 satsile.

![BTC204](assets/notext/61/01.webp)
Selles näites sisestab pagar Bob 15,000 satsi ja väljub 19,000 satsiga, erinevus on täpselt 4,000 satsi, mis on baguette'i hind. Alice'i poolel siseneb ta 10,000 satsiga ja lõpetab väljundis 6,000 satsiga, mis kujutab endast -4,000 satsi bilanssi, nimelt baguette'i hinda. Näite lihtsustamiseks olen tahtlikult jätnud selle tehingu kaevandamistasud arvestamata.

### Mis on payjoin'i eesmärk?

Payjoin tehing täidab kahte eesmärki, mis võimaldavad kasutajatel parandada oma makse privaatsust.

Esiteks, payjoin eesmärk on eksitada väliseid vaatlejaid, luues ahela analüüsis petukauba. See on võimalik tänu CIOH heuristikale (*Common Input Ownership Heuristic*). Nagu me osas 3 nägime, eeldatakse tavaliselt, et kui blockchainis on tehingul mitu sisendit, kuuluvad kõik need sisendid samale üksusele või kasutajale.

Seega, kui analüütik uurib payjoin tehingut, viib see neid uskuma, et kõik sisendid pärinevad samalt isikult. Siiski on see taju vale, kuna makse saaja panustab samuti sisenditesse koos tegeliku maksjaga. Ahela analüüs suunatakse seega tõlgendusele, mis osutub valeks.

Tagasi meie näite juurde payjoin tehingust baguette'i maksmiseks:

![BTC204](assets/notext/61/02.webp)

Seda tehingut blockchainis nähes tõlgendaks välisvaatleja, kes järgib tavalisi ahela analüüsi heuristikaid, seda järgmiselt: "*Alice ühendas 2 UTXO-d sisendites, et maksta 19,000 satsi Bobile*".

![BTC204](assets/en/61/03.webp)

See tõlgendus on ilmselgelt vale, nagu te juba teate, ei kuulu kaks sisendis olevat UTXO-d samale isikule. Üks pärineb Alicelt, baguette'i ostjalt, ja teine Bobilt, pagarilt.

![BTC204](assets/notext/61/04.webp)

Välisvaatleja analüüs suunatakse seega valele järeldusele, mis tagab osapoolte konfidentsiaalsuse säilimise.

### Steganograafiline tehing

Payjoin'i teine eesmärk on eksitada välisvaatlejat tegeliku makse summa osas, mis tehti. Tehingu struktuuri uurides võib analüütik arvata, et makse on võrdne ühe väljundi summaga.
Kui me vaatame uuesti meie näidet baguette'i ostmisest, siis analüütik arvab, et makse summa vastab kas 6,000 satsi suurusele UTXO-le või 19,000 satsi suurusele UTXO-le. Sel juhul arvab analüütik tõenäolisemalt, et makse summa on 19,000 satsi, kuna väljundites on 2 UTXO-d, millest vähemalt üks on suurem kui 6,000 satsi (pole loogilist põhjust kasutada 6,000 satsi maksmiseks 2 UTXO-d, kui üksainus UTXO oleks selle makse jaoks piisanud).![BTC204](assets/en/61/05.webp)

Kuid tegelikkuses on see analüüs vale. Makse summa ei vasta ühelegi väljunditest. See on tegelikult saaja UTXO erinevus väljundis ja saaja UTXO sisendis.

![BTC204](assets/en/61/06.webp)

Sel juhul langeb payjoin tehing steganograafia valdkonda. See võimaldab peita tegeliku tehingu summa võlts tehingu sisse, mis toimib pettena.

Steganograafia on tehnika, mis võimaldab peita informatsiooni teiste andmete või objektide sisse nii, et peidetud informatsiooni olemasolu ei ole tajutav. Näiteks võib salajase sõnumi peita teksti punkti sisse, mis ei ole seotud, muutes selle palja silmaga tuvastamatuks (see on [micropoint](https://fr.wikipedia.org/wiki/Micropoint) tehnika).

Erinevalt krüpteerimisest, mis muudab informatsiooni ilma dekrüpteerimisvõtmeta mõistetamatuks, ei muuda steganograafia informatsiooni. See jääb nähtavale. Selle eesmärk on pigem peita salasõnumi olemasolu, samas kui krüpteerimine selgelt paljastab peidetud informatsiooni olemasolu, kuigi see on ilma võtmeta kättesaamatu. Seetõttu oli payjoini algne nimetus "*steganograafilised tehingud*".

Analoogia võib teha krüptograafia ja coinjoini vahel, samuti steganograafia ja payjoini vahel. Tõepoolest, coinjoinil on omadused, mis on sarnased krüpteerimise omadustega: meetod on äratuntav, kuid informatsioon on mõistetamatu. Vastupidi, payjoin sarnaneb steganograafiaga: informatsioon on teoreetiliselt kättesaadav, kuid kuna selle peitmise meetod ei ole äratuntav, muutub see kättesaamatuks.

### Kuidas kasutada payjoini?

Tuntud tarkvaradest, mis toetavad payjoini, on Sparrow Wallet, Wasabi Wallet, Mutiny, BitMask, BlueWallet ja JoinMarket, samuti maksetöötleja BTCPay.

![BTC204](assets/notext/61/07.webp)
Kõige arenenum payjoini rakendus oli ainult Stowaway Samourai Walletis. Kuid pärast tarkvara asutajate arreteerimist töötab see tööriist nüüd ainult osaliselt. Stowaway eeliseks on, et see on täielik ja väga lihtsasti kasutatav protokoll, mis toetab nii payjoinide vastuvõtmist kui ka saatmist. Osaliselt allkirjastatud tehinguid saab käsitsi vahetada mitme QR-koodi skaneerimise teel või automaatselt Tori kaudu Sorobani abil. Just see viimane suhtlusvõimalus on praegu teenusest väljas.
![BTC204](assets/notext/61/08.webp)

Payjoini kasutamise raskus seisneb selle sõltuvuses kaupmehe osalusest. Kliendina on payjoini kasutamine võimatu, kui kaupmees seda ei toeta. See lisab ostu ajal täiendava raskuse: mitte ainult ei ole keeruline leida bitcoini aktsepteerivaid kaupmehi, vaid kui otsida ka neid, kes toetavad payjoine, muutub see veelgi keerulisemaks.
Lahendus võiks olla kasutada tehingustruktuure, mis tutvustavad ahela analüüsis ebamäärasust ilma, et oleks vaja saaja koostööd. See võimaldaks meil parandada oma maksete privaatsust ilma, et peaksime sõltuma kaupmeeste aktiivsest osalusest. Just seda me järgmises peatükis uurime.
https://planb.network/tutorials/privacy/payjoin-sparrow-wallet

https://planb.network/tutorials/privacy/payjoin-samourai-wallet

## Maksete Mini-Coinjoins
<chapterId>300777ee-30ae-43d7-ab00-479dac3522c1</chapterId>

Kui soovite teha maksetehingu, säilitades teatud privaatsuse astme, on payjoin hea valik. Kuid nagu oleme näinud, nõuab payjoin saaja osalust. Mida teha siis, kui viimane keeldub osalemast payjoin'is või kui eelistate lihtsalt neid mitte kaasata? Alternatiiviks on kasutada Stonewall või Stonewall x2 tehingut. Vaatame neid kahte tüüpi tehinguid lähemalt.

### Stonewall Tehing

Stonewall on spetsiifiline Bitcoin'i tehingu vorm, mille eesmärk on suurendada kasutaja privaatsust kulutamise ajal, jäljendades pseudo-coinjoin'i kahe inimese vahel, ilma et see tegelikult oleks. Tõepoolest, see tehing ei ole koostööpõhine. Kasutaja saab selle ise konstrueerida, kasutades sisenditena ainult enda omanduses olevaid UTXO-sid. Seega võite luua Stonewall tehingu igaks juhuks, ilma et oleks vaja sünkroniseerida teise kasutaja või saajaga.

Stonewall tehingu toimimine on järgmine: tehingu sisendis kasutab saatja 2 UTXO-d, mis kuuluvad neile. Väljundis toodab tehing 4 UTXO-d, millest 2 on täpselt sama summa. Ülejäänud 2 UTXO-d moodustavad vahetusraha. Kahest sama summa väljundist läheb tegelikult ainult üks makse saajale.
Stonewall tehingus on ainult 2 rolli:
- Saatja, kes teeb makse;
- Saaja, kes võib olla tehingu spetsiifilisest olemusest teadmata ja lihtsalt ootab saatjalt makset.

Võtame näiteks, et mõista seda tehingustruktuuri. Alice on Bobi pagaripoes, et osta oma baguette, mis maksab 4,000 satsi. Ta soovib maksta bitcoinides, säilitades teatud privaatsuse taseme oma makse suhtes. Seetõttu otsustab ta konstrueerida makse jaoks Stonewall tehingu.

![BTC204](assets/notext/62/01.webp)

Seda tehingut analüüsides näeme, et Bob pagar sai tõepoolest 4,000 satsi makse baguette eest. Alice kasutas sisenditena 2 UTXO-d: ühte 10,000 satsi ja teist 15,000 satsi. Väljundites sai ta 3 UTXO-d: ühe 4,000 satsi, ühe 6,000 satsi ja ühe 11,000 satsi. Alice'il on sellel tehingul netosaldo -4,000 satsi, mis vastab täpselt baguette hinnale.

Selles näites jätsin tahtlikult kaevandamistasud arvestamata, et hõlbustada mõistmist. Tegelikkuses kannab tehingutasud täielikult saatja.

### Mis on Stonewall tehingu eesmärgid?
Stonewall struktuur lisab tehingule palju entroopiat ja hägustab ahelanalüüsi jälgi. Välisvaatleja jaoks võib sellist tehingut tõlgendada kui mini-coinjoin'i kahe inimese vahel. Kuid tegelikkuses on see makse. See meetod tekitab seega ahelanalüüsis ebakindlust või isegi viib valedele jälgedele.
Tagasi minnes Alice'i näite juurde Bobi pagaritöökojas. Blockchainis näeks tehing välja selline:

![BTC204](assets/notext/62/02.webp)

Väline vaatleja, kes tugineb tavalistele ahelanalüüsi heuristikatele, võib valesti järeldada, et "*kaks inimest on teinud väikese coinjoin'i, igaüks ühe UTXO-ga sisendis ja kaks UTXO-d igaüks väljundis*". Selle tehingu analüüs väljastpoolt ei vii Common Input Ownership Heuristic (CIOH) rakendamiseni, kuna kahe sama suurusega väljundi olemasolu viitab coinjoin'i mustrile. Välisest vaatepunktist ei ole CIOH seega selles konkreetses juhtumis kohaldatav.

![BTC204](assets/notext/62/03.webp)

See tõlgendus on ebatäpne, sest nagu te teate, saadeti üks UTXO Bobile pagarile, 2 UTXO-d sisendis tulid Alicelt ja ta sai tagasi 3 muudatusväljundit.

![BTC204](assets/notext/62/04.webp)
Ja eriti huvitav Stonewall tehingu struktuuri juures on see, et välisvaatleja perspektiivist näeb see välja täpselt nagu Stonewall x2 tehing.

### Stonewall x2 Tehing

Stonewall x2 on teine spetsiifiline Bitcoin'i tehingu vorm, mis samuti eesmärgib kasutaja privaatsuse suurendamist kulutamise ajal, kuid seekord kolmanda osapoole kaasamisega, kes ei osale kulutamises. See meetod toimib nagu pseudo-coinjoin kahe osaleja vahel, samal ajal tehes makse kolmandale isikule.

Stonewall x2 tehingu toimimine on suhteliselt lihtne: kasutatakse ühte oma valduses olevat UTXO-d makse tegemiseks ja palutakse abi kolmandalt osapoolelt, kes samuti panustab oma valduses oleva UTXO-ga. Tehing lõppeb nelja väljundiga: kaks neist võrdsetes summas, üks makse saaja aadressile, teine kaasosalisele kuuluvasse aadressile. Kolmas UTXO saadetakse tagasi teisele kaasosalise aadressile, võimaldades neil algsumma tagasi saada (neile neutraalne tegevus, miinus kaevandamistasud), ja viimane UTXO naaseb meie aadressile, mis kujutab endast makse muudatust.

Seega on Stonewall x2 tehingutes määratletud kolm erinevat rolli:
- Saatja, kes teeb tegeliku makse;
- Saaja, kes võib olla tehingu spetsiifilisest olemusest teadmata ja lihtsalt ootab saatjalt makset;
- Kaasosaline, kes pakub bitcoine, et tekitada tehingu analüüsis kahtlust, samal ajal täielikult oma vahendid lõpus tagasi saades (neile neutraalne tegevus, miinus kaevandamistasud).

Tagasi minnes meie näite juurde Alicega, kes on Bobi pagaritöökojas, et osta oma baguette, mis maksab 4000 satsi. Ta soovib maksta bitcoinides, säilitades samal ajal teatud privaatsuse taseme oma makse suhtes. Seega kutsub ta appi oma sõbra Charles'i, kes aitab teda selles protsessis.

![BTC204](assets/notext/62/05.webp)
Seda tehingut analüüsides võime näha, et pagar Bob on tõepoolest saanud 4,000 satsi makseks bageti eest. Alice kasutas sisendina 10,000 satsi ja sai tagasi 6,000 satsi väljundina, mis tulemuseks on netosaldo -4,000 satsi, mis vastab bageti hinnale. Mis puutub Charles'i, siis ta pakkus sisendina 15,000 satsi ja sai kaks väljundit: ühe 4,000 satsi ja teise 11,000 satsi, tehes saldo 0.

Selles näites jätsin ma tahtlikult tasud arvestamata, et hõlbustada mõistmist. Tegelikkuses jagatakse kaevandamistasud üldiselt võrdselt makse väljastaja ja koostööpartneri vahel.

### Mis on Stonewall x2 tehingu eesmärgid?
Nagu Stonewall struktuur, lisab ka Stonewall x2 struktuur tehingule olulise hulga entroopiat ja varjab ahela analüüsi jälgi. Välisvaatleja seisukohast võib sellist tehingut tõlgendada kui väikest coinjoin'i kahe inimese vahel. Kuid tegelikkuses on see makse. See meetod tekitab seega ahela analüüsis ebakindlust, isegi viies valedele jälgedele.

Vaadelgem uuesti Alice'i, pagar Bobi ja Charles'i näidet. Tehing plokiahelas näeks välja selline:

![BTC204](assets/notext/62/06.webp)

Väline vaatleja, kes tugineb tavalistele ahela analüüsi heuristikatele, võib ekslikult järeldada, et "*Alice ja Charles on teinud väikese coinjoin'i, kus mõlemal on sisendis üks UTXO ja väljundis kaks UTXO'd*". Jällegi ei vii selle tehingu analüüs väljastpoolt Common Input Ownership Heuristic (CIOH) rakendamiseni, kuna kahe sama summa väljundi olemasolu viitab coinjoin'i mustrile. Välisvaatleja seisukohast ei ole CIOH seega selles konkreetses juhtumis kohaldatav.

![BTC204](assets/notext/62/07.webp)

See tõlgendus on ebatäpne, sest nagu te teate, saadeti üks UTXO pagar Bobile, Alice'il on ainult üks vahetusväljund ja Charles'il on kaks.

![BTC204](assets/notext/62/08.webp)

Ja jällegi, mis on eriti huvitav Stonewall x2 tehingu struktuuriga, on see, et välisvaatleja seisukohast näeb see välja täpselt nagu Stonewall tehing.

### Mis vahe on Stonewallil ja Stonewall x2-l?

StonewallX2 tehing toimib täpselt nagu Stonewall tehing, välja arvatud see, et esimene on koostööalane, samas kui viimane ei ole. Nagu oleme näinud, hõlmab Stonewall x2 tehing kolmanda osapoole (Charles) osalemist, kes on maksest väljaspool ja kes pakub oma bitcoine, et suurendada tehingu konfidentsiaalsust. Klassikalises Stonewall tehingus võtab koostööpartneri rolli saatja.

![BTC204](assets/notext/62/09.webp)

Välisvaatleja seisukohast on tehingu muster seega täpselt sama.

![BTC204](assets/notext/62/10.webp)

Asjaolu, et need kaks tehingustruktuuri jagavad täpselt sama mustrit, tähendab, et isegi kui väline vaatleja suudab tuvastada "Stonewall(x2)" mustri, ei oma nad kogu teavet. Nad ei suuda kindlaks teha, kumb kahest sama summa UTXO-st vastab maksele. Pealegi ei suuda nad kindlaks teha, kas kaks UTXO-d sisendis pärinevad kahest erinevast inimesest (Stonewall x2) või kuuluvad need ühele inimesele, kes on need ühendanud (Stonewall).
Viimane punkt tuleneb asjaolust, et Stonewall x2 tehingud järgivad täpselt sama mustrit kui Stonewall tehingud. Väljastpoolt vaadates ja ilma lisainformatsioonita konteksti kohta on võimatu eristada Stonewall tehingut Stonewall x2 tehingust. Siiski, esimesed ei ole koostöö tehingud, samas kui viimased on. See lisab veelgi kahtlust ühe sellise tehingu analüüsimisel.

### Millal kasutada Stonewall ja Stonewall x2 tehinguid?

Loogika peaks olema järgmine, kui soovitakse kasutada privaatsustööriista tehingu jaoks:
- Eelistusena võib valida payjoin'i tegemise;
- Kui kaupmees ei toeta payjoin'e, võib teha koostöö tehingu teise isikuga väljaspool makset, kasutades Stonewall x2 struktuuri;
- Kui ei leita kedagi, kes teeks Stonewall x2 tehingu, võib üksi teha Stonewall tehingu, mis jäljendab Stonewall x2 tehingu käitumist.

### Kuidas kasutada Stonewall ja Stonewall x2 tehinguid?

Stonewall ja Stonewall x2 tehingud on saadaval nii Samourai Wallet rakenduses kui ka Sparrow Wallet tarkvaras.

![BTC204](assets/notext/62/11.webp)

Siiski, nagu payjoin'ide puhul, pärast Samourai asutajate arreteerimist töötavad Stonewall x2 tehingud nüüd ainult käsitsi vahetatavate PSBT-de kaudu osapoolte vahel. Automaatne vahetus Sorobani kaudu pole kahjuks hetkel saadaval.

Samuti on võimalik seda tüüpi tehingut käsitsi teostada mis tahes Bitcoin'i rahakott tarkvarast.

Järgmises peatükis uurime teist privaatsustehnikat, mis on suhteliselt tundmatu, kuid on väga kasulik lisaks sellele, mida oleme juba uurinud.

https://planb.network/tutorials/privacy/stonewall

https://planb.network/tutorials/privacy/stonewall-x2

## Ricochets

<chapterId>db9a20ac-a149-443d-884b-ea6c03f28499</chapterId>

Bitcoin'i tehingustruktuuride kasutamine, mis lisavad ahela analüüsis ebamäärasust, nagu coinjoin, on eriti kasulik privaatsuse kaitsmiseks. Siiski, nagu me arutasime payjoin'i peatükis, on coinjoin tehingud loomulikult tuvastatavad ahelas. Meenutage analoogiat, mille tegime krüpteerimise ja coinjoin'i vahel: kui keegi krüpteerib faili, ei saa kolmas osapool avastades seda krüpteeritud faili ligi selle sisule, kuid võib selgelt tuvastada, et faili on muudetud selle sisu peitmiseks. Sama kehtib coinjoin'i kohta: kui analüütik uurib coinjoin tehingut, kuigi nad ei saa luua otseseid seoseid sisendite ja väljundite vahel (ja vastupidi), võivad nad siiski ära tunda, et vaadeldav tehing on coinjoin.
Sõltuvalt teie mündi kavandatud kasutusest pärast coinjoin tsüklite läbimist, võib asjaolu, et see on läbinud selle protsessi, olla probleemne. Näiteks, kui plaanite oma münti müüa reguleeritud vahetusplatvormil, kuid see on hiljuti läbinud coinjoin'i, tuvastab platvormi ahela analüüsi tööriist selle fakti. Platvorm võib seejärel keelduda teie UTXO vastuvõtmisest, mis on läbinud coinjoin'i, või isegi nõuda teilt selgitusi, riskiga, et teie konto peatatakse või teie vahendid külmutatakse. Mõnel juhul võib platvorm teatada ka teie käitumisest riigiasutustele (näiteks nõuab TRACFIN seda Digitaalsete Varade Teenusepakkujatelt (PSAN) Prantsusmaal).
![BTC204](assets/notext/63/01.webp)
Selleks, et vältida vajadust tööriista järele, mis suudaks hägustada Bitcoini mündi mineviku jälgi, et taastada teatud vorm fungibility'st, on ricochet'i eesmärk just see.

![BTC204](assets/notext/63/02.webp)

### Mis on ricochet?

Ricochet on tehnika, mis hõlmab mitme fiktiivse tehingu sooritamist iseendale (sweeping), et simuleerida bitcoinide omandiõiguse ülekandmist. See tööriist erineb teistest arutletud tehingustruktuuridest, kuna see ei võimalda tulevikku suunatud anonüümsust, vaid pigem tagasiulatuva anonüümsuse vormi. Tõepoolest, ricochet võimaldab hägustada spetsiifikat, mis võiks ohustada Bitcoini mündi fungibility't mineviku tõttu.

Minevikusündmuse, näiteks coinjoin tsüklite, jälje hägustamiseks sooritab ricochet neli järjestikust tehingut, kus kasutaja kannab vahendid endale erinevatele aadressidele.

![BTC204](assets/en/63/03.webp)

Pärast seda tehingute jada suunab ricochet tööriist lõpuks bitcoini nende lõppsihtkohta, näiteks vahetusplatvormile.

![BTC204](assets/en/63/04.webp)

Eesmärk on luua distantsi, mis mõjutab mündi fungibility't, nagu coinjoin tehing, ja lõplik kulutamise akt, mis võiks selle mündi mineviku tõttu tagasi lükata. Seega võivad ahela analüüsi tööriistad järeldada, et pärast sündmust on tõenäoliselt toimunud omandiõiguse muutus ja pidada seda münti fungible'iks. Coinjoini puhul võivad ahela analüüsi tööriistad siis eeldada, et bitcoine ei saatnud ega teinud coinjoini sama isik, seega pole vaja saatja vastu meetmeid võtta.

![BTC204](assets/notext/63/05.webp)

### Miks see toimib?
Selle ricochet meetodi ees võib ette kujutada, et ahela analüüsi tarkvara süvendaks oma uurimist rohkem kui nelja hüppe taha. Siiski seisavad need platvormid silmitsi dilemmaga tuvastamiskünnise optimeerimisel. Nad peavad kehtestama piiri hüpete arvule, pärast mida nad tunnistavad, et omandiõiguse muutus on tõenäoliselt toimunud ja et seos varasema sündmusega (näiteks coinjoin) tuleks eirata.
![BTC204](assets/en/63/06.webp)

Kuid selle künnise määramine osutub riskantseks: vaadeldavate hüpete arvu iga laiendamine suurendab eksponentsiaalselt valepositiivsete, st isikute, kes on ekslikult märgitud sündmuse osalisteks, kui operatsiooni viis läbi keegi teine, mahtu. See stsenaarium kujutab neile ettevõtetele suurt riski, kuna valepositiivsed tulemused põhjustavad rahulolematust, mis võib mõjutatud kliente konkurentide juurde lükata. Pikas perspektiivis viib liiga lai tuvastamiskünnis platvormi rohkemate klientide kaotamiseni kui tema konkurentidel, mis võib ohustada selle elujõulisust. Seetõttu on nende platvormide jaoks keeruline suurendada vaadeldavate hüpete arvu ja 4 on sageli piisav arv, et nende analüüse tõrjuda.

Siin täheldatud nähtus on teatud määral analoogne kuue eraldusastme teooriaga.

Kuue eraldusastme teooria viitab sellele, et iga inimene Maal on ühendatud ükskõik millise teise inimesega läbi tuttavate ahela, mis ei hõlma rohkem kui kuut vahendajat. Piisaks minna läbi kuue inimese seeria, igaüks isiklikult tundes järgmist, et jõuda ükskõik millise inimeseni maailmas.

Bitcoin'i tehingute puhul leitakse sarnane nähtus. Piisava arvu Bitcoin'i tehingute tagasi jälgimisel jõutakse paratamatult coinjoinini. Ricochet meetod kasutab seda põhimõtet ära, kasutades rohkem hüppeid, kui vahetusplatvormid mõistlikult jälgida suudavad. Kui platvormid otsustavad jälgida rohkem tehinguid, on siis võimalik lihtsalt lisada täiendav hüpe, et see meede ümber nõrgestada.

### Millal ja kuidas kasutada ricochet?
Kõige tavalisem kasutusjuht ricochet'i puhul ilmneb siis, kui on vajalik varjata varasemat osalemist coinjoin'is UTXO puhul, mida ise omate. Ideaalis on parem vältida bitcoinide ülekandmist, mis on läbinud coinjoin'i, reguleeritud asutustele. Siiski, kui leiate end olukorrast, kus muud valikut pole, eriti kiiresti bitcoine fiat-valuutaks muutes, pakub ricochet efektiivset lahendust.
See meetod on efektiivne mitte ainult coinjoin'ide, vaid ka mis tahes muu märgi puhul, mis võiks ohustada mündi fungibilisust.
Ricochet meetodi idee pärineb algselt Samourai Wallet meeskondadelt, kes integreerisid selle oma rakendusse, et automatiseerida protsessi. Teenus on Samourais tasuline, kuna ricochet kaasneb teenustasuga 100 000 satsi, lisaks kaevandamistasud. Seega soovitatakse selle kasutamist pigem oluliste summade ülekandmiseks.

![BTC204](assets/notext/63/07.webp)

Samourai rakendus pakub kahte ricochet varianti:
- Täiustatud ricochet ehk "järjestikune kohaletoimetamine", mille eeliseks on Samourai teenustasude jaotamine viie järjestikuse tehingu vahel. See valik tagab ka, et iga tehing edastatakse erineval ajal ja salvestatakse erinevasse plokki, mis võimaldab võimalikult täpselt jäljendada omandiõiguse muutumist. Kuigi aeglasem, on see meetod eelistatav neile, kes ei kiirusta, kuna see maksimeerib ricochet'i efektiivsust, tugevdades selle vastupanu ahela analüüsile;

![BTC204](assets/notext/63/08.webp)

- Klassikaline ricochet, mis on kavandatud operatsiooni kiireks teostamiseks, edastades kõik tehingud lühikese aja jooksul. See meetod pakub seega vähem privaatsust ja madalamat vastupanu analüüsile kui täiustatud meetod. Seda tuleks kasutada ainult kiireloomuliste saatmiste puhul.

![BTC204](assets/notext/63/09.webp)

Ricochet tähendab lihtsalt bitcoinide saatmist iseendale. Ricochet'i on täiesti võimalik teostada käsitsi mis tahes rahakotitarkvaras, kasutamata spetsialiseeritud tööriista. Lihtsalt kandke sama münt endale järjestikku üle, kasutades iga kord uut tühja aadressi.

Järgmises peatükis uurime erinevaid tehnikaid salajaseks varade ülekandmiseks. Need meetodid erinevad radikaalselt seni uuritutest nii toimimise kui ka tulemuste poolest.

https://planb.network/tutorials/privacy/ricochet
 
## Salajased Varade Ülekanded
<chapterId>a2067036-849c-4d6b-87d2-44235cfae7a1</chapterId>

Bitcoin'i privaatsustehnikate seas on ka salajane varade ülekanne. See meetod eesmärgib üle kanda bitcoinide omandiõigust ühelt isikult teisele ja vastupidi, ilma et see tehing oleks plokiahelas eksplitsiitselt nähtav. Uurime koos erinevaid saadaolevaid tehnikaid ning nende eeliseid ja puudusi.

### CoinSwap

CoinSwap põhineb suhteliselt lihtsal kontseptsioonil: see kasutab nutilepinguid, et hõlbustada bitcoinide omandiõiguse ülekandmist kahe kasutaja vahel, ilma usaldusvajaduseta ja ilma, et see ülekanne oleks plokiahelas eksplitsiitselt nähtav.

![BTC204](assets/notext/64/01.webp)
Kujutagem ette lihtsustatud näidet Alice'i ja Bobiga. Alice omab 1 BTC, mis on turvatud privaatvõtmega $A$, ja Bob omab samuti 1, mis on turvatud privaatvõtmega $B$. Teoreetiliselt võiksid nad oma privaatvõtmeid vahetada mõne välise suhtluskanali kaudu, et teostada salajane ülekanne.
![BTC204](assets/notext/64/02.webp)
Siiski, see naiivne meetod esitab suure riski usalduse osas. Midagi ei takista Alicel hoidmast privaatvõtme $A$ koopiat pärast vahetust ja selle hilisemat kasutamist bitcoinide varastamiseks, kui võti on Bobi valduses.
![BTC204](assets/notext/64/03.webp)

Lisaks ei ole mingit garantiid, mis takistaks Alicel saamast Bobi privaatvõtit $B$ ja mitte kunagi saatmast oma privaatvõtit $A$ vastutasuks. Seega põhineb see vahetus liigsel usaldusel osapoolte vahel ja osutub ebatõhusaks turvalise omandiülekande tagamisel.

![BTC204](assets/notext/64/04.webp)

Nende probleemide lahendamiseks ja vahetuste võimaldamiseks osapoolte vahel, kes ei usalda teineteist, võime selle asemel kasutada nutilepingute süsteeme. Nutileping on programm, mis täidab automaatselt etteantud tingimustel, mis meie juhul tagab, et omandi üleandmine toimub automaatselt ilma vastastikuse usalduseta.

Selleks võime kasutada HTLC (*Hash Time-Locked Contracts*) või PTLC (*Point Time-Locked Contracts*). Need kaks protokolli toimivad sarnaselt, kasutades ajalukustussüsteemi, mis tagab, et vahetus kas lõpeb edukalt või tühistatakse täielikult, kaitstes seeläbi mõlema osapoole vahendite terviklikkust. Peamine erinevus HTLC-de ja PTLC-de vahel on see, et HTLC-d kasutavad tehingu turvamiseks hashe ja eelkujusid, samas kui PTLC-d kasutavad Adapteri Allkirju.

Müntide vahetamise stsenaariumis, kasutades HTLC-d või PTLC-d Alice'i ja Bobi vahel, toimub vahetus turvaliselt: kas see õnnestub ja igaüks saab teise BTC-d, või see ebaõnnestub ja igaüks säilitab oma BTC-d. Seega on võimatu, et üks osapooltest petaks või varastaks teise BTC-d.

> *HTLC-sid kasutatakse ka maksete turvaliseks suunamiseks Lightning Network'i kahepoolsetes kanalites.*

Adapteri Allkirjade kasutamine on selles kontekstis eriti huvitav, kuna see võimaldab traditsioonilistest skriptidest mööda minna (mõnikord viidatakse sellele mehhanismile kui "_skriptideta skriptid_"). See funktsioon aitab vähendada vahetusega seotud tasusid. Teine suur eelis Adapteri Allkirjade puhul on see, et nende kasutamine ei nõua mõlema tehingu osapoole jaoks ühise hash'i kasutamist, vältides seeläbi otsese seose paljastamist nende vahel teatud tüüpi vahetustes.
### Adapteri Allkirjad

Adapteri Allkirjad on krüptograafiline meetod, mis ühendab kehtiva allkirja lisallkirjaga, mida nimetatakse "_adapteri allkirjaks_", et paljastada saladuslik andmetükk. See mehhanism on kavandatud nii, et teades kahte järgmistest kolmest elemendist: kehtiv allkiri, adapteri allkiri ja saladus, võimaldab järeldada puuduva kolmanda elemendi. Selle meetodi huvitav omadus on see, et kui me teame oma vastaspoole adapteri allkirja ja spetsiifilist punkti elliptilisel kõveral, mis on seotud saladusega, mida kasutati selle adapteri allkirja arvutamiseks, saame tuletada oma adapteri allkirja, mis ühildub sama saladusega, ilma et meil oleks otsene juurdepääs saladusele endale.

Müntide vahetamisel võimaldab Adapteri Allkirjade kasutamine osalejate vahel kahe tundliku teabe samaaegset avalikustamist, vältides seeläbi vajadust vastastikuse usalduse järele. Vaatame näidet selle protsessi illustreerimiseks Alicega ja Bobiga, kes soovivad vahetada 1 BTC omandiõigust, kuid ei usalda teineteist. Nad kasutavad Adapteri Allkirju usalduse vajaduse kõrvaldamiseks selles vahetuses. Siin on, kuidas nad toimivad:
* Alice algatab vahetuse, luues tehingu $m_A$, mis saadab 1 BTC Bobile. Ta genereerib allkirja $s_A$, mis valideerib selle tehingu, kasutades oma privaatvõtit $p_A$ ($P_A = p_A \cdot G$), ühekordset koodi $n_A$ ($N_A = n_A \cdot G$) ja saladust $t$ ($T = t \cdot G$):
$$s_A = n_A + t + H(N_A + T \parallel P_A \parallel m_A) \cdot p_A$$

* Alice arvutab kohandatud allkirja $s_A'$, lahutades oma tõelisest allkirjast $s_A$ saladuse $t$:

$$s_A' = s_A - t$$

* Alice saadab Bobile oma kohandatud allkirja $s'_A$, allkirjastamata tehingu $m_A$, punkti, mis vastab saladusele ($T$), ja punkti, mis vastab ühekordsele koodile ($N_A$). Need elemendid moodustavad nn "*kohandaja*". On oluline märkida, et ainult selle teabe põhjal ei saa Bob Alice'i BTC-d taastada.
* Siiski on Bobil võimalus kontrollida, et Alice ei ürita temalt varastada. Selleks kontrollib ta, kas Alice'i kohandatud allkiri $s_A'$ vastab tegelikult pakutud tehingule $m_A$. Kui järgnev võrrand on õige, võib ta olla kindel, et Alice'i kohandatud allkiri on kehtiv:
$$s_A' \cdot G = N_A + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$

* See kontroll annab Bobile piisavad garantiid, et ta saaks vahetusega kindlalt edasi minna. Seejärel loob ta oma tehingu $m_B$, mille eesmärk on saata 1 BTC Alice'ile, ja genereerib oma kohandatud allkirja $s_B'$, mis on samuti seotud sama saladusega $t$. Sel hetkel teab ainult Alice saladuse $t$ väärtust; Bob teab ainult vastavat punkti $T$, mille Alice on talle edastanud:

$$s_B' = n_B + H(N_B + T \parallel P_B \parallel m_B) \cdot p_B$$

* Bob edastab Alice'ile oma kohandatud allkirja $s_B'$, allkirjastamata tehingu $m_B$, samuti punkti, mis vastab saladusele ($T$) ja punkti, mis vastab ühekordsele koodile ($N_B$). Alice, kes teab saladust $t$, saab nüüd ühendada Bobi kohandatud allkirja $s_B'$ selle saladusega, et genereerida kehtiv allkiri $s_B$ tehingule $m_B$, mis kannab Bobi BTC tema kätte:

$$s_B = s_B' + t$$

$$(s_B' + t) \cdot G = N_B + T + H(N_B + T \parallel P_B \parallel m_B) \cdot P_B$$

* Alice edastab selle allkirjastatud tehingu $m_B$ Bitcoin'i plokiahelasse, et taastada Bobi poolt lubatud BTC. Kui Bob näeb seda tehingut plokiahelas, saab ta ekstraheerida allkirja $s_B = s_B' + t$. Selle teabega on Bobil seejärel võimalik eraldada kuulus saladus $t$, mida ta vajas:

$$t = (s_B' + t) - s_B' = s_B - s_B'$$

* Ja tõepoolest, see saladus $t$ oli ainus puuduv element, mida Bob vajas, et genereerida kehtiv allkiri $s_A$ Alice'i kohandatud allkirjast $s_A'$. See allkiri võimaldab valideerida tehingu $m_A$, mis saadab BTC Alice'ilt Bobile. Bob arvutab seejärel $s_A$ ja omakorda edastab tehingu $m_A$ plokiahelasse: 

$$s_A = s_A' + t$$
$$(s_A' + t) \cdot G = N_A + T + H(N_A + T \parallel P_A \parallel m_A) \cdot P_A$$
Vaadelgem, kuidas kohandaja allkiri mündivahetuses töötab. Alguses saadab Alice Bobile allkirjastamata tehingu koos kohandajaga, mis võimaldab Bobil kontrollida, et hiljem avalikustatud saladus annab talle juurdepääsu bitcoinidele. Vastutasuks saadab Bob Alice'ile oma allkirjastamata tehingu ja oma kohandaja. Alice saab seejärel Bobi tehingu lõpule viia ja bitcoinid taastada, edastades kehtiva tehingu kasutades saladust. Kui see tehing avaldatakse plokiahelas, on Bobil võimalus saladus välja võtta ja seeläbi Alice'i tehingu avada. Seega, kui Alice algatab Bobi bitcoinide ülekande, saab ta omakorda juurdepääsu Alice'i bitcoinidele ilma vastastikuse usalduseta.

On märkimisväärne, et mündivahetused pakuti esmakordselt välja [Gregory Maxwell poolt oktoobris 2013 BitcoinTalkis](https://bitcointalk.org/index.php?topic=321228.0).

### Aatomvahetus

Sarnaselt mündivahetusega ja kasutades samu tüüpi nutilepinguid, on võimalik teostada ka aatomvahetusi. Aatomvahetus võimaldab kahe kasutaja vahel otsest erinevate krüptovaluutade, nagu BTC ja XMR, vahetust ilma usaldust või vahendaja sekkumist nõudmata. Neid vahetusi nimetatakse "aatomilisteks", kuna neil on ainult kaks võimalikku tulemust: kas vahetus on edukas ja mõlemad pooled on rahul või see ebaõnnestub ja igaüks säilitab oma algse krüptovaluuta, kõrvaldades seeläbi vajaduse usaldada teist poolt.

![BTC204](assets/notext/64/05.webp)

Aatomvahetus ja mündivahetus jagavad sarnast toimimisviisi ning pakuvad privaatsuse osas samu eeliseid ja puudusi. Tõepoolest, Bitcoini vaatenurgast on aatomvahetus võrreldav kahe sammuga teostatud mündivahetusega. Esiteks vahetame oma BTC teise krüptovaluuta vastu ja seejärel saab seda krüptovaluutat vahetada teiste BTC-de vastu. Lõpuks taastame teise kasutaja BTC-d. Seetõttu grupeerin privaatsusprobleemide analüüsis need kaks protokolli omandiõiguse salajaste vahetuste kategooriasse.

![BTC204](assets/notext/64/06.webp)

Erinevalt mündivahetusest võib aatomvahetusel olla kättesaadavas likviidsuses tasakaalustamatusi, eriti BTC/XMR vahetustes. Bitcoine on üldiselt lihtsam vahetada altcoinide vastu, kuna bitcoinide järele on suur nõudlus, mis hoiab selle konversiooni suuna preemiad madalad. Kuid altcoinide vahetamine BTC-de saamiseks võib olla keerulisem madalama nõudluse tõttu, mis sageli toob kaasa väga kõrged preemiad.

Lõpuks, kui aatomvahetus hõlmab ahelas olevaid bitcoine ja Lightning võrgus olevaid bitcoine, siis nimetame seda "*submarine swap*".

### Kas see on tõesti kasulik?
Salajased varade ülekanded, nagu mündivahetused ja aatomvahetused, pakuvad eelist petta ahela analüüsi heuristikat. Need meetodid võivad jätta mulje, et tehingud hõlmavad sama kasutajat, kuigi tegelik omandiõigus on vahetunud. Siiski on nende meetodite peamine puudus see, et ilma täiendava tehnikata mündi ajaloo katkestamiseks on need väga riskantsed.

Tõepoolest, kui Alice teostab mündivahetuse või aatomvahetuse Bobiga, vahetab ta oma bitcoinide omandiõiguse Bobi omaga. Aatomvahetuse korral hõlmab vahetus altcoini, kuid põhimõte jääb samaks. Seega lõpetab Alice mündiga $B$ ja Bob mündiga $A$. See lisab ahela analüüsis kahtlust, kuid müntide ajalugu jääb jälgitavaks. Kui analüütik uurib münti $A$, saavad nad jälgida tagasi Alice'i varasemate tegevusteni ja vastupidi münti $B$ puhul.
![BTC204](assets/en/64/07.webp)
Alice'i vaatenurgast on risk see, et mündi $B$ ajalugu võidakse teatud asutuste poolt pidada kahtlaseks. Kui näiteks Bob oli saanud mündi $B$ kuritegeliku tegevuse, nagu häkkimise käigus, jääks see münt seotuks tema ebaseaduslike tegevustega. Alice võiks end leida olukorrast, kus ta ei saaks seda münti reguleeritud vahetusplatvormidel üle kanda ilma riskimata oma vahendite külmutamisega või isegi süüdistatuna Bobi kuritegudes, kuigi tal polnud nendega midagi pistmist.

![BTC204](assets/en/64/08.webp)

Ja muidugi eelistavad kurjategijad, kelle vahendeid jälgivad asutused, privaatsusmeetodeid nagu coinswap või atomic swap. Need protokollid pakuvad neile võimalust vabaneda oma jälgitud bitcoinidest vastutasuks täiesti fungible bitcoinide eest. See võimaldab neil samuti luua diversiooni, suunates asutused teiste kasutajate poole. Seega on neil isikutel kahekordne kasu.

Coinjoiniga, isegi kui teie münt on segatud jälgitud bitcoinidega, katkestatakse mündi ajalugu, mis pakub teatud määral usutavat eitamist, mida salajaste varade ülekandeprotokollide, nagu coinswap või atomic swap, puhul ei eksisteeri.

![BTC204](assets/notext/64/09.webp)
Kui Alice soovib vältida igasugust riski, peab ta tingimata kasutama meetodit mündi $B$ ajaloo katkestamiseks, näiteks läbides selle coinjoinide kaudu. See tõstatab küsimuse salajase omandiõiguse ülekande ja coinjoini kombinatsiooni kasulikkuse kohta. Coinjoin, katkestades mündi ajaloo, pakub juba piisavat privaatsuse taset Alice'i jaoks. Seega, minu arvates, kui Alice soovib kaitsta oma privaatsust, oleks mõistlikum otse coinjoiniga tegeleda, mitte tegeleda coinswapiga, millele järgneb coinjoin.
Salajase omandiõiguse ülekandemeetodite tõeliseks efektiivsuseks ja kasutaja $A$ ajaloo sidumise riski vältimiseks kasutaja $B$-ga oleks paradoksaalselt vajalik, et nende kasutamine oleks laialdaselt teada. Kui coinswapit kasutatakse massiliselt ja asutused on sellest tavalisest praktikast teadlikud, siis võiks luua usutava eitamise vormi. Kuid seni, kuni nende ülekannete kasutamine jääb marginaalseks, usun, et need meetodid jäävad kasutajate jaoks liiga riskantseks.

Seni oleme peamiselt uurinud privaatsusmeetodeid tehingutasandil ise. Järgmises peatükis uurime probleeme võrgutasandil ja tehingute levitamist.

## Privaatsus P2P võrgus
<chapterId>04a2467b-db84-4076-a9ff-919be5135106</chapterId>

4. osas arutasime täisnoodi kasutamise tähtsust oma tehingute privaatsuse kaitsmisel. Siiski on oluline mõista, et teie sõlm ise võib olla rünnakute sihtmärgiks, mis püüavad ekstraheerida teavet teie tegevuste kohta. Selles peatükis uurime seega erinevaid privaatsuskaitse meetmeid, mitte tehingute endi või bitcoinide voo tasandil, vaid võrgutasandil.

### Dandelion

Üks viis erinevate de-anonüümimisrünnakute vältimiseks on kasutada Dandelion ettepanekut. See levitusprotokoll formaliseeriti BIP156-s, kuid seda ei ole kunagi Bitcoinis rakendatud.

Dandelioni idee on parandada tehingute marsruutimise privaatsust Bitcoin võrgus, et vastu seista erinevatele rünnakuvormidele. Selle peamine eesmärk on varjata algset sõlme, mis esialgu levitas tehingut võrgus. Selle sõlme avalikustamine võiks seostada Bitcoin tehingu kindla IP-aadressiga (kui sõlm töötab clearnetis), mis võiks pakkuda sisenemispunkti ahela analüüsiks.
Selle seos tegevuse vahel Bitcoinis ja IP-aadressiga kujutab endast olulist riski kasutaja privaatsusele. Tõepoolest, paljud üksused suudavad hõlpsasti seostada IP-aadressi isikliku identiteediga. See hõlmab märkimisväärselt valitsusi ja Interneti-teenuse pakkujaid. Lisaks võib see teave muutuda avalikult kättesaadavaks, näiteks kui teie IP-aadress ja isikuandmed paljastatakse lekke tõttu veebisaidi andmebaasi häkkimisel. Bitcoin'i tavapärases toimimises edastatakse kasutaja poolt nende rahakotitarkvaras koostatud tehingud nende isiklikule noodile. See noot edastab kohe uue tehingu kõigile ühendatud eakaaslastele.

![BTC204](assets/notext/65/01.webp)

Need eakaaslased seejärel kontrollivad tehingut, et tagada selle vastavus konsensuse reeglitele ja kohalikele standardimisreeglitele. Kui tehing on valideeritud, edastab iga eakaaslane omakorda tehingu oma eakaaslastele ja nii edasi.

![BTC204](assets/notext/65/02.webp)

Tehingute jaotamine, mis ootavad blokki integreerimist, toimub üsna tasakaalustatult ja statistiliselt etteaimataval viisil. Seda haavatavust saavad ära kasutada kokkumängivad spiooninoodid, mis teevad koostööd võrgu jälgimiseks ja analüüsimiseks, et tuvastada esimene noot, mis edastas tehingu. Kui vaatleja suudab asukoha noodi leida, võivad nad eeldada, et tehing pärineb selle noodi operaatorilt. Selline vaatlus võib seostada tehinguid, mis tavaliselt on anonüümsed, konkreetsete IP-aadressidega.

![BTC204](assets/notext/65/03.webp)

BIP156 eesmärk on see probleem lahendada. Selleks tutvustab see uue tehingu levitamisele lisafaasi, et säilitada anonüümsus enne laialdast avalikku levitamist. Dandelion kasutab esmalt "vart" faasi, kus tehing saadetakse läbi juhusliku noodiraja.

![BTC204](assets/notext/65/04.webp)

Seejärel levitatakse tehing kogu võrgus "pahmakas" faasis.

![BTC204](assets/notext/65/05.webp)

Vart ja pahmakat viitavad tehingu leviku käitumisele võrgus, meenutades võilille kuju.

Seega võivad spiooninoodid potentsiaalselt jälitada tehingut tagasi noodi juurde, mis alustas pahmakas faasi (massiline levitamine), kuid see noot pole see, kes esimesena tehingu edastas, kuna see sai selle viimaselt noodilt varres. Kui spiooninoodid ei suuda tagasi varre juurde jälitada, ei saa nad samuti tuvastada lähtenoodi.

![BTC204](assets/notext/65/06.webp)
Isegi spiooninoodide olemasolul varre faasis jääb alati kahtlus, sest niipea, kui nad kohtuvad difusioonigraafikus ausa noodiga, ei suuda spioonid kindlaks teha, kas see noot on algne allikas või lihtsalt vahendaja.
![BTC204](assets/notext/65/07.webp)

See marsruutimismeetod hägustab raja, mis viib lähtenoodini, muutes tehingu jälitamise võrgus tagasi selle alguseni keeruliseks. Dandelion parandab seega privaatsust, piirates vastaste võimet võrgu anonüümsust deanonüümida. See meetod on veelgi tõhusam, kui tehing ületab "varre" faasis noodit, mis krüpteerib oma võrgusuhtlust, nagu Tor või P2P Transport V2.
BIP156 ei ole integreeritud Bitcoin Core'i ja on hetkel klassifitseeritud kui "tagasi lükatud" staatuses. Üks peamisi muresid selle protokolli puhul seisneb selles, et varre faasis peavad tehingud olema edastatud vahendajate sõlmede poolt enne nende kinnitamist. Nagu oleme näinud, Bitcoin'i tavamudelis kontrollib iga sõlm esmalt tehingut enne selle oma eakaaslastele edastamist. Kui tehing ei vasta konsensuse reeglitele või sõlme kohalikele standardiseerimisreeglitele, ignoreerib see seda ja ei edasta. See protsess on oluline DoS-rünnakute vastu võitlemisel, kuna ainult kehtivad tehingud edastatakse kogu võrgule. Kehtetud tehingud, mis on potentsiaalselt genereeritud massiliselt võrgu ülekoormamiseks, peatatakse esimeses kohatud sõlmes ja ei levi edasi. Peamine risk Dandelioniga on see, et see uus protokoll võib tutvustada uusi vektoreid DoS-rünnakuteks, lubades kehtetute tehingute edastamist võrgu osa kaudu.

### P2P Transport V2

P2P Transport V2 on teine võrguprotokoll, mis on esitatud BIP324-s. See on Bitcoin P2P transpordiprotokolli uus versioon, mis sisaldab võimalust kasutada krüpteerimist, et parandada sõlmede vaheliste suhtluste konfidentsiaalsust ja turvalisust.

See täiustus püüab lahendada mitmeid probleeme P2P protokolli baasversiooniga. Ühelt poolt muudab see vahetatavaid andmeid passiivsele vaatlejale internetis liikuvatest muud tüüpi andmetest eristamatuks. Peamine eesmärk on takistada valitsustel, internetiteenuse pakkujatel või VPN-i pakkujatel massiliselt jälgida Bitcoin'i kasutajaid. See muudab ka nende ülesande keerulisemaks, kui on vaja kindlaks teha, kas internetikasutaja on samuti Bitcoin'i kasutaja, st kas nad opereerivad täissõlmega.
P2P V2 aitab samuti vähendada tsensuuri ja rünnakute riske, tuvastades andmepakettides spetsiifilisi mustreid. See muudab erinevat tüüpi Sybil-rünnakute sooritamise võrgutasandil keerulisemaks ja kulukamaks. Sybil-rünnak toimub siis, kui tegutseja loob mitu valeidentiteeti, et saada ebaõiglast eelist. Bitcoin'i võrgu kontekstis ilmneb see sageli nii, et tegutseja kontrollib suurt hulka täissõlmi ja kasutab neid agressiivselt ühenduste korrutamiseks. Sybil-rünnakud võivad olla passiivsed, eesmärgiga koguda teavet ja ohustada kasutaja konfidentsiaalsust, või aktiivsed, Eclipse-rünnakute kujul. Viimased isoleerivad konkreetse sõlme ülejäänud võrgust, võimaldades kasutajat tsenseerida või muuta andmeid, mida nad saavad. Lõpuks muudab P2P V2 ka *Man-In-The-Middle* (MITM) rünnakud kulukamaks ja lihtsamini tuvastatavaks.
P2P V2 poolt rakendatud krüpteerimine ei sisalda autentimist, et mitte lisada tarbetut keerukust ja mitte ohustada võrguühenduse lubamatu olemust. See uus P2P transpordiprotokoll pakub siiski paremat turvalisust passiivsete rünnakute vastu ja muudab aktiivsed rünnakud märkimisväärselt kulukamaks ja tuvastatavamaks. Pseudojuhusliku andmevoogude sisseviimine võrgusõnumitesse muudab ründajate ülesande keerulisemaks, kes soovivad tsenseerida või manipuleerida suhtlust.

P2P V2 transport lisati valikuna (vaikimisi välja lülitatud) Bitcoin Core'i versiooni 26.0, mis juurutati detsembris 2023. Seejärel lubati see vaikimisi versioonis 27.0 aprillis 2024. Seda saab muuta `v2transport=` valikuga konfiguratsioonifailis.

### Tor

Teine suhteliselt lihtne lahendus vältimaks konfidentsiaalsuse kaotuse riske sõlme jaoks võrgutasandil on käitada seda täielikult Tor'i all.
Tor on võrgustik relee serveritest (sõlmedest), mis anonümiseerib TCP ühenduste päritolu internetis. See töötab andmete pakendamisega mitmesse krüpteerimiskihti. Iga relee sõlm eemaldab kihi, et paljastada järgmise sõlme aadress, kuni jõutakse lõppsihtkohta. Tor võrgustik tagab anonüümsuse, takistades vahepealsetel sõlmedel teadmast nii andmete päritolu kui ka sihtkohta, muutes kasutaja tegevuse jälgimise vaatleja jaoks väga keeruliseks.
![BTC204](assets/notext/65/08.webp)
Seega Tor mitte ainult ei krüpteeri suhtlust, vaid võimaldab ka suhtluse päritolu ja sihtkoha maskeerimist. Kasutades Tor'i oma isikliku sõlme suhtluseks, suurendame oma tehingute privaatsust: Interneti-teenuse Pakkuja (ISP) ei saa suhtlust dekrüpteerida ja teised sõlmed Bitcoin'i võrgustikus ei suuda tuvastada lähtesõlme IP-aadressi. Lisaks varjab Tor ka teie Bitcoin'i kasutamist teie ISP eest.

Peamine risk, mis on seotud selle meetodiga, on see, et Tor on protokoll, mis on sõltumatu Bitcoin'ist. Kui teil on Bitcoin'i sõlm Tor'i all ja Tor lakkab töötamast, siis teie Bitcoin'i sõlm ei saa enam suhelda.

Samuti on oluline märkida, et suhtlus Tor'i kaudu on aeglasem. See latentsus on eriti tülikas sõlme esmakordsel käivitamisel, kuna esialgne plokkide allalaadimine (IBD) nõuab palju suhtlust. Selle tulemusena võib teie esialgne sünkroniseerimine Bitcoin'i võrgustikuga kasutades Tor'i olla märkimisväärselt pikem. On ka võimalik teostada IBD avatud võrgus, seejärel aktiveerida Tor hiljem. Kuigi see meetod paljastab teie Bitcoin'i sõlme olemasolu teie ISP-le, kaitseb see teie isiklike tehingutega seotud teavet, kui lülitate Tor'ile.

Erinevate võrgutasandi privaatsusmeetodite uurimise järel tahan ma järgnevates peatükkides tutvustada kahte elegantset lahendust aadresside taaskasutamise vältimiseks: BIP47 ja Silent Payments.

## BIP47 ja Taaskasutatavad Maksekoodid
<chapterId>ad88e076-a04b-4aec-b3b2-7b4760175504</chapterId>

Nagu me osas 3 nägime, kujutab aadresside taaskasutamine tõsist takistust kasutaja privaatsusele Bitcoin'i protokollis. Nende riskide leevendamiseks on tungivalt soovitatud genereerida iga uue makse saamisel rahakotis uus vastuvõtu aadress. Kuigi uue aadressi genereerimine on tänapäeval lihtsustatud tänu kaasaegsele tarkvarale ja hierarhilistele deterministlikele rahakottidele, võib see praktika tunduda vastuoluline.

![BTC204](assets/notext/66/1.webp)

Näiteks traditsioonilises pangandussüsteemis oleme harjunud jagama oma IBAN-i, mis jääb alati samaks. Kord kellegagi jagatuna, saavad nad meile saata mitu makset ilma, et peaksid meiega uuesti suhtlema. Neo-pankad pakuvad kaasaegsemaid võimalusi nagu unikaalsete e-posti aadresside kasutamine PayPal'is või RevTags Revolut'is. Isegi finantsdomeenist väljaspool on meie igapäevased identifikaatorid nagu postiaadress, telefoninumber ja e-posti aadress samuti unikaalsed ja püsivad. Me ei pea neid iga uue suhtlusega uuendama.

![BTC204](assets/notext/66/2.webp)
Siiski, Bitcoin'i toimimine on erinev: on hädavajalik genereerida iga sissetuleva tehingu jaoks uus vastuvõtu aadress. See kompromiss kasutusmugavuse ja privaatsuse vahel pärineb Bitcoin'i Valge Raamatu väga algusest. Esimese versiooni oma dokumendist avaldamisest lõpus 2008, hoiatas Satoshi Nakamoto meid juba selle riski eest:
**"*Lisakaitsemeetmena võiks iga tehingu jaoks kasutada uut võtmepaari, et hoida neid seostamata ühise omanikuga.*"**
On mitmeid meetodeid, kuidas vastu võtta mitmeid makseid ühele identifikaatorile ilma aadressi taaskasutamist põhjustamata. Igal meetodil on oma kompromissid ja puudused. Nende meetodite seas on BIP47, ettepanek, mille töötas välja Justus Ranvier ja avaldas 2015. aastal. See ettepanek eesmärgib luua korduvkasutatavaid maksekoodid, mis võimaldavad mitmeid tehinguid samale isikule, vältides samal ajal aadressi taaskasutamist. Sisuliselt püüab BIP47 pakkuda maksesüsteemi, mis on intuitiivne nagu unikaalne identifikaator, säilitades samal ajal tehingute privaatsuse.
![BTC204](assets/notext/66/3.webp)

BIP47 ei paranda otseselt kasutaja privaatsust, kuna BIP47 makse pakub sama privaatsuse taset kui klassikaline Bitcoin tehing, kasutades värsket aadresse. Siiski muudab see Bitcoini kasutamise mugavamaks ja intuitiivsemaks, mis tavaliselt peaks privaatsust ohustama. Tänu BIP47-le saavutab see kasutusmugavus sama privaatsuse taseme kui klassikaline tehing. Seetõttu on BIP47 väärtuslik vahend privaatsuse säilitamiseks.

Algselt oli BIP47 ettepanek, mis oli formuleeritud integreerimiseks Bitcoin Core'i, kuid seda ei võetud kunagi vastu. Mõned tarkvarad on siiski otsustanud seda omal käel rakendada rakenduse tasemel. Seega on Samourai Walleti meeskonnad välja töötanud oma BIP47 rakenduse nimega "PayNym".

### BIP47 ja PayNym Üldpõhimõte

BIP47 eesmärk on võimaldada mitmete maksete vastuvõtmist ilma aadressi taaskasutamist põhjustamata. See tugineb korduvkasutatava maksekoodi kasutamisele, mis võimaldab erinevatel saatjatel saata mitmeid makseid ühele koodile, mis kuulub teisele kasutajale. Seega ei pea saaja iga tehingu jaoks pakkuma uut värsket aadressi, mis suuresti hõlbustab nende vahetusi, säilitades samal ajal nende privaatsuse.

![BTC204](assets/en/66/4.webp)

Kasutaja saab seega oma maksekoodi vabalt jagada, olgu see siis sotsiaalmeedias või oma veebisaidil, ilma privaatsust kaotamata, erinevalt sellest, mis juhtuks klassikalise vastuvõtu aadressi või avaliku võtmega.
Tehingu sooritamiseks peavad mõlemal poolel olema Bitcoin rahakott, milles on rakendatud BIP47, nagu PayNym Samourai Walletis või Sparrow Walletis. Nende maksekoodide ühine kasutamine loob nende vahel salajase kanali. Selle kanali tõhusaks loomiseks peab saatja sooritama Bitcoin'i plokiahelas spetsiifilise tehingu, mida tuntakse kui "teavitustehingut" (annan selle kohta hiljem rohkem üksikasju).

Mõlema kasutaja maksekoodide kombinatsioon genereerib jagatud saladusi, mis omakorda võimaldavad luua suure hulga unikaalseid Bitcoin'i vastuvõtu aadresse (täpselt 2^32 ehk umbes 4 miljardit). Seega tehakse makseid BIP47 kaudu tegelikult mitte maksekoodile endale, vaid klassikalistele vastuvõtu aadressidele, mis on tuletatud osalevate kasutajate maksekoodidest.

Maksekood toimib seega virtuaalse identifikaatorina, mis on tuletatud rahakoti seemnest. Rahakoti hierarhilises tuletusstruktuuris asetseb maksekood tasemel 3, st kontotasemel.

![BTC204](assets/en/66/5.webp)

BIP47 jaoks määratud tuletuseesmärk on tuvastatud indeksiga `47'` (`0x8000002F`), viidates BIP47-le. Näide korduvkasutatava maksekoodi tuletustee kohta oleks järgmine:
```plaintext
m/47'/0'/0'/
```

Et anda teile ettekujutus, milline maksekood välja näeb, siin on minu oma:
```plaintext
See kood võib samuti olla kodeeritud QR-koodi, et hõlbustada selle edastamist, just nagu klassikaline vastuvõtu aadress.

PayNym Botide osas, need robotid, mida mõnikord Twitteris näha võib, on maksekoodi visuaalsed esitused, mille on loonud Samourai Wallet. Need genereeritakse läbi räsifunktsiooni, mis annab neile peaaegu ainulaadsuse. Nad ilmuvad väikese tähemärkide jada kujul, mis algab `+`-ga:
```plaintext
+throbbingpond8B1
+twilightresonance487
+billowingfire340
```

Neid avatare saab samuti esitada piltide kujul:

![BTC204](assets/notext/66/6.webp)

Kuigi neil robotitel ei ole BIP47 raamistikus spetsiifilist tehnilist funktsionaalsust, mängivad nad rolli kasutajatevaheliste interaktsioonide hõlbustamisel, pakkudes kergesti äratuntavat visuaalset identiteeti.
Järgnevates peatükkides, mis on pühendatud BIP47-le, uurime üksikasjalikult, kuidas see töötab, erilise rõhuasetusega kasutatavatele krüptograafilistele meetoditele. Et täielikult mõista neid veidi tehnilisi selgitusi, on hädavajalik esmalt mõista HD rahakottide struktuuri, võtmete tuletamise protsesse ja elliptilise kõvera põhineva krüptograafia põhiprintsiipe. Kui soovite nendesse kontseptsioonidesse sügavamale sukelduda, on PlanB võrgustikus saadaval teine tasuta kursus: [CRYPTO 301](https://planb.network/en/courses/crypto301). Soovitan siiski neid jälgida, kuna BIP47 tehnilise toimimise mõistmine teeb teile palju lihtsamaks teiste sarnaste ettepanekute mõistmise, mida järgnevates peatükkides arutame.
### Korduvkasutatav Maksekood

Nagu varem mainitud, asub korduvkasutatav maksekood HD rahakoti sügavusel 3, muutes selle võrreldavaks `xpub`-iga, nii oma positsiooni poolest rahakoti struktuuris kui ka oma rolli poolest.

80-baidine maksekood jaguneb järgmiselt:
- **Bait `0`: Versioon**. BIP47 esimese versiooni puhul on see bait määratud kui `0x01`;
- **Bait `1`: Bitiväli**. See ruum on reserveeritud täiendavate märkuste integreerimiseks spetsiifilistel kasutusjuhtudel. Standardse kasutuse puhul PayNym'iga on see bait määratletud kui `0x00`;
- **Bait `2`: `y` paarsus**. See bait on `0x02` või `0x03`, näidates, kas avaliku võtme ordinaat on paaris või paaritu, kuna kasutatakse kokkusurutud avalikku võtit;
- **Baidist `3` kuni baidini `34`: `x` väärtus**. Need baidid esindavad avaliku võtme abskissi. `x` ja `y` paarsuse ühendamine moodustab täieliku kokkusurutud avaliku võtme;
- **Baidist `35` kuni baidini `66`: Ahelakood**. See ruum sisaldab avaliku võtmega seotud ahelakoodi;
- **Baidist `67` kuni baidini `79`: Täidis**. See ruum on ette nähtud võimalikeks tulevasteks arendusteks. Praeguse versiooni jaoks asetatakse siia lihtsalt nullid, et jõuda nõutava 80-baidise suuruseni `OP_RETURN` väljundis.

Siin on minu korduvkasutatava maksekoodi heksadesitlus, mida juba eelmises jaotises tutvustati:
```plaintext
![BTC204](assets/en/66/7.webp)

Esmalt on vajalik lisada algusesse eesliide `P`, et selgelt näidata, et tegemist on maksekoodiga. Seda baiti esindab `0x47`:
```plaintext
0x47010002a0716529bae6b36c5c9aa518a52f9c828b46ad8d907747f0d09dcd4d9a39e97c3c5f37c470c390d842f364086362f6122f412e2b0c7e7fc6e32287e364a7a36a00000000000000000000000000
```

Lõpuks, et tagada maksekoodi terviklikkus, viiakse läbi kontrollsumma arvutus kasutades `HASH256`, mis koosneb topelt hasheerimisest `SHA256` funktsiooniga. Selle hash'i esimesed neli baiti lisatakse seejärel maksekoodi lõppu:
```plaintext
0x47010002a0716529bae6b36c5c9aa518a52f9c828b46ad8d907747f0d09dcd4d9a39e97c3c5f37c470c390d842f364086362f6122f412e2b0c7e7fc6e32287e364a7a36a00000000000000000000000000567080c4
```

![BTC204](assets/en/66/8.webp)

Kui need sammud on lõpetatud, on maksekood valmis. Ainus, mis jääb, on teisendada see base 58 formaati, et saada selle lõplik versioon:
```plaintext
PM8TJSBiQmNQDwTogMAbyqJe2PE2kQXjtgh88MRTxsrnHC8zpEtJ8j7Aj628oUFk8X6P5rJ7P5qDudE4Hwq9JXSRzGcZJbdJAjM9oVQ1UKU5j2nr7VR5
```

Maksekoodi loomise protsessi käigus kasutame kompresseeritud avalikku võtit ja ahelakoodi. Mõlemad on tuletatud deterministlikust ja hierarhilisest tuletamisest rahakoti seemnest. Selle saavutamiseks kasutatav tuletamisrada on:
```plaintext
m/47'/0'/0'/
```
Kompresseeritud avaliku võtme ja sellega seotud ahelakoodi genereerimiseks korduvkasutatava maksekoodi jaoks alustame rahakoti seemnest peamise privaatvõtme arvutamisega. Seejärel jätkame lapsevõtmete paari tuletamisega kasutades indeksit `47 + 2^31` (kõvendatud tuletamine). Sellele sammule järgneb veel kaks järjestikust lapsevõtmete paari tuletamist, igaüks kasutades indeksit `2^31` (kõvendatud tuletamine).
![BTC204](assets/notext/66/9.webp)

### Elliptilise kõvera Diffie-Hellmani (ECDH) võtmevahetus
Krüptograafilise protokolli, mis on BIP47 südames, nimetatakse lühendiga ECDH, mis tähistab *Elliptilise Kõvera Diffie-Hellmani* meetodit. See meetod on originaalse Diffie-Hellmani võtmevahetuse variant.
Tutvustatud 1976. aastal, Diffie-Hellman on võtme kokkuleppe protokoll, mis võimaldab kahel osapoolel, kellest igaühel on võtmepaar (avalik ja privaatne), kokku leppida ühises saladuses, isegi kui suhtlus toimub ainult avaliku ja turvamata kanali kaudu.

![BTC204](assets/en/66/10.webp)

See ühine saladus (siin sinine võti) saab seejärel kasutada teiste toimingute jaoks. Tavaliselt saab seda jagatud saladust kasutada suhtluse krüpteerimiseks ja dekrüpteerimiseks turvamata võrgus:

![BTC204](assets/notext/66/11.webp)

Selle vahetuse saavutamiseks kasutab Diffie-Hellman modulaararitmeetikat jagatud saladuse arvutamiseks. Siin on lihtsustatud selgitus, kuidas see töötab:
- Alice ja Bob lepivad kokku ühises värvuses, siin kollases, mis on avalikud andmed (ründajad teavad seda värvi);
- Alice valib salajase värvi, siin punase, ja segab seda kahte, et saada oranž;
- Bob valib samuti salajase värvi, siin sinise, ja segab seda kollasega, et saada roheline;
- Seejärel vahetavad nad saadud värve, oranži ja rohelist. See vahetus võib toimuda turvamata ja jälgitaval võrgul;
- Segades Bobi rohelist oma salajase värviga, saab Alice pruuni;
- Bob, tehes sama Alice'i oranži ja oma salajase sinisega, saab samuti pruuni.

![BTC204](assets/en/66/12.webp)

Selles lihtsustuses esindab pruun värv Alice'i ja Bobi vahelist jagatud saladust. On oluline mõista, et tegelikkuses on ründajal võimatu eraldada oranži ja rohelist värvi, et avastada Alice'i või Bobi salajasi värve.

Nüüd vaatleme, kuidas see protokoll tegelikult töötab, mitte värvide analoogiate abil, vaid kasutades päris numbreid ja modulaararitmeetikat!
Enne Diffie-Hellmani mehhanismide arutamist lubage mul teile lühidalt meelde tuletada kahte olulist matemaatilist kontseptsiooni, mida meil vaja läheb:

- **Algarv** on loomulik arv, millel on ainult kaks jagajat: $1$ ja iseennast. Näiteks $7$ on algarv, sest seda saab jagada ainult $1$ ja $7$-ga. Teisest küljest, $8$ ei ole algarv, kuna seda saab jagada $1$, $2$, $4$ ja $8$-ga. Seega on sellel neli positiivset täisarvulist jagajat kahe asemel;
- **Modulo** (tähistatud $mod$ või $\%$) on matemaatiline operatsioon, mis kahe täisarvu vahel tagastab esimese Eukleidese jagamise jäägi teise poolt. Näiteks $16 \bmod 5 = 1$.

**Diffie-Hellmani võtmevahetus Alice'i ja Bobi vahel toimub järgmiselt:**

- Alice ja Bob lepivad kokku kahes ühises numbris: $p$ ja $g$. $p$ on algarv ja mida suurem see number on, seda turvalisem Diffie-Hellman on. $g$ on $p$ primitiivjuur. Neid kahte numbrit saab avatult suhelda turvamata võrgu kaudu. Need esindavad **kollase värvi** ekvivalenti eelmises lihtsustuses. Seega on oluline, et Alice ja Bob kasutaksid täpselt samu väärtusi $p$ ja $g$ jaoks.
- Kui need parameetrid on määratletud, valivad Alice ja Bob igaüks salajase juhusliku numbri. Alice nimetab oma salajase juhusliku numbri $a$ (võrdne **punase värviga**) ja Bob nimetab oma $b$ (võrdne **sinise värviga**). Need numbrid peavad jääma rangelt konfidentsiaalseks.
- Selle asemel, et vahetada numbreid $a$ ja $b$ otse, arvutab iga osapool $A$ ja $B$ järgmiselt:

$A$ on võrdne $g$ astmega $a$ modulo $p$:

$$
A = g^a \bmod p
$$

$B$ on võrdne $g$ astmega $b$ modulo $p$:

$$
B = g^b \bmod p
$$

- Väärtused $A$ (võrdne **oranži värviga**) ja $B$ (võrdne **rohelise värviga**) vahetatakse kahe osapoole vahel. See vahetus võib toimuda avalikult turvamata võrgus;

- Alice, olles saanud $B$, arvutab väärtuse $z$ järgmiselt:

$z$ on võrdne $B$ astmega $a$ modulo $p$:

$$
z = B^a \bmod p
$$

Meenutuseks:

$$
B = g^b \bmod p
$$

Seega saame:

$$
z = B^a \bmod p
$$

$$
z = (g^b)^a \bmod p
$$

Kasutades eksponentide reegleid:
$$
(x^n)^m = x^{nm}
$$

Siis saame:

$$
z = g^{ba} \bmod p
$$

- Omalt poolt, Bob, olles saanud $A$, arvutab samuti väärtuse $z$ järgmisel viisil:

$z$ on võrdne $A$ astmega $b$ modulo $p$:

$$
z = A^b \bmod p
$$

Seega saame:

$$
z = (g^a)^b \bmod p
$$

$$
z = g^{ab} \bmod p
$$

$$
z = g^{ba} \bmod p
$$

Tänu modulo operaatori distributiivsusele saavad Alice ja Bob täpselt sama väärtuse $z$. See number esindab nende ühist saladust, võrdne **pruuni värviga** eelmises lihtsustuses värvipottidega. Nad saavad nüüd kasutada seda ühist saladust oma suhtluse sümmeetriliseks krüpteerimiseks turvamata võrgus.

![BTC204](assets/notext/66/13.webp)

Ründaja, isegi omades $p$, $g$, $A$ ja $B$ (avalikud väärtused), ei suuda arvutada $a$, $b$ või $z$ (privaatsed väärtused). Selle saavutamiseks peaks ta pöörama ümber eksponenteerimise, operatsiooni, mis on võimatu ilma kõiki võimalusi ükshaaval proovimata, kuna see tähendab diskreetse logaritmi arvutamist, st eksponentsiaali pöördtehte arvutamist lõplikus tsüklilises grupis.

Niikaua kui $a$, $b$ ja $p$ väärtused on piisavalt suured, on Diffie-Hellmani protokoll turvaline. Tavaliselt, 2048-bitiste parameetritega (number 600 numbriga kümnendsüsteemis), oleks kõikide võimaluste testimine $a$ ja $b$ jaoks ebapraktiline. Tänase päevani, selliste numbritega, peetakse seda algoritmi turvaliseks.
Just täpselt siin peitub Diffie-Hellmani protokolli peamine puudus. Turvalisuse tagamiseks peab algoritm kasutama suuri numbreid. Seetõttu eelistatakse tänapäeval ECDH algoritmi (*Elliptic Curve Diffie-Hellman*), mis on Diffie-Hellmani variatsioon ja põhineb algebralisel kõveral, täpsemalt elliptilisel kõveral. See lähenemine võimaldab töötada palju väiksemate numbritega, säilitades samas võrdväärse turvalisuse, vähendades seeläbi arvutamiseks ja salvestamiseks vajalikke ressursse.
Algoritmi üldpõhimõte jääb samaks. Kuid selle asemel, et kasutada juhuslikku numbrit $a$ ja numbrit $A$, mis on arvutatud $a$-st modulaarse eksponenteerimise teel, kasutame võtmepaari, mis on loodud elliptilisel kõveral. Modulo operaatori distributiivsusele toetumise asemel kasutame elliptilistel kõveratel rühma seadust ja täpsemalt selle seaduse assotsiatiivsust.
Elliptilise kõvera krüptograafia põhimõtte lühikirjelduseks: privaatvõti on esindatud juhusliku numbriga vahemikus $1$ kuni $n-1$, kus $n$ tähistab kõvera järku. Avalik võti seevastu on konkreetne punkt sellel kõveral, mis on saadud privaatvõtmest lähtuvalt punktide liitmise ja kahekordistamise operatsioonidega, alustades generaatorpunktist, vastavalt võrrandile:
$$
K = k \cdot G
$$

Selles valemis tähistab $K$ avalikku võtit, $k$ privaatvõtit ja $G$ generaatorpunkti.

Nende võtmete üheks oluliseks omaduseks on $K$ arvutamise lihtsus $k$ ja $G$ põhjal, samas kui $k$ leidmine $K$ ja $G$ põhjal on praktiliselt võimatu. See asümmeetria loob ühesuunalise funktsiooni. Teisisõnu, avaliku võtme arvutamine on lihtne, kui teada on privaatvõti, kuid privaatvõtme leidmine avaliku võtme põhjal on võimatu. See turvalisus põhineb endiselt diskreetse logaritmi arvutuslikul raskusel.

Me kasutame seda omadust, et kohandada meie Diffie-Hellmani algoritmi. **ECDH tööpõhimõte on järgmine:**

- Alice ja Bob lepivad kokku krüptograafiliselt turvalises elliptilises kõveras ja selle parameetrites. See teave on avalik;

- Alice genereerib juhusliku numbri $ka$, mis saab olema tema privaatvõti. See privaatvõti peab jääma saladuseks. Ta määrab oma avaliku võtme $Ka$, liites ja kahekordistades punkte valitud elliptilisel kõveral:

$$
K_a = k_a \cdot G
$$

- Bob genereerib samuti juhusliku numbri $kb$, mis saab olema tema privaatvõti. Ta arvutab seotud avaliku võtme $Kb$:

$$
K_b = k_b \cdot G
$$

- Alice ja Bob vahetavad oma avalikud võtmed $Ka$ ja $Kb$ turvamata avalikul võrgul.

- Alice arvutab kõveral punkti $(x,y)$, rakendades oma privaatvõtit $ka$ Bobi avalikule võtmele $Kb$:

$$
(x,y) = k_a \cdot K_b
$$

- Bob arvutab kõveral punkti $(x,y)$, rakendades oma privaatvõtit $kb$ Alice'i avalikule võtmele $Ka$:

$$
(x,y) = k_b \cdot K_a
$$

- Alice ja Bob saavad elliptilisel kõveral sama punkti. Jagatud saladus saab olema selle punkti x-koordinaat $x$.

Tõepoolest, nad saavad sama jagatud saladuse, sest:
(x,y) = k_a \cdot K_b = k_a \cdot (k_b \cdot G) = (k_a \cdot k_b) \cdot G = (k_b \cdot k_a) \cdot G = k_b \cdot (k_a \cdot G) = k_b \cdot K_a$$
Ründaja, kes jälgib turvamata avalikku võrku, saab hankida ainult mõlema osapoole avalikud võtmed ja valitud elliptilise kõvera parameetrid. Nagu varem selgitatud, ei piisa sellest teabest privaatvõtmete määramiseks. Seetõttu ei saa ründaja leida Alice'i ja Bobi vahelist jagatud saladust.

ECDH on seega algoritm, mis võimaldab võtmevahetust. Seda kasutatakse sageli koos teiste krüptograafiliste meetoditega, et luua täielik protokoll. Näiteks on ECDH integreeritud TLS-i (*Transport Layer Security*, transpordikihi turvalisus) tuumikku, mis on interneti transpordikihi jaoks mõeldud krüpteerimis- ja autentimisprotokoll. TLS kasutab võtmevahetuseks ECDHE-d, ECDH varianti, kus võtmed on efemeersed, et tagada püsiv konfidentsiaalsus. Lisaks kasutab TLS autentimisalgoritme nagu ECDSA, krüpteerimisalgoritme nagu AES ja räsifunktsioone nagu SHA256.

TLS vastutab märkimisväärselt `s` eest `https`-is ning brauseri aadressiribal nähtava tabaluku sümboli eest, mis on krüpteeritud suhtluse sümbolid. Selle kursuse järgimisega kasutate seega ECDH-d ja tõenäoliselt kasutate seda iga päev isegi teadmata.

### Teavitustransaktsioon

Nagu eelmises jaotises nägime, on ECDH Diffie-Hellmani vahetuse variant, kasutades elliptilisel kõveral loodud võtmepaare. Mugavalt omame me juba palju sellisele standardile vastavaid võtmepaare oma Bitcoin'i rahakottides! BIP47 idee on kasutada mõlema osapoole Bitcoin'i deterministlikust hierarhilisest rahakotist pärit võtmepaare, et luua nende vahel jagatud ja efemeersed saladused. BIP47 kontekstis kasutatakse selle asemel ECDHE-d (*Elliptic Curve Diffie-Hellman Ephemeral*, elliptilise kõvera Diffie-Hellmani efemeerne).

![BTC204](assets/notext/66/14.webp)

ECDHE-d kasutatakse BIP47-s esimest korda saatja maksekoodi saatmiseks saajale. See on kuulus **teavitustransaktsioon**. See samm on oluline, sest BIP47 efektiivseks toimimiseks peavad mõlemad osapooled (saatja ja saaja) teadma teineteise maksekoodi. See teadmine võimaldab tuletada efemeersed avalikud võtmed ja seega seotud tühjad vastuvõtu aadressid.
Enne seda vahetust on saatja loogiliselt juba teadlik saaja maksekoodist, kuna on selle hankinud väljaspool võrku, näiteks nende veebisaidilt, arvelt või sotsiaalmeediast. Siiski ei pruugi saaja teada saatja maksekoodi. Ometi tuleb see kood neile edastada; vastasel juhul ei suuda nad tuletada efemeerseid võtmeid, mis on vajalikud aadresside tuvastamiseks, kus nende bitcoine hoitakse, ega pääse oma vahenditele ligi. Kuigi saatja koodi edastamine võib tehniliselt toimuda väljaspool võrku teiste suhtlusvahendite kaudu, tekitab see probleemi, kui rahakotti on vaja taastada ainult seemnest.
Tõepoolest, erinevalt tavapärastest aadressidest ei tuletata BIP47 aadresse otse saaja seemnest - sel juhul oleks `xpub` kasutamine lihtsam - vaid need on saadud mõlema osapoole maksekoodide: saatja ja saaja, kombineeritud arvutuse tulemusena. Seega, kui saaja kaotab oma rahakoti ja üritab seda oma seemnest taastada, taastab ta oma maksekoodi, mis on otseselt tuletatud tema seemnest. Siiski, et leida efemere aadresse, on hädavajalik, et neil oleks ka kõigi nende maksekoodid, kes on neile bitcoine saatnud BIP47 kaudu. Seega on teavitustransaktsiooni tähtsus ilmne, kuna see võimaldab salvestada selle teabe Bitcoin'i plokiahelale, olles samal ajal väga lihtsalt leitav ilma, et peaks läbi otsima miljardit tehingut, mis on teostatud alates selle käivitamisest 2009. aastal.
![BTC204](assets/en/66/15.webp)

Seetõttu oleks võimalik BIP47 rakendada ilma teavitustransaktsioonile toetumata, eeldusel, et iga kasutaja hoiab varundust oma partnerite maksekoodidest. Siiski, see meetod osutub keeruliseks hallata seni, kuni ei ole välja töötatud lihtsat, robustset ja tõhusat lahendust nende varunduste loomiseks, hoidmiseks ja uuendamiseks. Praeguses olukorras muutub teavitustransaktsioon seega peaaegu hädavajalikuks.

Järgnevates peatükkides uurime teisi protokolle, mille eesmärgid on sarnased BIP47 omadega, kuid mis ei nõua teavitustransaktsiooni. Need alternatiivid toovad siiski kaasa oma kompromissid.

Lisaks maksekoodide varundamise rollile täidab teavitustransaktsioon ka teavitamise funktsiooni saaja jaoks, nagu selle nimi viitab. See annab saaja kliendile märku, et on loodud uus maksekanal, ja seega soovitab jälgida tulenevaid efemere aadresse.

### BIP47 privaatsusmudel

Enne teavitustransaktsiooni tehnilise toimimise üksikasjalikku arutelu on oluline arutada BIP47-ga seotud privaatsusmudelit, mis õigustab selle algse tehingu loomisel võetud meetmeid.
Maksekood ise ei kujuta otseselt privaatsusriski. Erinevalt traditsioonilisest Bitcoin'i mudelist, mille eesmärk on katkestada seos kasutaja identiteedi ja nende tehingute (mis on avalikud) vahel, säilitades võtmete ja aadresside anonüümsuse, võib maksekoodi avalikult identiteediga seostada ilma, et see kujutaks endast ohtu.
Tõepoolest, maksekoodi ei kasutata otse BIP47 maksete vastuvõtvate aadresside tuletamiseks. Need aadressid genereeritakse selle asemel kahe osapoole maksekoodidest tuletatud võtmete vahelise ECDH rakendamise kaudu.

Seega ei vii maksekood iseenesest privaatsuse kaotuseni, kuna ainult teavitusaadress on sellest tuletatud. Kuigi see aadress võib paljastada teatud teavet, ei tohiks see tavaliselt võimaldada avastada, kellega tehinguid teete, välja arvatud põhjaliku ahela analüüsi kaudu. Tõepoolest, kui saatja kasutab teavitustransaktsiooni sooritamiseks UTXO-sid, mis on seotud nende identiteediga, siis muutub võimalikuks järeldada, et nende identiteet on tõenäoliselt seotud BIP47 maksetega teie maksekoodile. See ei paljasta aluseks olevaid tehinguid, kuid viitab nende tõenäolisele olemasolule.

Seetõttu on oluline säilitada see range eraldatus kasutajate maksekoodide vahel. Selle eesmärgi poole püüdlemisel on koodi esialgne suhtlusmoment makse privaatsuse jaoks kriitiline hetk, kuid protokolli nõuetekohaseks toimimiseks kohustuslik. Kui üks maksekoodidest on avalikult kättesaadav (näiteks veebisaidil), ei tohi teine kood, saatja oma, mingil juhul olla esimesega seotud.

Võtame konkreetse näite: Tahan teha annetuse poliitilisele liikumisele BIP47 kaudu:
- Organisatsioon on teinud oma maksekoodi avalikuks oma veebisaidil või sotsiaalmeedia kaudu;
- See kood on seega seotud poliitilise liikumisega;
- Ma taastan selle maksekoodi;
- Enne saatmisega jätkamist pean ma veenduma, et nad teavad minu enda maksekoodi, mis on samuti seotud minu identiteediga, kuna kasutan seda tehingute vastuvõtmiseks oma sotsiaalvõrgustikes.

Kuidas edastada oma koodi ilma riskita? Tavapäraste suhtlusvahendite kasutamine võib viia informatsioonilekke tekkeni ja seega seostada mind selle poliitilise liikumisega. Teavitustehingu kasutamine pakub lahendust tänu krüpteerimiskihile, mis just takistab nende kahe koodi seostamist. Kuigi see ei ole ainus meetod saatja maksekoodi salajas edastamiseks, osutub see väga tõhusaks.

Allpool olevas diagrammis näitavad oranžid jooned punkte, kus informatsiooni vool tuleb katkestada, ja mustad nooled näitavad ühendusi, mida kolmandad osapooled võiksid potentsiaalselt jälgida:
![BTC204](assets/en/66/16.webp)
Tegelikkuses on Bitcoini traditsioonilises privaatsusmudelis sageli keeruline täielikult lahutada informatsiooni voolu võtmepaari ja kasutaja vahel, eriti kaugtehingute puhul. Näiteks annetuskampaania kontekstis peab saaja paratamatult avalikustama aadressi või avaliku võtme oma veebisaidil või sotsiaalvõrgustikes. BIP47 korrektne kasutamine, eriti teavitustehingu abil, võimaldab seda probleemi vältida tänu ECDHE-le ja krüpteerimiskihile, mida me edasi uurime.

Muidugi kehtib Bitcoini klassikaline privaatsusmudel endiselt efemeersetele avalikele võtmetele, mis on tuletatud kahe maksekoodi kombinatsioonist. Need kaks mudelit on tegelikult täiendavad. Mida ma siin rõhutada tahan, on see, et erinevalt avaliku võtme tavapärasest kasutamisest bitcoinide vastuvõtmiseks, võib maksekood olla seotud konkreetse identiteediga, kuna teave "_Alice teeb tehingu Bobiga_" on katkenud teisel etapil. Maksekoodi kasutatakse makseaadresside genereerimiseks, kuid ainult plokiahela vaatluse põhjal on võimatu seostada BIP47 maksetehingut kasutatud maksekoodidega, välja arvatud juhul, kui kaasatud UTXO-d olid juba varem identiteediga seotud ja kasutajad on oma maksekoodid vastavate identiteetidega seostanud.

Kokkuvõtteks võib öelda, et BIP47 maksete pakutav privaatsusmudel võib olla Bitcoini baasi omast parem, kuigi see ei ole mingil moel maagiline.

### Teavitustehingu konstrueerimine

Nüüd vaatame, kuidas see teavitustehing töötab. Kujutage ette, et Alice soovib saata vahendeid Bobile BIP47 abil. Minu näites tegutseb Alice saatjana ja Bob saajana. Viimane on avaldanud oma maksekoodi oma veebisaidil. Seega on Alice juba teadlik Bobi maksekoodist.

**1- Alice arvutab jagatud saladuse ECDH abil:**

- Ta valib oma HD rahakotist erinevast harust maksekoodist erineva võtmepaari. Pane tähele, et seda paari ei tohiks kergesti seostada Alice'i teavitusaadressiga ega Alice'i identiteediga (vt eelmine jaotis);

- Alice valib sellest paarist privaatvõtme. Me nimetame seda $a$ (väiketäht);

$$
a
$$
- Alice taastab Bobi teavitusaadressiga seotud avaliku võtme. See võti on Bobi maksekoodist tuletatud esimene tütar (indeks $/0$). Me nimetame seda avalikku võtit $B$ (suurtäht). Selle avaliku võtmega seotud privaatvõtit nimetame $b$ (väiketäht). $B$ määratakse punktide liitmisel ja kahekordistamisel elliptilisel kõveral alates $G$-st (generaatorpunkt) koos $b$-ga (privaatvõti):
$$ B = b \cdot G $$
- Alice arvutab salajase punkti $S$ (suurtäht) elliptilisel kõveral, kasutades punktide liitmist ja kahekordistamist, rakendades oma privaatvõtit $a$ Bobi avalikust võtmest $B$.
$$ S = a \cdot B $$

- Alice arvutab pimestamisteguri $f$, mis võimaldab tal oma maksekoodi krüpteerida. Selleks määrab ta pseudojuhusliku numbri HMAC-SHA512 funktsiooni abil. Selle funktsiooni teises sisendis kasutab ta väärtust, mille saab taastada ainult Bob: $x$, mis on eelnevalt arvutatud salajase punkti abskiss. Esimene sisend on $o$, mis on selle tehingu sisendis tarbitud UTXO (väljundpunkt).

$$ f = \text{HMAC-SHA512}(o, x) $$

**2- Alice teisendab oma isikliku maksekoodi aluseks 2 (binaarne).**

**3- Ta kasutab seda pimestamistegurit võtmena, et teostada oma maksekoodi sisu sümmeetrilist krüpteerimist.** Kasutatav krüpteerimisalgoritm on lihtsalt `XOR`. Teostatav toiming on võrreldav Vernami šifriga, mida nimetatakse ka "Ühekordseks Padiks".

- Alice jagab esmalt oma pimestamisteguri kaheks: esimesed 32 baiti nimetatakse $f1$ ja viimased 32 baiti nimetatakse $f2$. Seega meil on:

$$ f = f1 || f2 $$

- Alice arvutab avaliku võtme $x$ abskissi krüpteeritud $x'$ ja oma ahelakoodi $c$ krüpteeritud $c'$ eraldi. $f1$ ja $f2$ toimivad vastavalt krüpteerimisvõtmetena. Kasutatav toiming on `XOR` (eksklusiivne või).

$$ x' = x \oplus f1 $$
$$ c' = c \oplus f2 $$

- Alice asendab oma maksekoodis avaliku võtme abskissi $x$ ja ahelakoodi $c$ tegelikud väärtused krüpteeritud väärtustega $x'$ ja $c'$.
**4-** Alice'il on nüüd oma maksekood krüpteeritud sisuga. Ta koostab ja edastab tehingu, mis hõlmab sisendina tema avalikku võtit $A$, väljundit Bobi teavitusaadressile ja `OP_RETURN` väljundit, mis sisaldab tema maksekoodi krüpteeritud sisuga. **See tehing on teavitustehing**.
`OP_RETURN` on operatsioonikood, mis märgib Bitcoin'i tehingu väljundi kehtetuks. Tänapäeval kasutatakse seda teabe edastamiseks või ankurdamiseks Bitcoin'i plokiahelas. Kuni 80 baiti andmeid saab salvestada, mis on kirjutatud ahelasse ja seega nähtavad kõigile teistele kasutajatele.

Nagu eelmistes jaotistes nägime, kasutatakse ECDH-d jagatud salajase genereerimiseks kahe kasutaja vahel, kes suhtlevad turvamata võrgus, mida võivad jälgida ründajad. BIP47-s kasutatakse ECDH-d suhtlemiseks Bitcoin'i võrgus, mis oma olemuselt on läbipaistev suhtlusvõrk, mida jälgivad paljud ründajad. ECDH võtmevahetuse kaudu arvutatud jagatud salajast kasutatakse seejärel edastatava salajase teabe krüpteerimiseks: saatja (Alice'i) maksekood.

Vaadelgem üle sammud, mida oleme just koos läbi vaadanud, et teostada teavitustehingut:
- Alice hangib Bobi maksekoodi ja teavitusaadressi;
- Alice valib oma HD rahakotis omatava UTXO vastava võtmepaariga;
- Ta arvutab elliptilisel kõveral salajase punkti, kasutades ECDH-d;
- Ta kasutab seda salajast punkti HMAC-i arvutamiseks, mis on pimestamistegur;
- Ta kasutab seda pimestamistegurit oma isikliku maksekoodi sisu krüpteerimiseks.
- Ta kasutab `OP_RETURN` tehingu väljundit, et edastada Bobile maskeeritud maksekood.
![BTC204](assets/en/66/17.webp)

### Teavitustehing: Konkreetne Uuring

Et mõista selle toimimist üksikasjalikumalt, eriti `OP_RETURN` kasutamist, vaatame koos läbi ühe päris teavitustehingu. Sooritasin sellise tehingu testvõrgus, mille leiate [siit klõpsates](https://mempool.space/fr/testnet/tx/0e2e4695a3c49272ef631426a9fd2dae6ec3a469e3a39a3db51aa476cd09de2e).

![BTC204](assets/notext/66/18.webp)

Seda tehingut vaadeldes näeme, et sellel on üks sisend ja 4 väljundit:
- Esimene väljund on `OP_RETURN`, mis sisaldab minu maskeeritud maksekoodi;
- Teine väljund 546 satsi suunab minu saaja teavitusaadressile;
- Kolmas väljund 15 000 satsi esindab teenustasusid, kuna kasutasin selle tehingu koostamiseks Samourai Walletit;
- Neljas väljund 2 miljonit satsi esindab ülejääki, tähendades sisendi jääki, mis läheb tagasi teisele aadressile, mis kuulub mulle.
Kõige huvitavam uurida on ilmselgelt väljund 0, kasutades `OP_RETURN`. Vaatame lähemalt, mida see sisaldab. Siin on `scriptPubKey` heksadesimaalkujul:

```text
6a4c50010002b13b2911719409d704ecc69f74fa315a6cb20fdd6ee39bc9874667703d67b164927b0e88f89f3f8b963549eab2533b5d7ed481a3bea7e953b546b4e91b6f50d800000000000000000000000000
```

Selles skriptis saame lahti võtta mitu osa. Esiteks, operaatorid:

```text
6a4c
```

Operaatorite seas tunneme ära `0x6a`, mis tähistab `OP_RETURN` ja `0x4c`, mis tähistab `OP_PUSHDATA1`.

Sellele viimasele operaatorile järgnev bait näitab järgneva koormuse suurust. See näitab `0x50`, ehk 80 baiti:

```text
6a4c50
```

Seejärel on minu maksekoodi metaandmed lihttekstina:

```text
010002
```

Minu maksekoodi avaliku võtme krüpteeritud x-koordinaat:

```text
b13b2911719409d704ecc69f74fa315a6cb20fdd6ee39bc9874667703d67b164
```

Minu maksekoodi krüpteeritud ahelakood:

```text
927b0e88f89f3f8b963549eab2533b5d7ed481a3bea7e953b546b4e91b6f50d8
```

Ja lõpuks, polsterdus, et jõuda 80 baiti, mis on `OP_RETURN` standard suurus:

```text
00000000000000000000000000
```

Paremaks mõistmiseks, siin on minu maksekood lihttekstina base 58-s:

```text
Kui võrrelda minu lihttekst maksekoodi `OP_RETURN`-iga, on märgatav, et HRP (`0x47`) ja kontrollsumma (`0x8604e4db`) ei edastata. See on oodatud, kuna need teabeosad on mõeldud inimestele.
Järgmisena saame tuvastada versiooni (`0x01`), bitivälja (`0x00`) ja avaliku võtme paarsuse (`0x02`). Ja maksekoodi lõpus kasutatakse tühje baiti (`0x00000000000000000000000000`), et täita kood kokku 80 baiti. Kõik need metaandmed edastatakse lihttekstina (krüpteerimata).

Lõpuks võib täheldada, et avaliku võtme x-koordinaat (`0x77507c9c17a89cfca2d3af554745d6c2db0e7f6b2721a3941a504933103cc42a`) ja ahela kood (`0xdd94881210d6e752a9abc8a9fa0070e85184993c4f643f1121dd807dd556d1dc`) on krüpteeritud. See moodustab maksekoodi andmestiku.

### Mis on XOR?

Eelmistes jaotistes nägime, et maksekood edastati krüpteerituna, kasutades XOR-operatsiooni. Võtame hetke, et mõista, kuidas see operaator töötab, kuna seda kasutatakse laialdaselt krüptograafias.

XOR on bittide loogiline operaator, mis põhineb Boole'i algebral. Kahe biti operandiga tagastab see `1`, kui sama järku bitid on erinevad, ja see tagastab `0`, kui sama järku bitid on samad. Siin on XOR tõeväärtustabel operandide väärtuste `D` ja `E` põhjal:

| D   | E   | D XOR E |
| --- | --- | ------- |
| 0   | 0   | 0       |
| 0   | 1   | 1       |
| 1   | 0   | 1       |
| 1   | 1   | 0       |

Näiteks:

$$
0110 \oplus 1110 = 1000
$$

Või:

$$
010011 \oplus 110110 = 100101
$$

ECDH-ga, kasutades XOR-i krüpteerimiskihina, on eriti sobiv. Esiteks, tänu sellele operaatorile, on krüpteerimine sümmeetriline. See võimaldab saajal dekrüpteerida maksekoodi sama võtmega, mida kasutati krüpteerimiseks. Krüpteerimis- ja dekrüpteerimisvõti arvutatakse jagatud saladuse põhjal tänu ECDH-le. See sümmeetria on võimaldatud XOR operaatori kommutatiivsete ja assotsiatiivsete omaduste tõttu:

- Muud omadused:

$$
D \oplus D = 0
$$
D ⊕ 0 = D
- Kommutatiivsus:

$$
D \oplus E = E \oplus D
$$

- Assotsiatiivsus:

$$
D \oplus (E \oplus Z) = (D \oplus E) \oplus Z = D \oplus E \oplus Z
$$

Kui:

$$
D \oplus E = L
$$

Siis:

$$
D \oplus L = D \oplus (D \oplus E) = D \oplus D \oplus E = 0 \oplus E = E \\
\therefore D \oplus L = E
$$

Järgnevalt sarnaneb see krüpteerimismeetod tihedalt Vernami šifriga (Ühekordne Padjake), mis on ainus tänase päevani teadaolev krüpteerimisalgoritm, millel on tingimusteta (või absoluutne) turvalisus. Selleks, et Vernami šifr omaks seda omadust, peab krüpteerimisvõti olema täiesti juhuslik, see peab olema sama suur kui sõnum ja seda tohib kasutada ainult üks kord. BIP47-s kasutatavas krüpteerimismeetodis on võti tõepoolest sama suur kui sõnum, pimestamisfaktor on täpselt sama suur kui avaliku võtme x-koordinaadi ja maksekoodi ahelakoodi ühendamine. See krüpteerimisvõti kasutatakse tõepoolest ainult üks kord. Siiski, see võti ei ole täiusliku juhuslikkuse tulemus, kuna see on HMAC. See on pigem pseudojuhuslik. Seega, see ei ole Vernami šiffer, kuid meetod on sarnane.

### Teavitustransaktsiooni vastuvõtmine

Nüüd, kui Alice on saatnud teavitustransaktsiooni Bobile, vaatame, kuidas ta seda tõlgendab. Meenutuseks, Bob peab olema võimeline ligi pääsema Alice'i maksekoodile. Ilma selle teabeta, nagu me järgmises jaotises näeme, ei suuda ta tuletada Alice'i poolt loodud võtmepaare ja seetõttu ei saa ta ligi pääseda oma bitcoinidele, mis on saadud BIP47 kaudu. Praegu on Alice'i maksekoodi sisu krüpteeritud. Vaatame, kuidas Bob selle lahti krüpteerib.

**1-** Bob jälgib tehinguid, mis loovad väljundeid tema teavitusaadressil.

**2-** Kui tehingul on väljund tema teavitusaadressil, analüüsib Bob seda, et näha, kas see sisaldab OP_RETURN väljundit, mis järgib BIP47 standardit.

**3-** Kui OP_RETURN väljundi esimene bait on `0x01`, alustab Bob võimaliku ühise saladuse otsimist ECDH abil:
- Bob valib tehingu sisendis oleva avaliku võtme. See on Alice'i avalik võti, mida nimetatakse $A$-ks:

$$ A = a \cdot G $$

- Bob valib oma isikliku teavitusaadressiga seotud privaatvõtme $b$:

$$ b $$
- Bob arvutab elliptilisel kõveral saladuspunkti $S$ (jagatud ECDH saladus), lisades ja kahekordistades punkte, rakendades oma privaatvõtit $b$ Alice'i avalikule võtmele $A$:
$$ S = b \cdot A $$

- Bob määrab pimestamisfaktori $f$, mis võimaldab tal lahti krüpteerida Alice'i maksekoodi sisu. Samamoodi, nagu Alice oli varem arvutanud, leiab Bob $f$ rakendades HMAC-SHA512 $x$-le, saladuspunkti $S$ x-koordinaadile, ja $o$-le, selles teavitustransaktsioonis tarbitud UTXO-le:

$$ f = \text{HMAC-SHA512}(o, x) $$

**4-** Bob tõlgendab teavitustransaktsiooni OP_RETURN andmeid kui maksekoodi. Ta lihtsalt dekrüpteerib selle potentsiaalse maksekoodi sisu kasutades pimestamisfaktorit $f$:
- Bob jagab pimestamisteguri $f$ kaheks osaks: esimesed 32 baiti $f$-st saavad olema $f1$ ja viimased 32 baiti saavad olema $f2$;
- Bob dekrüpteerib Alice'i maksekoodist krüpteeritud x-koordinaadi $x'$:

$$ x = x' \oplus f1 $$

- Bob dekrüpteerib Alice'i maksekoodist krüpteeritud ahelakoodi väärtuse $c'$:

$$ c = c' \oplus f2 $$

**5-** Bob kontrollib, kas Alice'i maksekoodist saadud avaliku võtme väärtus on tõepoolest osa secp256k1 grupist. Kui see nii on, tõlgendab ta seda kehtiva maksekoodina. Vastasel juhul ignoreerib ta seda tehingut.

Nüüd, kui Bob on teadlik Alice'i maksekoodist, saab ta talle saata kuni `2^32` makset, ilma et peaks kunagi uuesti sellist teavitustehingut tegema.

Miks see töötab? Kuidas suudab Bob kindlaks teha sama pimestamisteguri nagu Alice ja seeläbi tema maksekoodi dekrüpteerida? Vaatame lähemalt ECDH rolli selles, mida me just kirjeldasime.

Esiteks, me tegeleme sümmeetrilise krüpteerimisega. See tähendab, et krüpteerimisvõti ja dekrüpteerimisvõti on sama väärtus. Teavitustehingus olev võti on pimestamistegur:

$$ f = f1 || f2 $$

Seega peavad Alice ja Bob saama $f$ jaoks sama väärtuse, ilma seda otseselt edastamata, kuna ründaja võiks selle varastada ja salajase teabe dekrüpteerida. Seda pimestamistegurit saadakse, rakendades HMAC-SHA512 kahele väärtusele:
- salajase punkti x-koordinaat;
- ja tehingus sisendina tarbitud UTXO.
Seega vajab Bob nende kahe teabe tükki, et dekrüpteerida Alice'i maksekoodi sisu. UTXO sisendi jaoks saab Bob selle lihtsalt kätte, jälgides teavitustehingut. Salajase punkti jaoks peab Bob kasutama ECDH-d. Nagu eelmises jaotises Diffie-Hellmani kohta nägime, saavad Alice ja Bob lihtsalt oma avalikke võtmeid vahetades ja salaja oma privaatvõtmeid teise avalikule võtmele rakendades leida elliptilisel kõveral konkreetse ja salajase punkti. Teavitustehing tugineb sellele mehhanismile:
- Bobi võtmepaar:

$$ B = b \cdot G $$

- Alice'i võtmepaar:

$$ A = a \cdot G $$

- Salajase $S (x, y)$ jaoks:

$$ S = a \cdot B = a \cdot (b \cdot G) = (b \cdot a) \cdot G = b \cdot A $$

![BTC204](assets/en/66/19.webp)

Nüüd, kui Bob teab Alice'i maksekoodi, suudab ta tuvastada tema BIP47 makseid ja tuletada privaatvõtmed, mis lukustavad saadud bitcoine.

Vaatame üle sammud, mille kaudu me just läbisime, et vastu võtta ja tõlgendada teavitustehingut:
- Bob jälgib tehinguväljundeid oma teavitusaadressil;
- Kui ta tuvastab ühe, taastab ta OP_RETURN sisaldava teabe;
- Bob valib sisendist avaliku võtme ja arvutab salajase punkti kasutades ECDH-d;
- Ta kasutab seda salajast punkti, et arvutada HMAC, mis on pimestamistegur;
- Ta kasutab seda pimestamistegurit, et dekrüpteerida OP_RETURN sisaldav Alice'i maksekoodi sisu.

![BTC204](assets/en/66/20.webp)

### BIP47 Maksetehing

Vaadelgem nüüd koos BIP47 makseprotsessi. Meenutuseks praegusest olukorrast:
- Alice teab Bobi maksekoodi, mille ta lihtsalt võttis tema veebisaidilt;
- Bob teab Alice'i maksekoodi tänu teavitustransaktsioonile;
- Alice teeb esimese makse Bobile. Ta saab teha palju teisi samal viisil.

Enne selle protsessi selgitamist pean oluliseks meenutada indekseid, millega me praegu töötame. Maksekoodi tuletamise tee on kirjeldatud järgmiselt: `m/47'/0'/0'`. Järgmine sügavus jaotab indeksid sel viisil:
- Esimene tavaline (mitte-kõvastunud) lapsepaar on see, mida kasutatakse teavitusaadressi genereerimiseks, millest me eelmises osas rääkisime: `m/47'/0'/0'/0`;
- Tavalisi lapse võtmepaare kasutatakse ECDH protokollis BIP47 maksevastuvõtu aadresside genereerimiseks, nagu me selles jaotises näeme: alates `m/47'/0'/0'/0` kuni `m/47'/0'/0'/2 147 483 647`;
- Kõvastunud lapse võtmepaare kasutatakse ühekordsete maksekoodidena: alates `m/47'/0'/0'/0'` kuni `m/47'/0'/0'/2 147 483 647'`.

Iga kord, kui Alice soovib Bobile makse teha, tuletatakse uus unikaalne neitsi aadress, tänu jällegi ECDH protokollile:
- Alice valib esimese privaatvõtme, mis on tuletatud tema isiklikust korduvkasutatavast maksekoodist:

$$ a $$

- Alice valib esimese kasutamata avaliku võtme, mis on tuletatud Bobi maksekoodist. Seda avalikku võtit nimetame me $B$-ks. See on seotud privaatvõtmega $b$, mida teab ainult Bob:

$$ B = b \cdot G $$

- Alice arvutab elliptilisel kõveral salajase punkti $S$, rakendades oma privaatvõtit $a$ Bobi avalikule võtmele $B$:

$$ S = a \cdot B $$

- Sellest salajasest punktist arvutab Alice jagatud salajase $s$ (väiketähtedega). Selleks valib ta salajase punkti $S$ x-koordinaadi nimega $Sx$ ja läbib selle väärtuse SHA256 räsifunktsiooni:

$$ S = (Sx, Sy) $$
$$ s = \text{SHA256}(Sx) $$

- Alice kasutab seda jagatud salajast $s$, et arvutada Bitcoin'i maksevastuvõtu aadress. Esialgu kontrollib ta, kas $s$ sisaldub secp256k1 kõvera järjekorras. Kui ei, siis suurendab ta Bobi avaliku võtme indeksit, et tuletada teine jagatud salajane;
- Teiseks arvutab ta avaliku võtme $K0$, lisades elliptilisel kõveral punktid $B$ ja $s·G$. Teisisõnu, Alice lisab Bobi maksekoodist tuletatud avaliku võtme $B$ teise punktiga, mis on arvutatud elliptilisel kõveral punkti lisamise ja kahekordistamisega jagatud salajase $s$ abil secp256k1 kõvera generaatorpunktist $G$. See uus punkt esindab avalikku võtit ja me nimetame seda $K0$-ks:

$$ K0 = B + s \cdot G $$

- Selle avaliku võtmega $K0$ saab Alice tuletada standardse neitsi vastuvõtu aadressi (näiteks SegWit V0 bech32-s).
Kui Alice on saanud Bobi vastuvõtu aadressi $K0$, saab ta teha Bitcoin'i tehingu standardviisil. Selleks valib ta UTXO, mille omanik ta on, turvatud tema HD rahakoti erineva haru võtmepaariga, ja kulutab selle, et rahuldada väljundit Bobi aadressile $K0$. On oluline märkida, et see makse, kui aadress on tuletatud, järgib tavapärast protsessi ja ei sõltu enam BIP47-ga seotud võtmetest.
Vaatame üle sammud, mida me just koos läbisime, et teha BIP47 makse:
- Alice valib oma isiklikust maksekoodist esimese tuletatud lapse privaatvõtme;
- Ta arvutab elliptilisel kõveral salajase punkti, kasutades ECDH-d Bobi maksekoodist pärit esimese kasutamata tuletatud lapse avalikust võtmest;
- Ta kasutab seda salajast punkti, et arvutada jagatud salajane SHA256 abil;
- Ta kasutab seda jagatud salajast, et arvutada uus salajane punkt elliptilisel kõveral;
- Ta lisab selle uue salajase punkti Bobi avalikule võtmele;
- Ta saab uue efemeriidse avaliku võtme, millele ainult Bobil on vastav privaatvõti;
- Alice saab teha Bobile standardse tehingu tuletatud efemeriidse vastuvõtu aadressile.

![BTC204](assets/en/66/21.webp)

Kui Alice soovib teha teise makse, järgib ta samu samme nagu varem, välja arvatud see kord valib ta Bobi maksekoodist teise tuletatud avaliku võtme. Täpsemalt kasutab ta järgmist kasutamata võtit. Seeläbi saab ta uue vastuvõtu aadressi, mis kuulub Bobile, tähistatud $K1$:

![BTC204](assets/en/66/22.webp)

Ta võib jätkata sel viisil ja tuletada kuni `2^32` kasutamata aadressi, mis kuuluvad Bobile.

Välisest vaatepunktist, vaadeldes plokiahelat, on teoreetiliselt võimatu eristada BIP47 makset standardsest maksest. Siin on näide BIP47 maksetehingust Testnetis:

```text
94b2e59510f2e1fa78411634c98a77bbb638e28fb2da00c9f359cd5fc8f87254
```

See näeb välja nagu standardne tehing koos tarbitud sisendiga, makse väljundiga ja muudatusega:

![BTC204](assets/notext/66/23.webp)

### BIP47 Makse Vastuvõtmine ja Privaatvõtme Tuletamine

Alice on just teinud oma esimese makse uuele BIP47 aadressile, mis kuulub Bobile. Vaatame nüüd, kuidas Bob seda makset vastu võtab. Samuti näeme, miks Alice'il pole juurdepääsu aadressi privaatvõtmele, mille ta just ise genereeris, ja kuidas Bob selle võtme taastab, et kulutada just saadud bitcoine.
Niipea, kui Bob saab Alicelt teavitustehingu, tuletatakse avalik võti BIP47 $K0$ isegi enne, kui ta on ühtegi makset saatnud. Ta jälgib seejärel kõiki makseid seotud aadressile. Tegelikult tuletatakse kohe mitu aadressi, mida ta jälgib ($K0$, $K1$, $K2$, $K3$...). Siin on, kuidas ta tuletatakse seda avalikku võtit $K0$:
- Bob valib oma maksekoodist esimese tuletatud lapse privaatvõtme. Seda privaatvõtit nimetatakse $b$. See on seotud avaliku võtmega $B$, mida Alice oli kasutanud eelmises etapis oma arvutustes:

$$ b $$

- Bob valib Alice'i maksekoodist tuletatud esimese avaliku võtme. Seda võtit nimetatakse $A$. See on seotud privaatvõtmega $a$, mida Alice oli kasutanud oma arvutustes ja millest ainult Alice on teadlik. Bob saab seda protsessi läbi viia, kuna ta on teadlik Alice'i maksekoodist, mis edastati talle teavitustehinguga:

$$ A = a \cdot G $$

- Bob arvutab salajase punkti $S$, lisades ja kahekordistades punkte elliptilisel kõveral, rakendades oma privaatvõtit $b$ Alice'i avalikule võtmele $A$. Siin leiame ECDH kasutamise, mis tagab, et see punkt $S$ on sama nii Bobi kui ka Alice'i jaoks:

$$ S = b \cdot A $$
- Just nagu Alice, isoleerib ka Bob selle punkti x-koordinaadi $S$. Oleme sellele väärtusele nimetanud $Sx$. Ta läbib selle väärtuse läbi SHA256 funktsiooni, et leida jagatud saladus $s$ (väiketähtedega):
$$ s = \text{SHA256}(Sx) $$

- Samamoodi nagu Alice, arvutab Bob punkti $s·G$ elliptilisel kõveral. Seejärel lisab ta selle salajase punkti oma avalikule võtmele $B$. Ta saab nii uue punkti elliptilisel kõveral, mida ta tõlgendab kui avalikku võtit $K0$:

$$ K0 = B + s \cdot G $$

Kui Bobil on see avalik võti $K0$, saab ta tuletada seotud privaatvõtme, et oleks võimalik oma bitcoine kulutada. Ainult tema saab genereerida selle privaatvõtme:

- Bob lisab oma lapse privaatvõtme $b$, mis on tuletatud tema isiklikust maksekoodist. Ainult tema saab saada $b$ väärtuse. Seejärel lisab ta $b$ jagatud saladusega $s$, et saada $k0$, $K0$ privaatvõti:

$$ k0 = b + s $$

Tänu elliptilise kõvera grupiseadusele saab Bob täpselt privaatvõtme, mis vastab Alice'i poolt kasutatud avalikule võtmele. Seega meil on:

$$ K0 = k0 \cdot G $$
Kokkuvõttes, läbisime koos järgmised sammud, et vastu võtta BIP47 makse ja arvutada vastav privaatvõti:
- Bob valib esimese tuletatud lapse privaatvõtme oma isiklikust maksekoodist;
- Ta arvutab salajase punkti elliptilisel kõveral, kasutades ECDH-d Alice'i ahelakoodist tuletatud esimese lapse avaliku võtme põhjal;
- Ta kasutab seda salajast punkti, et arvutada jagatud saladus SHA256 abil;
- Ta kasutab seda jagatud saladust, et arvutada uus salajane punkt elliptilisel kõveral;
- Ta lisab selle uue salajase punkti oma isiklikule avalikule võtmele;
- Ta saab uue ajutise avaliku võtme, millele Alice saadab oma esimese makse;
- Bob arvutab selle ajutise avaliku võtme seotud privaatvõtme, lisades oma maksekoodist tuletatud lapse privaatvõtme ja jagatud saladuse.

![BTC204](assets/en/66/24.webp)

Kuna Alice ei saa saada $b$ (Bob'i privaatvõtit), ei suuda ta kindlaks määrata $k0$ (privaatvõtit, mis on seotud Bob'i BIP47 vastuvõtu aadressiga). Skeemiliselt saame jagatud saladuse $S$ arvutamist esitada nii:

![BTC204](assets/en/66/19.webp)

Kui jagatud saladus on leitud ECDH abil, arvutavad Alice ja Bob BIP47 makse avaliku võtme $K0$, ja Bob arvutab ka seotud privaatvõtme $k0$:

![BTC204](assets/en/66/25.webp)

### BIP47 Makse Tagastamine

Kuna Bob teab Alice'i korduvkasutatavat maksekoodi, on tal juba kõik vajalik teave, et saata talle tagasimakse. Ta ei pea Alice'iga uuesti ühendust võtma, et küsida lisateavet. Ta peab lihtsalt teavitama teda teavitustransaktsiooniga, eriti selleks, et ta saaks oma BIP47 aadresse oma seemne abil taastada, ja seejärel saab ta talle saata kuni `2^32` makset.

Tagasimakse funktsionaalsus on spetsiifiline BIP47-le ja on üks selle eelistest teiste meetodite ees, mida me järgmistes peatükkides uurime, nagu Vaiksed Maksed.

Bob saab seejärel tagastada Alice'ile makse samal viisil, kuidas ta talle makseid saatis. Rollid on pööratud:

![BTC204](assets/en/66/26.webp)
*Suur tänu [Fanis Michalakis](https://x.com/FanisMichalakis)ile tema ülevaatuse ja väärtusliku eksperdinõuande eest artiklile, mis inspireeris selle peatüki kirjutamist!*
https://planb.network/tutorials/privacy/paynym-bip47

## Vaiksed Maksed
<chapterId>2871d594-414e-4598-a830-91c9eb84dfb8</chapterId>
BIP47 on kritiseeritud oma ebatõhususe pärast ahelas. Nagu eelmises peatükis selgitatud, nõuab see iga uue saaja jaoks teavitustehingut. See piirang muutub ebaoluliseks, kui on plaanis luua püsiv maksekanal selle saajaga. Tõepoolest, üks teavitustehing sillutab teed peaaegu lõpmatule arvule järgnevatele BIP47 maksetele.

Siiski, teatud olukordades võib teavitustehing olla kasutajale takistuseks. Võtame näiteks ühekordse annetuse saajale: klassikalise Bitcoin aadressiga piisab annetuse tegemiseks ühest tehingust. Kuid BIP47 puhul on vajalikud kaks tehingut: üks teavituse jaoks ja teine tegeliku makse jaoks. Kui nõudlus ploki ruumi järele on madal ja tehingutasud on minimaalsed, ei ole see lisasamm üldiselt probleem. Siiski, ummikute perioodidel võivad tehingutasud muutuda ühe makse jaoks liiga kõrgeks, potentsiaalselt kahekordistades kasutaja kulud võrreldes standardse Bitcoin tehinguga, mis võib olla kasutaja jaoks vastuvõetamatu.

Olukordades, kus kasutaja plaanib teha vaid mõned maksed staatilisele identifikaatorile, on välja töötatud teisi lahendusi. Nende hulgas on Vaiksed Maksed, mida kirjeldatakse [BIP352](https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki)s. See protokoll võimaldab kasutada staatilist identifikaatorit maksete vastuvõtmiseks ilma aadressi taaskasutust genereerimata ja ilma teavitustehingute kasutamise nõudeta. Vaatleme, kuidas see protokoll töötab.

---

*Selle peatüki täielikuks mõistmiseks on oluline olla tuttav ECDH (Elliptic Curve Diffie-Hellman) tööpõhimõtete ja krüptograafilise võtmestiku tuletamisega HD rahakotis. Need kontseptsioonid olid üksikasjalikult kirjeldatud eelmises BIP47 peatükis. Ma ei käsitle neid siin uuesti. Kui te pole nende mõistetega veel tuttav, soovitan enne selle peatükiga jätkamist konsulteerida eelmise peatükiga. Samuti ei käsitle ma uuesti vastuvõtu aadresside taaskasutamisega seotud riske ega ainulaadse identifikaatori omamise tähtsust maksete vastuvõtmiseks.*

---

### Miks mitte teavitust liigutada?

Nagu BIP47 peatükis arutletud, täidab teavitustehing peamiselt kahte funktsiooni:
- See teavitab saajat;
- See edastab saatja maksekoodi.

Võiks naiivselt arvata, et seda teavitamisprotsessi võiks läbi viia väljaspool ahelat. Teoorias on see täiesti teostatav: piisaks, kui saaja näitaks suhtlusvahendit, et vastu võtta BIP47 maksekoode saatjatelt. Siiski esitab see lähenemine kaks peamist probleemi:
- Esiteks, see nihutaks koodi edastamise protsessi teisele suhtlusprotokollile. Seotud kulud ja vahetuse privaatsusega seotud probleemid jääksid püsima, kuid lihtsalt kanduksid üle sellele uuele protokollile. Privaatsuse seisukohast võiks see samuti luua seose kasutaja identiteedi ja ahelas toimuva tegevuse vahel, mida me püüame vältida, teostades teavituse otse plokiahelas. Lisaks, teavituse läbiviimine väljaspool plokiahelat tooks kaasa tsensuuri riske (nagu vahendite blokeerimine), mis Bitcoinis ei eksisteeri.
- Järgmisena tekiks taastamisprobleem. BIP47 puhul peab saaja kindlasti teadma saatjate maksekoodid, et fondidele juurde pääseda. See kehtib nii vastuvõtmise ajal kui ka rahaliste vahendite taastamise korral seemne abil rahakoti kaotuse korral. Onchain teavituste puhul seda riski ei ole, kuna kasutaja saab teavitustransaktsioone lihtsalt oma seemnet teades leida ja dekrüpteerida. Kuid, kui teavitus toimub plokiahelast väljas, peaks kasutaja säilitama dünaamilist varukoopiat kõigist saadud maksekoodidest, mis on keskmisele kasutajale ebapraktiline.
Kõik need piirangud muudavad onchain teavituse kasutamise BIP47 kontekstis hädavajalikuks. Siiski, Silent Payments püüab just vältida seda onchain teavituse sammu selle kulu tõttu. Seetõttu ei ole lahendus teavituse liigutamine, vaid selle täielik kõrvaldamine. Selle saavutamiseks tuleb aktsepteerida kompromissi: skaneerimise kompromissi. Erinevalt BIP47-st, kus kasutaja teab täpselt, kust oma vahendeid tänu teavitustransaktsioonidele leida, peab Silent Payments kontekstis kasutaja uurima kõiki olemasolevaid Bitcoin'i tehinguid, et tuvastada makseid, mis võivad olla neile mõeldud. Selle operatiivkoormuse vähendamiseks piirdub Silent Payments otsing ainult tehingutega, mis tõenäoliselt sisaldavad selliseid makseid, nimelt nendega, mis sisaldavad vähemalt ühte Taproot P2TR väljundit. Skaneerimine keskendub ka ainult tehingutele alates rahakoti loomise kuupäevast (pole vaja skaneerida tehinguid, mis pärinevad aastast 2009, kui rahakott loodi 2024).

Seega, näete, miks BIP47 ja Silent Payments, kuigi nad püüdlevad sarnase eesmärgi poole, hõlmavad erinevaid kompromisse ja **seega tegelikult vastavad erinevatele kasutusjuhtudele**. Ühekordsete maksete puhul, nagu juhuslikud annetused, on Silent Payments sobivamad nende madalama kulu tõttu. Vastupidi, regulaarsete tehingute puhul samale saajale, nagu vahetusplatvormide või kaevandusbasseinide puhul, võidakse eelistada BIP47.
Uurime koos Silent Payments'i tehnilist toimimist, et paremini mõista nende tagajärgi. Selleks soovitan meil võtta sama lähenemisviisi nagu BIP352 selgitavas dokumendis. Me hakkame järk-järgult lahti seletama teostatavaid arvutusi, element element haaval, põhjendades iga uut lisandust.
### Mõned mõistmised

Enne alustamist on oluline selgitada, et Silent Payments toetub ainult P2TR (*Pay to Taproot*) skriptitüüpide kasutamisele. Erinevalt BIP47-st ei ole vaja tuletada vastuvõtva aadresse laste avalikest võtmetest, neid hashides. Tõepoolest, P2TR standardis kasutatakse muudetud avalikku võtit otse ja avalikult aadressil. Seega on Taprooti vastuvõtu aadress sisuliselt avalik võti koos mõningate metaandmetega. See muudetud avalik võti on kahe teise avaliku võtme agregaat: üks võimaldab otsest ja traditsioonilist kulutamist lihtsa allkirja abil ja teine esindab MASTi Merkle juurt, mis lubab kulutamist tingimusel, et üks potentsiaalselt Merkle puusse kirjutatud tingimustest on rahuldatud.

![BTC204](assets/en/67/01.webp)

Otsus piirata Silent Payments ainult Taprootiga on motiveeritud kahest peamisest põhjusest:
- Esiteks, see oluliselt lihtsustab rakendamist ja tulevasi uuendusi rahakottide tarkvaras, kuna tuleb järgida ainult ühte standardit;
- Teiseks, see lähenemine aitab parandada kasutajate anonüümsuse komplekti, julgustades neid mitte laiali valguma erinevate skriptitüüpide vahel, mis genereerivad ahela analüüsis eristatavad rahakoti sõrmejäljed (selle kontseptsiooni kohta lisateabe saamiseks kutsun teid konsulteerima peatükiga 4 osa 2).
Alustame lihtsa näitega, mis aitab teil mõista SP (Silent Payments ehk Vaiksed Maksed) põhifunktsiooni. Võtame Alice'i ja Bobi, kaks Bitcoini kasutajat. Alice soovib saata bitcoine Bobile uuele vastuvõtu aadressile. Selles protsessis tuleb saavutada kolm eesmärki:
- Alice peab suutma genereerida uue aadressi;
- Bob peab suutma tuvastada makse, mis on saadetud sellele kindlale aadressile;
- Bob peab suutma saada kätte privaatvõtme, mis on seotud selle aadressiga, et saaks oma vahendeid kulutada.

Alice'il on tema Bitcoini rahakotis UTXO, mis on turvatud järgmise võtmepaariga:
- $a$: privaatvõti;
- $A$: avalik võti ($A = a \cdot G$)

Bobil on SP aadress, mille ta on avaldanud internetis:
- $b$: privaatvõti;
- $B$: avalik võti ($B = b \cdot G$)
Bob'i aadressi hankides suudab Alice kasutades ECDH-d arvutada uue tühja aadressi, mis kuulub Bobile. Nimetame seda aadressi $P$:
$$  P = B + \text{hash}(a \cdot B) \cdot G  $$

Sel võrrandis arvutas Alice lihtsalt oma privaatvõtme $a$ ja Bobi avaliku võtme $B$ skalaarkorrutise. Ta läbis selle tulemuse kõigile teadaoleva räsifunktsiooniga. Väljundväärtus korrutatakse seejärel skalaarselt elliptilise kõvera `secp256k1` generaatorpunktiga $G$. Lõpuks lisab Alice saadud punkti Bobi avalikule võtmele $B$. Kui Alice'il on see aadress $P$, kasutab ta seda tehingu väljundina, mis tähendab, et ta saadab bitcoine sellele.

> *Vaiksete Maksete kontekstis vastab "hash" funktsioon SHA256 räsifunktsioonile, mis on spetsiifiliselt märgistatud `BIP0352/SharedSecret` abil, tagades, et genereeritud räsid on unikaalsed sellele protokollile ja neid ei saa teistes kontekstides taaskasutada, pakkudes samal ajal lisakaitset allkirjade nonsside taaskasutamise vastu. See standard vastab [BIP340-s Schnorri allkirjade jaoks määratletule](https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki) `secp256k1` puhul.*

Tänu elliptilisele kõverale, millele ECDH toetub, teame, et:

$$  a \cdot B = b \cdot A  $$

Seega suudab Bob arvutada vastuvõtu aadressi, millele Alice saatis bitcoine. Selleks jälgib ta kõiki Bitcoini tehinguid, mis vastavad Vaiksete Maksete kriteeriumidele, ja rakendab igaühele neist järgmist arvutust, et näha, kas makse on adresseeritud temale (*skaneerimine*):

$$  P' = B + \text{hash}(b \cdot A) \cdot G  $$

Kui ta skaneerib Alice'i tehingut, mõistab ta, et $P'$ on võrdne $P$-ga. Seega teab ta, et see makse on adresseeritud temale:

$$  P' = B + \text{hash}(b \cdot A) \cdot G = B + \text{hash}(a \cdot B) \cdot G = P   $$

Sellest lähtuvalt suudab Bob arvutada privaatvõtme $p$, mis võimaldab kulutada aadressil $P$ olevaid vahendeid:

$$  p = (b + \text{hash}(b \cdot A)) \bmod n  $$

Nagu näete, selle privaatvõtme $p$ arvutamiseks on tingimata vaja privaatvõtit $b$. Ainult Bobil on see privaatvõti $b$. Seega on ta tõepoolest ainus, kes suudab kulutada tema Vaiksete Maksete aadressile saadetud bitcoine.

![BTC204](assets/notext/67/02.webp)
*Pilt:*
- $B$: Avalik võti / staatiline aadress, mille avaldas Bob
- $b$: Bobi privaatvõti
- $A$: Alice'i UTXO avalik võti, mida kasutatakse tehingu sisendina
- $a$: Alice'i privaatvõti
- $G$: Elliptilise kõvera `secp256k1` generaatorpunkt
- $\text{SHA256}$: SHA256 räsifunktsioon, märgistatud kui `BIP0352/SharedSecret`
- $s$: Ühine ECDH saladus
- $P$: Avalik võti / unikaalne aadress makse tegemiseks Bobile

Siin on alguses pigem naiivne lähenemine, kasutades Bobi staatilist aadressi, tähistatud kui $B$, et tuletada unikaalne aadress $P$ bitcoinide saatmiseks. Siiski on see meetod liiga lihtsustatud ja sisaldab mitmeid vigu, mis vajavad parandamist. Esimene probleem on, et selles skeemis ei saa Alice luua mitut väljundit Bobile ühe ja sama tehingu raames.

### Kuidas luua mitu väljundit?

Eelmisest jaotisest näites loob Alice ühe väljundi, mis läheb Bobile tema unikaalsel aadressil $P$. Sama sisendi valimisel on võimatu Alicel luua kahte eristuvat neitsi aadressi Bobile, kuna kasutatud meetod viiks alati sama tulemuseni $P$ jaoks, seega sama aadress. Siiski võib olla palju olukordi, kus Alice soovib oma makset Bobile jagada mitmeks väiksemaks summaks, luues seeläbi mitu UTXOd. Seetõttu on vajalik leida meetod, mis võimaldab seda teha.

Selle saavutamiseks muudame veidi arvutust, mida Alice teeb $P$ tuletamiseks, nii et ta saab genereerida kaks eristuvat aadressi Bobile, nimelt $P_0$ ja $P_1$.

Arvutuse muutmiseks ja 2 erineva aadressi saamiseks piisab, kui lisada täisarv, mis muudab tulemust. Seega lisab Alice oma arvutusse $0$, et saada aadress $P_0$ ja $1$, et saada aadress $P_1$. Nimetame seda täisarvu $i$:

$$  P_i = B + \text{hash}(a \cdot B \text{ ‖ } i) \cdot G  $$

Arvutusprotsess jääb samaks kui eelmises meetodis, välja arvatud see, et seekord lisab Alice enne räsimist $a \cdot B$-le $i$. Seejärel piisab $i$ muutmisest, et saada uus aadress, mis kuulub Bobile. Näiteks:

$$  P_0 = B + \text{hash}(a \cdot B \text{ ‖ } 0) \cdot G  $$

$$  P_1 = B + \text{hash}(a \cdot B \text{ ‖ } 1) \cdot G  $$
Kui Bob skannib plokiahelat talle mõeldud Vaiksete Maksete jaoks, alustab ta kasutades $i = 0$ aadressi $P_0$ jaoks. Kui ta ei leia makset aadressil $P_0$, järeldab ta, et see tehing ei sisalda ühtegi Vaikset Makset talle ja lõpetab selle analüüsimise. Kuid, kui $P_0$ on kehtiv ja sisaldab makset talle, jätkab ta $P_1$-ga samas tehingus, et kontrollida, kas Alice tegi teise makse. Kui $P_1$ osutub kehtetuks, lõpetab ta selle tehingu otsimise; vastasel juhul jätkab ta järjestikuste $i$ väärtuste testimist:
$$  P_0 = B + \text{hash}(b \cdot A \text{ ‖ } 0) \cdot G  $$
$$  P_1 = B + \text{hash}(b \cdot A \text{ ‖ } 1) \cdot G  $$
Kuna Bob peatab kohe $i = 0$ juures, kui $P_0$ ei anna tulemust, siis selle täisarvu kasutamine ei lisa Bobile tehingute skaneerimise sammu jaoks peaaegu mingit lisakoormust.

Bob saab seejärel arvutada privaatvõtmed samal viisil:

$$ 
p_0 = (b + \text{hash}(b \cdot A \text{ ‖ } 0)) \bmod n
 $$

$$ 
p_1 = (b + \text{hash}(b \cdot A \text{ ‖ } 1)) \bmod n 
 $$

![BTC204](assets/notext/67/03.webp)

*Pildi allkiri:*
- $B$: Avalik võti / staatiline aadress, mille Bob avaldas
- $b$: Bobi privaatvõti
- $A$: Alice'i UTXO avalik võti, mida kasutatakse tehingu sisendina
- $a$: Alice'i privaatvõti
- $G$: Elliptilise kõvera generaatorpunkt `secp256k1`
- $\text{SHA256}$: SHA256 räsifunktsioon, märgistatud `BIP0352/SharedSecret`
- $s_0$: Esimene jagatud ECDH saladus
- $s_1$: Teine jagatud ECDH saladus
- $P_0$: Esimene avalik võti / unikaalne aadress Bobile maksmiseks
- $P_1$: Teine avalik võti / unikaalne aadress Bobile maksmiseks

Selle meetodiga hakkame saama toredat protokolli, kuid on veel mõningaid väljakutseid, mida ületada, eriti aadresside taaskasutamise vältimine.

### Kuidas vältida aadresside taaskasutamist?
Nagu eelmistes jaotistes nägime, kasutab Alice oma UTXO turvamiseks mõeldud võtmepaari, mida ta kulutab, et arvutada jagatud ECDH saladus Bobiga. See saladus võimaldab tal tuletada unikaalse aadressi $P_0$. Siiski, kui Alice kasutab sama võtmepaari ($a$, $A$) mitme UTXO turvamiseks, kui ta on seda aadressi mitu korda taaskasutanud, võib see põhjustada Bobi jaoks aadressi taaskasutamist.
> *Aadresside taaskasutamine on kasutaja privaatsuse jaoks väga halb praktika. Selle mõistmiseks soovitan teil üle vaadata selle koolituse esimesed osad.*

Tõepoolest, kuna unikaalne aadress $P_0$ on tuletatud $A$ ja $B$ põhjal, kui Alice tuletaks teise aadressi teiseks makseks $B$-le, sama võtmega $A$, jõuaks ta sama aadressi $P_0$ juurde. Selle riski vältimiseks ja aadresside taaskasutamise vältimiseks Vaiksetes Maksetes, peame me oma arvutusi veidi muutma.

Meie soov on, et iga UTXO, mida Alice kasutab makse sisendina, annaks Bobi poolel unikaalse aadressi, isegi kui mitu UTXOt on turvatud sama võtmepaariga. Seega piisab, kui lisada unikaalse aadressi $P_0$ arvutamisel viide UTXO-le. See viide on lihtsalt sisendina kasutatud UTXO räsi:

$$  \text{inputHash} = \text{hash}(\text{outpoint} \text{ ‖ } A)  $$

Ja seda sisendviidet lisab Alice oma unikaalse aadressi $P_0$ arvutamisel:
$$  P_0 = B + \text{hash}(\text{inputHash} \cdot a \cdot B \text{ ‖ } 0) \cdot G  $$
Skaneerimise käigus saab Bob lisada ka $\text{inputHash}$, kuna kõik, mida ta peab tegema, on tehingu jälgimine, et järeldada $\text{outpoint}$:

$$  P_0 = B + \text{hash}(\text{inputHash} \cdot b \cdot A \text{ ‖ } 0) \cdot G  $$

Kui ta leiab kehtiva $P_0$, saab ta arvutada vastava privaatvõtme $p_0$:

$$ 
p_0 = (b + \text{hash}(\text{inputHash} \cdot b \cdot A \text{ ‖ } 0)) \bmod n
 $$

![BTC204](assets/notext/67/04.webp)

*Legend:*
- $B$: Avalik võti / staatiline aadress, mille Bob avaldas
- $b$: Bobi privaatvõti
- $A$: Alice'i UTXO avalik võti, mida kasutatakse tehingu sisendina
- $a$: Alice'i privaatvõti
- $H$: Sisendina kasutatud UTXO räsi
- $G$: Elliptilise kõvera generaatorpunkt `secp256k1`
- $\text{SHA256}$: SHA256 räsi funktsioon, märgistatud kui `BIP0352/SharedSecret`
- $s_0$: Esimene jagatud ECDH saladus
- $P_0$: Esimene avalik võti / unikaalne aadress makseks Bobile

Praegu eeldame, et Alice kasutab oma tehingus ühte sisendit. Siiski peaks ta suutma kasutada mitut sisendit. Seetõttu peaks Bob, iga mitme sisendiga tehingu puhul, teoreetiliselt arvutama ECDH iga sisendi jaoks, et määrata, kas makse on mõeldud temale. See meetod ei ole rahuldav, seega peame leidma lahenduse töökoormuse vähendamiseks!

### Avalike võtmete "tweakimine" sisendites

Selle probleemi lahendamiseks, selle asemel, et kasutada Alice'i poolel kindlat sisendit turvavaid võtmepaare, kasutame kõigi tehingu sisendites kasutatud võtmepaaride summat. See summa käsitletakse seejärel uue võtmepaarina. Seda tehnikat tuntakse kui "tweak".

Näiteks, kujutage ette, et Alice'i tehingul on 3 sisendit, igaüks turvatud erineva võtmepaariga:
- $a_0$ turvab sisendi #0;
- $a_1$ turvab sisendi #1;
- $a_2$ turvab sisendi #2.

![BTC204](assets/notext/67/05.webp)

Ülalkirjeldatud meetodit järgides peaks Alice valima ühe võtmepaari $a_0$, $a_1$ ja $a_2$ hulgast, et arvutada ECDH saladus ja genereerida Bobi staatilisest aadressist $B$ unikaalne makseaadress $P$. Siiski nõuab see lähenemine, et Bob testiks iga võimalust järjestikku, alustades $a_0$-st, seejärel $a_1$ ja nii edasi, kuni ta tuvastab paari, mis genereerib kehtiva aadressi $P$. See protsess nõuab, et Bob teostaks ECDH arvutuse kõigi tehingute kõikide sisendite puhul, suurendades oluliselt operatiivset skaneerimiskoormust.

Selle vältimiseks palume Alice'il teha oma $P$ arvutuse, kasutades sisendi kõikide võtmete summat. Võttes meie näite, arvutataks muudetud privaatvõti $a$ järgmiselt:

$$  a = a_0 + a_1 + a_2  $$
Sarnaselt saavad Alice ja Bob arvutada kohandatud avaliku võtme:
$$  A = A_0 + A_1 + A_2  $$
Tänu sellele meetodile peab Bob arvutama ainult tehingu avalike võtmete summa, seejärel arvutama ECDH saladuse ainult $A$ põhjal, mis vähendab oluliselt skaneerimisetapi jaoks vajalike arvutuste hulka. Siiski, nagu me eelmises jaotises mainisime, lisasime oma arvutusse räsi $\text{inputHash}$, mida kasutatakse aadressi taaskasutamise vältimiseks:

$$  \text{inputHash} = \text{hash}(\text{outpoint} \text{ ‖ } A)  $$

Kuid kui tehingus on mitu sisendit, on vajalik määrata, millist $\text{outpoint}$ selles arvutuses kasutatakse. Vastavalt BIP352-le on $\text{outpoint}$ valiku kriteeriumiks valida leksikograafiliselt väikseim, mis tähendab UTXO valimist, mis ilmub tähestikulises järjekorras esimesena. See meetod standardiseerib iga tehingu jaoks valitava UTXO. Näiteks, kui see leksikograafiliselt väikseim $\text{outpoint}$ on $\text{outpoint}_L$, siis $\text{inputHash}$ arvutus oleks:

$$  \text{inputHash} = \text{hash}(\text{outpoint}_L \text{ ‖ } A)  $$

Arvutused jäävad siis samaks, nagu eelmises jaotises esitatud, välja arvatud see, et privaatvõti $a$ ja selle vastav avalik võti $A$ ei esinda enam paari, mis turvab üht sisendit, vaid nüüd esindavad nad kõigi sisendite võtmepaaride kohandust.

### Kulutamis- ja skaneerimisvõtmete eraldamine

Seni oleme arutanud Silent Payment staatilist aadressi $B$ kui unikaalset avalikku võtit. Pea meeles, et just seda avalikku võtit $B$ kasutab Alice jagatud ECDH saladuse loomiseks, mida omakorda kasutatakse unikaalse makseaadressi $P$ arvutamiseks. Bob kasutab seda avalikku võtit $B$ ja vastavat privaatvõtit $b$ skaneerimisetapil. Kuid ta kasutab privaatvõtit $b$ ka privaatvõtme $p$ arvutamiseks, mis võimaldab kulutada aadressilt $P$.

Selle meetodi puuduseks on see, et privaatvõtit $b$, mida kasutatakse kõigi Silent Paymente saavate aadresside privaatvõtmete arvutamiseks, kasutab Bob ka tehingute skaneerimiseks. See samm nõuab, et võti $b$ oleks saadaval internetiga ühendatud rahakotitarkvaras, mis seab selle suurema varguseohu kätte võrreldes selle hoidmisega külmas rahakotis. Ideaalis oleks kasulik, kui oleks võimalik kasutada Silent Paymente, hoides samal ajal privaatvõtit $b$, mis kontrollib juurdepääsu kõigile teistele privaatvõtmetele, turvaliselt riistvaralises rahakotis. Õnneks on protokolli kohandatud just selle võimaldamiseks.
Selle saavutamiseks määratleb BIP352, et vastuvõtja kasutab kahte erinevat võtmepaari:
- $B_{\text{spend}}$: unikaalsete makseaadresside privaatvõtmete arvutamiseks;
- $B_{\text{scan}}$: unikaalsete makseaadresside leidmiseks.

Sel viisil saab Bob hoida privaatvõtit $b_{\text{spend}}$ riistvaralises rahakotis ja kasutada privaatvõtit $b_{\text{scan}}$ oma Silent Paymente leidmiseks veebitarkvaras, ilma et ta paljastaks $b_{\text{spend}}$. Siiski avalikustatakse mõlemad avalikud võtmed $B_{\text{scan}}$ ja $B_{\text{spend}}$, kuna need leiduvad Bobi staatilisel aadressil $B$:
$$  B = B_{\text{scan}} \text{ ‖ } B_{\text{spend}} $$
Selleks, et arvutada Bobile kuuluv unikaalne makseaadress $P_0$, teeb Alice järgmise arvutuse:

$$  P_0 = B_{\text{spend}} + \text{hash}(\text{inputHash} \cdot a \cdot B_{\text{scan}} \text{ ‖ } 0) \cdot G  $$

Maksete leidmiseks, mis on adresseeritud temale, teeb Bob järgmise arvutuse:

$$  P_0 = B_{\text{spend}} + \text{hash}(\text{inputHash} \cdot b_{\text{scan}} \cdot A \text{ ‖ } 0) \cdot G  $$

Nagu näete, pole Bob seni vajanud kasutada $b_{\text{spend}}$, mis asub tema riistvaralises rahakotis. Kui ta soovib kulutada $P_0$, saab ta teha järgmise arvutuse, et leida privaatvõti $p_0$:

$$ p_0 = (b_{\text{spend}} + \text{hash}(\text{inputHash} \cdot b_{\text{scan}} \cdot A \text{ ‖ } 0)) \bmod n $$

![BTC204](assets/notext/67/06.webp)

*Pildi allkiri:*
- $B_{\text{scan}}$: Bobi skaneerimise avalik võti (staatiline aadress)
- $b_{\text{scan}}$: Bobi skaneerimise privaatvõti
- $B_{\text{spend}}$: Bobi kulutamise avalik võti (staatiline aadress)
- $b_{\text{spend}}$: Bobi kulutamise privaatvõti
- $A$: Sisendi avalike võtmete summa (tweak)
- $a$: Tweaked avalikule võtmele vastav privaatvõti
- $H$: Sisendis kasutatud kõige väiksema UTXO (leksikograafiliselt) räsi
- $G$: Elliptilise kõvera `secp256k1` generaatorpunkt
- $\text{SHA256}$: SHA256 räsifunktsioon, märgistatud `BIP0352/SharedSecret`
- $s_0$: Esimene jagatud ECDH saladus
- $P_0$: Esimene avalik võti / Bobi unikaalne makseaadress

### SP aadresside kasutamine sildiga

Bobil on seega Silent Payments jaoks staatiline aadress $B$ järgmiselt:

$$ B = B_{\text{scan}} \text{ ‖ } B_{\text{spend}} $$

Selle meetodi probleem on see, et see ei võimalda eristada erinevaid makseid, mis on saadetud sellele aadressile. Näiteks, kui Bobil on oma äri jaoks 2 erinevat klienti ning ta soovib selgelt eristada makseid kummaltki, oleks tal vaja 2 erinevat staatilist aadressi. Lihtne lahendus praeguse lähenemisviisi puhul oleks Bobil luua kaks eraldi rahakotti, igaühega oma staatilise aadressiga, või isegi luua kaks erinevat staatilist aadressi samas rahakotis. Siiski nõuab see lahendus kogu plokiahela kahekordset skaneerimist (üks kord iga aadressi jaoks), et vastavalt tuvastada iga aadressi jaoks mõeldud maksed. See kahekordne skaneerimine suurendab mõttetult Bobi operatiivkoormust.
Selle probleemi lahendamiseks kasutab BIP352 märgistussüsteemi, mis võimaldab erinevaid staatilisi aadresse ilma mõistlikult suurendamata töökoormust, et leida plokiahelas Vaikseid Makseid. Selleks lisatakse kulutamise avalikule võtmele $B_{\text{spend}}$ täisarv $m$. See täisarv võib võtta väärtuse $1$ esimese staatilise aadressi jaoks, seejärel $2$ teise jaoks, ja nii edasi. Kulutamise võtmed $B_{\text{spend}}$ nimetatakse edaspidi $B_m$-ks ja need konstrueeritakse järgmisel viisil:
$$  B_m = B_{\text{spend}} + \text{hash}(b_{\text{scan}} \text{ ‖ } m) \cdot G  $$

Näiteks esimese kulutamise võtme puhul märgisega $1$:

$$  B_1 = B_{\text{spend}} + \text{hash}(b_{\text{scan}} \text{ ‖ } 1) \cdot G  $$

Staatiline aadress, mille Bob avaldab, koosneb nüüd $B_{\text{scan}}$ ja $B_m$-st. Näiteks esimene staatiline aadress märgisega $1$ on:

$$ B = B_{\text{scan}} \text{ ‖ } B_1 $$

> *Alustame ainult märgisest 1, kuna märgis 0 on reserveeritud tagasimakse jaoks.*

Alice omalt poolt tuletatakse unikaalne makseaadress $P$ samal viisil nagu varem, kuid kasutades uut $B_1$ asemel $B_{\text{spend}}$.
$$  P_0 = B_1 + \text{hash}(\text{inputHash} \cdot a \cdot B_{\text{scan}} \text{ ‖ } 0) \cdot G  $$

Tegelikkuses ei pruugi Alice isegi teada, et Bobil on märgistatud aadress, kuna ta lihtsalt kasutab staatilise aadressi teist osa, mille Bob talle andis, mis sel juhul on väärtus $B_1$ mitte $B_{\text{spend}}$.

Maksete skaneerimiseks kasutab Bob alati oma esialgse staatilise aadressi väärtust koos $B_{\text{spend}}$-ga järgmisel viisil:

$$   P_0 = B_{\text{spend}} + \text{hash}(\text{inputHash} \cdot b_{\text{scan}} \cdot A \text{ ‖ } 0) \cdot G  $$

Seejärel lihtsalt lahutab ta leitud väärtuse $P_0$ iga väljundi puhul ükshaaval. Seejärel kontrollib ta, kas ühe nende lahutuste tulemustest vastab ühele tema rahakotis kasutatavatest märgistest. Kui see vastab, näiteks väljundi #4 puhul märgisega $1$, tähendab see, et see väljund on Vaikne Makse, mis on seotud tema märgistatud staatilise aadressiga $B_1$:

$$ Out_4 - P_0 = \text{hash}(b_{\text{scan}} \text{ ‖ } 1) \cdot G $$

See töötab, sest:

$$  B_1 = B_{\text{spend}} + \text{hash}(b_{\text{scan}} \text{ ‖ } 1) \cdot G  $$
Tänu sellele meetodile saab Bob kasutada mitmeid staatilisi aadresse ($B_1$, $B_2$, $B_3$...), mis kõik on tuletatud tema baas staatilisest aadressist ($B = B_{\text{scan}} \text{ ‖ } B_{\text{spend}}$), et korrektselt eraldada kasutusviise.
Siiski, staatiliste aadresside eraldamine on kehtiv ainult isikliku rahakoti haldamise perspektiivist ja ei võimalda identiteetide eraldamist. Kuna neil kõigil on sama $B_{\text{scan}}$, on väga lihtne seostada kõiki staatilisi aadresse koos ja järeldada, et need kuuluvad ühele entiteedile.

![BTC204](assets/notext/67/07.webp)

*Pildiallkiri:*
- $B_{\text{scan}}$: Bobi skaneerimise avalik võti (staatiline aadress)
- $b_{\text{scan}}$: Bobi skaneerimise privaatvõti
- $B_{\text{spend}}$: Bobi kulutamise avalik võti (algne aadress)
- $B_m$: Bobi märgistatud kulutamise avalik võti (staatiline aadress)
- $b_m$: Bobi märgistatud kulutamise privaatvõti
- $A$: sisendite avalike võtmete summa (tweak)
- $a$: kohandatud avalikule võtmele vastav privaatvõti
- $H$: väikseima UTXO (leksikograafiliselt) hash, mida kasutatakse sisendina
- $G$: elliptilise kõvera generaatorpunkt `secp256k1`
- $\text{SHA256}$: SHA256 räsifunktsioon, märgistatud `BIP0352/SharedSecret`
- $s_0$: esimene jagatud ECDH saladus
- $P_0$: esimene avalik võti / unikaalne aadress makseteks Bobile
- $p_0$: esimese unikaalse makseaadressi privaatvõti Bobile
- $X$: skaneerimise privaatvõtme ja sildi hash

### Kuidas konstrueerida Silent Payments aadressi?

Dedikeeritud Silent Payments aadressi konstrueerimiseks peab esmalt tuletama oma Bitcoin HD rahakotis 2 võtmepaari:
- Paar $b_{\text{scan}}$, $B_{\text{scan}}$ maksete otsimiseks, mis on adresseeritud meile;
- Paar $b_{\text{spend}}$, $B_{\text{spend}}$ saadud bitcoinide kulutamiseks.

Need paarid tuletatakse järgnevate radade järgi (*Bitcoin Mainnet*):

```text
scan: m / 352' / 0' / 0' / 1' / 0
spend: m / 352' / 0' / 0' / 0' / 0
```

Kui need 2 võtmepaari on saadaval, lihtsalt ühendatakse need (otsast-otsani) staatilise aadressi koorma loomiseks:

$$ B = B_{\text{scan}} \text{ ‖ } B_{\text{spend}} $$

Kui soovitakse kasutada silte, asendatakse $B_{\text{spend}}$ $B_m$-iga:

$$ B = B_{\text{scan}} \text{ ‖ } B_m $$

Sildiga $m$:

$$  B_m = B_{\text{spend}} + \text{hash}(b_{\text{scan}} \text{ ‖ } m) \cdot G  $$

Kui see koorem on saadaval, lisatakse HRP (*Human-Readable Part*) `sp` ja versioon `q` (= versioon 0). Lisatakse ka kontrollsumma ja aadress vormindatakse bech32m formaadis.
Näiteks siin on minu staatiline Silent Payments aadress:
```text
sp1qqvhjvsq2vz8zwrw372vuzle7472zup2ql3pz64yn5cpkw5ngv2n6jq4nl8cgm6zmu48yk3eq33ryc7aam6jrvrg0d0uuyzecfhx2wgsumcurv77e
```
Oluline punkt staatiliste aadresside kohta, mida võisite eelmistes jaotistes sisestada, on see, et neid aadresse ei ole Bitcoin'i tehingutes nähtavad. Blockchainis ilmuvad standardse Taproot formaadiga väljundites kasutatavad makseaadressid $P$, mitte staatilised aadressid. Seega väljastpoolt vaadates on võimatu eristada Silent Payment'i kasutavat tehingut tavalisest tehingust, mis kasutab P2TR väljundeid.
Nagu ka BIP47 puhul, on võimatu luua seost staatilise aadressi $B$ ja sellest tuletatud makseaadressi $P$ vahel. Tõepoolest, isegi kui Eve, potentsiaalne ründaja, üritab blockchaini skaneerida Bobi staatilise aadressiga $B$, ei suuda ta teha vajalikke arvutusi, et määrata $P$. Selleks oleks tal vaja kas Bobi privaatset skaneerimisvõtit $b_{\text{scan}}$ või saatja privaatvõtmeid $a$, kuid mõlemad need elemendid on muidugi privaatsed. Seega on võimalik oma staatilist aadressi selgelt isikliku identiteediga seostada.

### Kuidas kasutada Silent Payments'i?

Silent Payments'i ettepanek on suhteliselt hiljutine ja seni on seda rakendanud väga piiratud arv rahakotte. Minu teada on neid tarkvarasid, mis neid toetavad, ainult 3:
- [CakeWallet](https://cakewallet.com/)
- [Silentium](https://app.silentium.dev/)
- [DonationWallet](https://github.com/Sosthene00/donationwallet)

Varsti pakume üksikasjalikku õpetust oma Silent Payments staatilise aadressi seadistamiseks.

Kuna see funktsioon on hiljutine, on soovitatav olla ettevaatlik ja vältida Silent Payments'i kasutamist suurte summade jaoks peavõrgus.

*Selle Silent Payments'i peatüki loomiseks kasutasin [Silent Payments'i selgitavat saiti](https://silentpayments.xyz/) ja [BIP352 selgitavat dokumenti](https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki).*

# Järeldus

## Hinnake kursust
<chapterId>195d149f-80fa-5816-8b46-995a9226d082</chapterId>
<isCourseReview>true</isCourseReview>

## Lõpueksam
<chapterId>e803d394-e3c1-5816-a6b4-a69a2472019c</chapterId>
<isCourseExam>true</isCourseExam>

## Lõppsõna

<chapterId>cd8e5c67-50e4-4dcd-8e04-88ba5ec95305</chapterId>

Palju õnne Bitcoin'i privaatsuse koolituse lõpetamise puhul!
Oleme käsitlenud palju keerukaid ja tehnilisi teemasid selles koolitusel, kuid pole hädavajalik kasutada kõiki tutvustatud tööriistu. Peamine eesmärk oli anda teile võimalus valida, millist informatsiooni soovite avalikustada ja millist eelistate konfidentsiaalsena hoida Bitcoin'i kasutamisel. See kehastab privaatsuse kaitse olemust. Informeeritud valikute tegemiseks selle kohta, millist informatsiooni jagada või varjata, on vajalik olla teadlik meie tegevuse tagajärgedest. Loodan, et see koolitus on aidanud teil seda teadmist omandada. Kui peaksin valima selle koolituse kõige olulisema osa, valiksin jaotise, mis on pühendatud ahela analüüsile. Oma potentsiaalsete ründajate kasutatavate tehnikate mõistmine on parim viis enda kaitsmiseks. Seetõttu oleks minu soovitus hoolikalt üle vaadata see osa ja püüda mõista kõiki selle detaile.

Selles koolituses keskendusime ainult Bitcoin'i privaatsusele põhiahelas. Teise kihi süsteemide, nagu Lightning Network ja külgahelad, privaatsusprobleemid on samuti olulised ja omavad väga spetsiifilisi omadusi. Kuigi off-chain tehingute kasutamine võib olla tõhus strateegia paljude uuritud Bitcoin'i jälgitavuse riskide vältimiseks, puutute kokku ka teiste riskidega, millest on samuti oluline teadlik olla. Seetõttu käsitletakse neid teemasid tulevikus PlanB võrgustikus pühendatud koolitusel.

Kui see koolitus teile meeldis, oleksin väga tänulik, kui jagaksite seda oma sõpradega ja sotsiaalmeedias. Aitäh! :)
